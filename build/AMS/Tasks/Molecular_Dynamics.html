

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
<META name="ROBOTS" content="NOINDEX, NOFOLLOW">
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Molecular dynamics &mdash; AMS 2021.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/theme_tabs.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/panels-bootstrap.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="AMS 2021.1 documentation" href="../index.html"/>
        <link rel="up" title="Structure and Reactivity, Molecular Dynamics" href="TOC.html"/>
        <link rel="next" title="Trajectory replay" href="TrajectoryReplay.html"/>
        <link rel="prev" title="Excited state optimizations" href="Excited_State_Optimizations.html"/> 

  
  <script src="../_static/js/jquery.min.js"></script>
  <script src="../_static/js/bootstrap.min.js"></script>
  <script src="../_static/js/modernizr.min.js"></script>
  <script src="../_static/js/app.js"></script>
<script type="text/javascript">
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NCRWHZZ');</script>
<!-- End Google Tag Manager -->

</head>

<body class="wy-body-for-nav" role="document">
  <!--STARTNOSOLR-->
  <header class="site-header navbar-fixed-top compact">
      <nav class="main navbar navbar-default">
        <div class="headerbar_container">
          <a role="button" href="/free-trial/" class="btn btn-sm btn-primary">Free trial</a>
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div class="navbar-brand">
              <a class="logo" href="https://www.scm.com">
                <img class="logo-small" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="Software for Chemistry &amp; Materials" />
                <img class="logo-full" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo.svg" alt="Software for Chemistry &amp; Materials" />
              </a>
            </div>
          </div>
          <div class="nav-wrapper">
            <div class="collapse navbar-collapse">
              <ul id="menu-primary-navigation" class="nav navbar-nav"><li id="menu-item-40077" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-40077"><a title="Applications" href="https://www.scm.com/applications/">Applications</a></li>
<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a title="Products" href="https://www.scm.com/amsterdam-modeling-suite/">Products</a></li>
<li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36"><a title="Support" href="https://www.scm.com/support/">Support</a></li>
<li id="menu-item-37" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37"><a title="About us" href="https://www.scm.com/about-us/">About us</a></li>
</ul>                           <span class="search"><a class="menu_search_link" href="https://www.scm.com/search.php"></a><span class="sr-only">Search</span></span>
            </div>
          </div>
        </div>
      </nav>
 </header>
    

   
  <div id="doc-wrapper">
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" />
          
          </a>

          
          
  <ul>
      <li class="wy-breadcrumbs-aside">
        
           
           <a class="keyword-spacing" href="../keywords.html">Keywords</a>
           
           
           <a href="../genindex.html">Index</a>
           
        
      </li>
  </ul>
 
<!--ENDNOSOLR-->
             <!--STARTNOSOLR-->
<div role="search">
  <form id="rtd-search-form" class="wy-form search-docs-form" action="https://www.scm.com/search.php" method="get">
  <div class="input-group">
    <input type="text" name="search" placeholder="Search AMS" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <input type="hidden" name="root" value="doctrunk" />


    <input type="hidden" name="cat" value="doc-AMS" />


    <span class="input-group-btn">
			<button type="submit" class="btn btn-primary"><span class="sr-only">Search</span><span class="fa fa-search"></span></button>
		</span>
	</div>
  </form>
</div>
<!--ENDNOSOLR-->
          

          
        </div>
<!--STARTNOSOLR-->
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../General.html">General</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../General.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General.html#what-s-new-in-the-ams-driver">What’s new in the AMS driver?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../General.html#new-in-ams2021-3">New in AMS2021.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General.html#new-in-ams2021-1">New in AMS2021.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General.html#new-in-ams2020-1">New in AMS2020.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General.html#new-in-ams2019-3">New in AMS2019.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../General.html#new-in-ams2019-1">New in AMS2019.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../General.html#motivation-and-progress">Motivation and progress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General.html#input-execution-and-output">Input, execution and output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Input_Output.html">Input, execution and output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Input_Output.html#input">Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#properties">Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#general-remarks-on-input-structure-and-parsing">General remarks on input structure and parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#keys">Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#blocks">Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#including-an-external-file">Including an external file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#units">Units</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Input_Output.html#execution">Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#shell-script">Shell script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#interactive-input-file">Interactive input file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#running-ams-on-compute-clusters">Running AMS on compute clusters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Input_Output.html#output">Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#index-13">Results directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#logfile-ams-log">Logfile ams.log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#binary-output-files">Binary output files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#standard-output">Standard output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#optimized-geometry-in-xyz-format">Optimized geometry in xyz format</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#ams-environment-variables">AMS environment variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Input_Output.html#driver-level-parallelism">Driver level parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Input_Output.html#python-interface">Python interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Input_Output.html#pipe-interface">Pipe interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Pipe_protocol.html">AMSPipe protocol specification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Pipe_protocol.html#low-level-message-encoding">Low-level message encoding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Pipe_protocol.html#return-messages-and-error-handling">Return messages and error handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Pipe_protocol.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#ams-as-a-pipe-master">AMS as a pipe master</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Input_Output.html#ams-as-a-pipe-worker">AMS as a pipe worker</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../System.html">Geometry, System definition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../System.html#geometry-lattice">Geometry, Lattice</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../System.html#modifying-the-geometry">Modifying the geometry</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../System.html#symmetry">Symmetry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../System.html#regions">Regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../System.html#charge-atomic-masses-input-bond-orders">Charge, atomic masses, input bond orders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../System.html#homogeneous-electric-field-and-multipole-charges">Homogeneous electric field and multipole charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../System.html#load-a-system-from-file">Load a System from file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../System.html#atom-attributes">Atom attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../System.html#force-field-related-extensions">Force field related extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../System.html#load-charges-for-a-forcefield-into-regions">Load charges for a forcefield into regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../System.html#load-forcefield-atom-types">Load forcefield atom types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="TOC.html">Structure and Reactivity, Molecular Dynamics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Single_Point.html">Single point calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bond_Energy.html">Bond energy calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Bond_Energy.html#ground-state-energy">Ground state energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bond_Energy.html#formation-energy">Formation energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bond_Energy.html#atomization-energies">Atomization energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bond_Energy.html#chemisorption-energies">Chemisorption energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bond_Energy.html#atomic-corrections">Atomic corrections</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bond_Energy.html#open-shell-systems">Open shell systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bond_Energy.html#impurities">Impurities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Geometry_Optimization.html">Geometry optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Geometry_Optimization.html#constrained-optimization">Constrained optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Geometry_Optimization.html#restraints">Restraints</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Geometry_Optimization.html#optimization-under-pressure-external-stress">Optimization under pressure / external stress</a></li>
<li class="toctree-l3"><a class="reference internal" href="Geometry_Optimization.html#optimization-methods">Optimization methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Geometry_Optimization.html#quasi-newton">Quasi-Newton</a></li>
<li class="toctree-l4"><a class="reference internal" href="Geometry_Optimization.html#fire">FIRE</a></li>
<li class="toctree-l4"><a class="reference internal" href="Geometry_Optimization.html#index-17">SCMGO</a></li>
<li class="toctree-l4"><a class="reference internal" href="Geometry_Optimization.html#limited-memory-bfgs">Limited-memory BFGS</a></li>
<li class="toctree-l4"><a class="reference internal" href="Geometry_Optimization.html#conjugate-gradients">Conjugate gradients</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Geometry_Optimization.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Geometry_Optimization.html#failure-to-converge">Failure to converge</a></li>
<li class="toctree-l4"><a class="reference internal" href="Geometry_Optimization.html#restarting-a-geometry-optimization">Restarting a geometry optimization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Transition_State_Search.html">Transition state search</a></li>
<li class="toctree-l2"><a class="reference internal" href="PES_Scan.html">Linear Transit, PES scan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="PES_Scan.html#distance-angle-and-dihedral-angle-coordinates">Distance, angle, and dihedral angle coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Scan.html#joint-scan-coordinates">Joint scan coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Scan.html#multidimensional-pes-scan">Multidimensional PES scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Scan.html#lattice-scan-coordinates-for-periodic-systems">Lattice scan coordinates for periodic systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="PES_Scan.html#isotropic-scaling-of-the-unit-cell-volume-or-area">Isotropic scaling of the unit cell volume or area</a></li>
<li class="toctree-l4"><a class="reference internal" href="PES_Scan.html#scaling-of-the-lattice-vector-lengths">Scaling of the lattice vector lengths</a></li>
<li class="toctree-l4"><a class="reference internal" href="PES_Scan.html#strain-matrix-in-voigt-notation">Strain matrix in Voigt notation</a></li>
<li class="toctree-l4"><a class="reference internal" href="PES_Scan.html#scan-arbitrary-lattices">Scan arbitrary lattices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="PES_Scan.html#calculate-properties-for-all-pes-points">Calculate properties for all PES points</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Scan.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="NEB.html">Nudged Elastic Band (NEB)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="NEB.html#input">Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="NEB.html#frozen-atom-constraints">Frozen atom constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="NEB.html#optimizations-and-convergence-criteria">Optimizations and convergence criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="NEB.html#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="NEB.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IRC.html">Intrinsic Reaction Coordinate (IRC)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="IRC.html#method-details">Method details</a></li>
<li class="toctree-l3"><a class="reference internal" href="IRC.html#input">Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="IRC.html#output">Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Excited_State_Optimizations.html">Excited state optimizations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Molecular dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constrained-molecular-dynamics">Constrained molecular dynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#re-starting-a-simulation">(Re-)Starting a simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#thermostats-and-barostats">Thermostats and barostats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#temperature-and-pressure-regimes">Temperature and pressure regimes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#trajectory-sampling-and-output">Trajectory sampling and output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lattice-deformations-volume-regimes">Lattice deformations (volume regimes)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molecule-gun-adding-molecules-during-simulation">Molecule Gun: adding molecules during simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#removing-molecules-during-simulation">Removing molecules during simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accelerated-dynamics">Accelerated dynamics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-plumed-library-support-in-ams">The PLUMED library support in AMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#metadynamics-for-conformer-rotamer-ensemble-sampling-crest-mtd">Metadynamics for Conformer-Rotamer Ensemble Sampling (CREST-MTD)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#collective-variable-driven-hyperdynamics-cvhd">Collective Variable-driven HyperDynamics (CVHD)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#temperature-replica-exchange">Temperature Replica Exchange</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bond-boost-method">Bond Boost Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#force-bias-monte-carlo-fbmc">Force bias Monte Carlo (fbMC)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#non-equilibrium-md-nemd">Non-equilibrium MD (NEMD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#t-nemd-for-thermoconductivity-heat-exchange">T-NEMD for thermoconductivity: heat exchange</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TrajectoryReplay.html">Trajectory replay</a></li>
<li class="toctree-l2"><a class="reference internal" href="GCMC.html">Grand Canonical Monte Carlo (GCMC)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="GCMC.html#general-info">General info</a></li>
<li class="toctree-l3"><a class="reference internal" href="GCMC.html#method-details">Method Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="GCMC.html#input">Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="GCMC.html#output">Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="PES_Exploration.html">Automated PES Exploration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#job-selection-and-main-options">Job selection and main options</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#results-the-energy-landscape">Results: the “Energy Landscape”</a><ul>
<li class="toctree-l4"><a class="reference internal" href="PES_Exploration.html#results-on-the-text-output">Results on the text output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#continue-a-pes-exploration-from-a-previous-calculation">Continue a PES exploration from a previous calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#structure-comparison">Structure comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#process-search-job">Process Search job</a><ul>
<li class="toctree-l4"><a class="reference internal" href="PES_Exploration.html#id2">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="PES_Exploration.html#input-options">Input options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#saddle-search-job">Saddle Search job</a><ul>
<li class="toctree-l4"><a class="reference internal" href="PES_Exploration.html#id3">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="PES_Exploration.html#id8">Input options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#basin-hopping-job">Basin Hopping job</a><ul>
<li class="toctree-l4"><a class="reference internal" href="PES_Exploration.html#id9">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="PES_Exploration.html#id11">Input options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#landscape-refinement">Landscape Refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#optimizer">Optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#binding-sites">Binding Sites</a><ul>
<li class="toctree-l4"><a class="reference internal" href="PES_Exploration.html#id12">Input options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="PES_Exploration.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Gradients_Stress_Elasticity.html">Gradients, Hessian, Stress tensor, Elasticity</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Gradients_Stress_Elasticity.html#nuclear-gradients">Nuclear gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gradients_Stress_Elasticity.html#index-3">Hessian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gradients_Stress_Elasticity.html#pes-point-character">PES point character</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gradients_Stress_Elasticity.html#thermodynamics-gas-phase-gibbs-free-energy">Thermodynamics, gas phase Gibbs free energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gradients_Stress_Elasticity.html#stress-tensor">Stress tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gradients_Stress_Elasticity.html#elastic-tensor">Elastic tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gradients_Stress_Elasticity.html#numerical-differentiation-options">Numerical differentiation options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Vibrational_Spectroscopy.html">Vibrational Spectroscopy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Vibrational_Spectroscopy.html#general">General</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#where-are-the-results">Where are the results?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Vibrational_Spectroscopy.html#ir-frequencies-and-normal-modes">IR frequencies and normal modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#all-vibrational-modes">All vibrational Modes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#rescanning-imaginary-modes">Rescanning Imaginary modes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#symmetric-displacements">Symmetric Displacements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#mobile-block-hessian-mbh">Mobile Block Hessian (MBH)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#mode-scanning">Mode Scanning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#theory">Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#input">Input</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#mode-refinement">Mode Refinement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#id4">Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#id5">Input</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#mode-tracking">Mode Tracking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#id8">Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#id11">Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#input-tracking-methods">Input: Tracking methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#input-selecting-modes">Input: Selecting modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#input-convergence">Input: Convergence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#selecting-modes">Selecting modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#thermodynamics-ideal-gas">Thermodynamics (ideal gas)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#gibbs-free-energy-change-for-a-gas-phase-reaction">Gibbs free energy change for a gas phase reaction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#moments-of-inertia">Moments of inertia</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#partial-vibrational-spectra-pvdos">Partial Vibrational Spectra (PVDOS)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Vibrational_Spectroscopy.html#phonons">Phonons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Vibrational_Spectroscopy.html#resonance-raman">(Resonance) Raman</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#id19">Raman</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#resonance-raman-excited-state-finite-lifetime">Resonance Raman: excited-state finite lifetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#resonance-raman-vg-fc">Resonance Raman: VG-FC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#id22">Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Vibrational_Spectroscopy.html#id24">Input</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Vibrational_Spectroscopy.html#vroa-resonance-vibrational-raman-optical-activity">VROA: (Resonance) vibrational Raman optical activity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#engine-adf">Engine ADF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Vibrational_Spectroscopy.html#vcd-vibrational-circular-dichroism">VCD: Vibrational Circular Dichroism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#atomic-polar-tensor-apt-model">Atomic polar tensor (APT) model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Vibrational_Spectroscopy.html#analytical-vcd-in-adf">Analytical VCD in ADF</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Vibrationally_resolved_electronic_spectra.html">Vibrationally resolved electronic spectra</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Utilities/FCF_module.html">AH-FC: Adiabatic Hessian Franck-Condon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/FCF_module.html#fcf-module-franck-condon-factors">FCF module: Franck-Condon Factors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Utilities/FCF_module.html#theory">Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Utilities/FCF_module.html#algorithm">Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Utilities/FCF_module.html#input">Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Utilities/FCF_module.html#result-tape61">Result: TAPE61</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/FCF_module.html#fcf-example-absorption-and-fluorescence">FCF example absorption and fluorescence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/FCF_module.html#fcf-example-phosphorescence">FCF Example phosphorescence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html">VG-FC: Vertical Gradient Franck-Condon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#theory">Theory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#theory-vibronic-structure-tracking">Theory: Vibronic-Structure Tracking</a></li>
<li class="toctree-l4"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#theory-vibronic-structure-refinement">Theory: Vibronic-Structure Refinement</a></li>
<li class="toctree-l4"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#theory-adiabatic-excitation-energy">Theory: Adiabatic excitation energy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#input-vibronic-structure-all-modes">Input: Vibronic-Structure all modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#input-vibronic-structure-tracking">Input: Vibronic-Structure Tracking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#input-restarting-vst">Input: Restarting VST</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#input-vibronic-structure-refinement">Input: Vibronic-Structure Refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#input-excited-state">Input: Excited State</a></li>
<li class="toctree-l3"><a class="reference internal" href="VibrationalAnalysis/Vibrationally_resolved_electronic_spectra.html#input-producing-the-spectrum">Input: Producing the spectrum</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Properties.html">Dipole moment, Polarizability, Bond orders</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Properties.html#charges-dipole-moment-polarizability">Charges, Dipole Moment, Polarizability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Properties.html#bond-orders-molecule-detection">Bond orders &amp; Molecule detection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Engines.html">Engines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Engines.html#index-2">Available engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Engines.html#summary-of-engine-capabilities">Summary of engine capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Engines.html#external-programs-as-engines">External programs as engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Engines.html#toy-engines">Toy engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Engines.html#engine-add-ons">Engine add-ons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Engines.html#dispersion-corrections">Dispersion corrections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Engines.html#pressure">Pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Engines.html#non-isotropic-external-stress">Non-isotropic external stress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Engines.html#atom-energies">Atom energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Engines.html#restraints">Restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Engines.html#wall-potential">Wall potential</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/TOC.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Utilities/ChemTraYzer.html">ChemTraYzer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/ChemTraYzer.html#general-information">General information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/ChemTraYzer.html#graphical-user-interface">Graphical user interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/ChemTraYzer.html#command-line-execution">Command line execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/ChemTraYzer.html#results">Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Utilities/ChemTraYzer2.html">ChemTraYzer2 (beta version)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/ChemTraYzer2.html#using-chemtrayzer2-via-the-graphical-user-interface">Using ChemTraYzer2 via the graphical user interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/ChemTraYzer2.html#minimal-input">Minimal input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/ChemTraYzer2.html#input-options">Input options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/ChemTraYzer2.html#ouput">Ouput</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html">Trajectory Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html#radial-distribution-function-rdf">Radial Distribution Function (RDF)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html#options">Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html#histogram">Histogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html#autocorrelation-functions">Autocorrelation Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html#id2">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html#id3">Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html#diffusion-coefficient">Diffusion Coefficient</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Utilities/VCDtools.html">VCD Analysis: VCDtools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/VCDtools.html#general-theory">General Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/VCDtools.html#general-coupled-oscillator-analysis">General Coupled Oscillator Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/VCDtools.html#available-options">Available options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#geometry-optimization">Geometry optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/GO_formaldehyde_noSCC.html">Example: Simple geometry optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/2StepGO.html">Example: Two-stage geometry optimization with initial Hessian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Diamond_under_pressure.html">Example: Periodic lattice optimization under pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Diamond_from_pressure.html">Example: Phase Transition Due To External Nonuniform Stress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/ExternalStress_BN.html">Example: Boron nitride optimization under external stress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/ExternalStress_graphene.html">Example: Graphene optimization under external stress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/constraints.html">Example: Constrained optimizations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#transition-state-search">Transition state search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/COChainFreqTS.html">Example: TS search starting from initial Hessian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/PESScan_and_TS_H2_on_Graphene.html">Example: PES scan and TS search for H2 on graphene</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#nudged-elastic-band-neb">Nudged Elastic Band (NEB)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/NEB.html">Nudged Elastic Band (NEB) Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Examples/NEB.html#hcn-isomerization-reaction-with-neb">HCN isomerization reaction with NEB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Examples/NEB.html#h2-dissociation-on-graphene">H2 dissociation on graphene</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Examples/NEB.html#running-multiple-neb-calculations-using-plams">Running multiple NEB calculations using PLAMS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#intrinsic-reaction-coordinate-irc">Intrinsic reaction coordinate (IRC)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/IRC_HCN.html">Example: IRC for HCN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/TS_and_IRC_Claisen.html">Example: TS and IRC for Claisen reaction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#pes-scan">PES scan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/LinearTransit.html">Example: Linear transit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/PESScan.html">Example: 2D PES scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/PESScan_lattice.html">Example: PES scan for lattice degrees of freedom</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#pes-exploration">PES Exploration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/BasinHopping_Ar13.html">Example: Basin Hopping for Ar 13 cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/ProcessSearch_alanine.html">Example: PES Exploration, Process Search for alanine with PLAMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/BindingSites_O+Pt111.html">Example: PES Exploration, Binding Sites for O on Pt 111</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#molecular-dynamics">Molecular dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/MD_hydrogen_longrun.html">Example: Simple MD for H2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/H2O_nreac.html">Example: MD for a box of water</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/MD_Deformation.html">Example: Lattice deformations in MD</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#trajectory-replay">Trajectory replay</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/TrajectoryReplay.html">Example: Trajectory replays for PES scans, NEB and MD calculations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#vibrational-analysis">Vibrational analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/VATools_dydrogesterone.html">Example: Mode Refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/VATools_cyclohexanone.html">Example: Mode Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/VST_pyrene.html">Example: Vibronic-Structure Tracking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#pes-point-properties">PES point properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Phonons_Graphene.html">Example: Phonons for graphene</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Phonons_Isotopes.html">Example: Phonons with isotopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Phonons_UserBZPath.html">Example: User-defined Brillouin zone for phonon dispersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/ElasticTensor.html">Example: Elastic tensor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Examples.html#pipe-interface">Pipe interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Pipe_ASEWorker.html">Example: ASE calculator as a pipe worker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Examples/Pipe_AMSonAMS.html">Example: AMS as a pipe worker</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Appendices.html">Appendices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Appendices.html#extended-xyz-file-format">Extended XYZ file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Appendices.html#developer-options">Developer options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Appendices.html#symmetry">Symmetry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Appendices.html#schonfliess-symbols-and-symmetry-labels">Schönfliess symbols and symmetry labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Appendices.html#molecular-orientation-requirements">Molecular orientation requirements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Required_citations.html">Required citations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Required_citations.html#general-references">General references</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Required_citations.html#feature-references">Feature references</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Required_citations.html#frequencies-ir-intensities-raman-vcd">Frequencies, IR Intensities, Raman, VCD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Required_citations.html#pes-exploration">PES Exploration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Required_citations.html#external-programs-and-libraries">External programs and Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../keywords.html">Keywords</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../keywords.html#links-to-manual-entries">Links to manual entries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../keywords.html#summary-of-all-keywords">Summary of all keywords</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">AMS</a>
      </nav>
<!--ENDNOSOLR-->

      
      <div class="wy-nav-content">
        <div class="rst-content">
        <!--STARTNOSOLR-->
<div class="header" role="navigation" aria-label="breadcrumbs navigation">
 
  <ul class="wy-breadcrumbs">
    <li><a href="../AMS.html/../../Documentation/index.html">Documentation</a>/</li>
    <li><a href="../index.html">AMS</a>/</li>
      
          <li><a href="TOC.html">Structure and Reactivity, Molecular Dynamics</a>/</li>
      
    <li class="orange-text">Molecular dynamics</li>
  </ul>
  <p>
 
</div>
<!--ENDNOSOLR-->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="index-0"></span><div class="section" id="molecular-dynamics">
<span id="moleculardynamics"></span><span id="index-1"></span><h1>Molecular dynamics<a class="headerlink" href="#molecular-dynamics" title="Permalink to this headline">¶</a></h1>
<p>Molecular dynamics (MD) can be used to simulate the evolution of a system in
time.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="../Examples.html#examples"><span class="std std-ref">Examples</span></a></li>
<li><a class="reference external" href="../../Tutorials/MolecularDynamicsAndMonteCarlo/index.html">AMS GUI Tutorial</a></li>
<li><a class="reference internal" href="../Utilities/TrajectoryAnalysis.html#trajectory-analysis"><span class="std std-ref">MD trajectory analysis tool</span></a></li>
</ul>
</div>
<p>To perform a MD simulation, first select the corresponding <code class="docutils literal notranslate"><span class="pre">Task</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span> <span class="n">MolecularDynamics</span>
</pre></div>
</div>
<p>All aspects of the simulation can then be configured using the
<code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code> block.</p>
<div class="highlight-none notranslate" id="ams-key-moleculardynamics"><div class="highlight"><pre><span></span>MolecularDynamics
   AddMolecules
      AtomTemperature float
      ContactDistance float
      Coords float_list
      CoordsBox float_list
      CoordsSigma float_list
      DeviationAngle float
      Energy float
      EnergySigma float
      FractionalCoords float_list
      FractionalCoordsBox float_list
      FractionalCoordsSigma float_list
      Frequency integer
      MinDistance float
      MoleFraction float
      NumAttempts integer
      Rotate Yes/No
      StartStep integer
      StopStep integer
      System string
      Temperature float
      TemperatureSigma float
      Velocity float
      VelocityDirection float_list
      VelocitySigma float
   End
   Barostat
      BulkModulus float
      ConstantVolume Yes/No
      Duration integer_list
      Equal [None | XYZ | XY | YZ | XZ]
      Pressure float_list
      Scale [XYZ | Shape | X | Y | Z | XY | YZ | XZ]
      Tau float
      Type [None | Berendsen | MTK]
   End
   BondBoost
      Chain
         AtomNames string
         MaxDistances float_list
         MinDistances float_list
      End
      DistanceRestraint string
      Moving Yes/No
      NSteps integer
      NumInstances integer
      Units [Default | MD]
   End
   CRESTMTD
      AddEnergy Yes/No
      GaussianScaling
         ScaleGaussians Yes/No
         ScalingSlope float
      End
      Height float
      NGaussiansMax integer
      NSteps integer
      RestartFile string
      Width float
   End
   CVHD
      Bias
         DampingTemp float
         Delta float
         Height float
      End
      ColVarBB
         at1
            region string
            symbol string
         End
         at2
            region string
            symbol string
         End
         cutoff float
         p integer
         rmax float
         rmin float
      End
      Frequency integer
      StartStep integer
      StopStep integer
      WaitSteps integer
   End
   CalcPressure Yes/No
   Checkpoint
      Frequency integer
      WriteProperties Yes/No
   End
   Deformation
      LatticeVelocity # Non-standard block. See details.
         ...
      End
      LengthRate float_list
      LengthVelocity float_list
      Period float
      ScaleAtoms Yes/No
      StartStep integer
      StopStep integer
      StrainRate # Non-standard block. See details.
         ...
      End
      TargetLattice # Non-standard block. See details.
         ...
      End
      TargetLength float_list
      Type [Linear | Exponential | Sine | Cosine]
   End
   Gravity
      Acceleration float
   End
   HeatExchange
      HeatingRate float
      Method [Simple | HEX | eHEX]
      Sink
         AtomList integer_list
         Box
            Amax float
            Amin float
            Bmax float
            Bmin float
            Cmax float
            Cmin float
         End
         Region string
      End
      Source
         AtomList integer_list
         Box
            Amax float
            Amin float
            Bmax float
            Bmin float
            Cmax float
            Cmin float
         End
         Region string
      End
      StartStep integer
      StopStep integer
   End
   InitialVelocities
      File string
      Temperature float
      Type [Zero | Random | FromFile | Input]
      Values # Non-standard block. See details.
         ...
      End
   End
   NSteps integer
   Plumed
      Input # Non-standard block. See details.
         ...
      End
      Parallel
         nCoresPerGroup integer
         nGroups integer
         nNodesPerGroup integer
      End
   End
   Preserve
      AngularMomentum Yes/No
      CenterOfMass Yes/No
      Momentum Yes/No
   End
   Print
      System Yes/No
      Velocities Yes/No
   End
   Remap
      Type [None | Atoms]
   End
   RemoveMolecules
      Formula string
      Frequency integer
      SafeBox
         Amax float
         Amin float
         Bmax float
         Bmin float
         Cmax float
         Cmin float
         FractionalCoordsBox float_list
      End
      SinkBox
         Amax float
         Amin float
         Bmax float
         Bmin float
         Cmax float
         Cmin float
         FractionalCoordsBox float_list
      End
      StartStep integer
      StopStep integer
   End
   ReplicaExchange
      AllowWrongResults Yes/No
      EWMALength integer
      SwapFrequency integer
      TemperatureFactors float_list
      Temperatures float_list
      nReplicas integer
   End
   Restart string
   Shake
      All string
      ConvergeR2 float
      ConvergeRV float
      Iterations integer
   End
   Thermostat
      BerendsenApply [Local | Global]
      ChainLength integer
      Duration integer_list
      Region string
      Tau float
      Temperature float_list
      Type [None | Berendsen | NHC]
   End
   TimeStep float
   Trajectory
      PrintFreq integer
      SamplingFreq integer
      TProfileGridPoints integer
      WriteBonds Yes/No
      WriteCharges Yes/No
      WriteEngineGradients Yes/No
      WriteMolecules Yes/No
      WriteVelocities Yes/No
   End
   fbMC
      Frequency integer
      MassRoot float
      NSteps integer
      PrintFreq integer
      StartStep integer
      StepLength float
      StopStep integer
      Temperature float
   End
End
</pre></div>
</div>
<div class="section" id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<p>The time evolution of the system is simulated by numerically integrating the
equations of motion. A velocity Verlet integrator is used with a time step set
by the <code class="docutils literal notranslate"><span class="pre">TimeStep</span></code> key. The MD driver will perform <code class="docutils literal notranslate"><span class="pre">NSteps</span></code> timesteps in
total.</p>
<p>Because the overall computational cost depends on <code class="docutils literal notranslate"><span class="pre">NSteps</span></code> but not on
<code class="docutils literal notranslate"><span class="pre">TimeStep</span></code>, it is desirable to set the timestep as large as possible to
maximize the sampled timescale with a given computational budget. However,
numerical integration errors grow rapidly as the timestep increases. These
errors will cause a loss of energy conservation, crashes, and other artifacts.
It is thus important to set the <code class="docutils literal notranslate"><span class="pre">TimeStep</span></code> value carefully, as its optimal
value strongly depends on the studied system and simulated conditions.</p>
<p>As a rule of thumb, reasonable timesteps for systems not undergoing chemical
reactions are 10-20 times lower than the period of the fastest vibration mode.
Systems containing hydrogen atoms at room temperature can thus be accurately
simulated using a 1 fs timestep. Longer timesteps can be safely used for systems
containing only heavy atoms (vibration periods scale with the square root of the
atomic mass). Conversely, the timestep needs to be made shorter for
high-temperature simulations. The same also applies to simulations of chemical
reactions, which are usually accompanied by significant transient local heating.
The default timestep of 0.25 fs should work for most of these cases.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">NSteps</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1000</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Number of steps</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">The number of steps to be taken in the MD simulation.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">TimeStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.25</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Femtoseconds</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">The time difference per step.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
<p>During a long simulation, numerical integration errors will cause some
system-wide quantities to drift from their exact values. For example, the system
may develop a nonzero net linear velocity, causing an overall translation or
flow. Non-periodic (molecular) and 1D-periodic systems may also develop nonzero angular momentum
(overall rotation) and a Brownian motion of their center of mass through space.
These problems are corrected by periodically removing any accumulated drift.
This feature can be controlled using the <code class="docutils literal notranslate"><span class="pre">Preserve</span></code> key.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Preserve</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Periodically remove numerical drift accumulated during the simulation to preserve different whole-system parameters.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">AngularMomentum</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Yes</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">: Angular momentum</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Remove overall angular momentum of the system. This option is ignored for 2D and 3D-periodic systems.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CenterOfMass</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">: Center of mass</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Translate the system to keep its center of mass at the coordinate origin. This option is not very useful for 3D-periodic systems.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Momentum</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Yes</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Preserve: Total momentum</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Remove overall (linear) momentum of the system.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="constrained-molecular-dynamics">
<span id="constrainedmd"></span><h2>Constrained molecular dynamics<a class="headerlink" href="#constrained-molecular-dynamics" title="Permalink to this headline">¶</a></h2>
<p>There are two types of constraint available for MD: frozen atoms and Shake/Rattle.
Atoms can be kept frozen using the <code class="docutils literal notranslate"><span class="pre">Atom</span></code> or <code class="docutils literal notranslate"><span class="pre">AtomList</span></code> keys of the <code class="docutils literal notranslate"><span class="pre">Constraints</span></code> top-level input block.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Constraints</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Atom</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Fix the position of an atom. Just one integer referring to the index of the atom in the [System%Atoms] block.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">AtomList</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer List</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Fix positions of the specified atoms. A list of integers referring to indices of atoms in the [System%Atoms] block.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">During simulations with a changing simulation box (NpT, NpH), the absolute Cartesian coordinates of the frozen atoms cannot be kept fixed. In this case, their fractional cell coordinates are maintained at the original values.</p>
</div>
<p>The Shake/Rattle constraints are specified using the Shake input block:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Shake</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Parameters of the Shake/Rattle algorithm.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">All</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Bond constraint description in the format: 
All [bondOrder] bonds atomName1 atomName2 [to distance]
The [bondOrder] can be a number or a string such as single, double, triple or aromatic. If it’s omitted then all bonds between specified atoms will be constrained. Atom names are case-sensitive and they must be as they are in the Atoms block, or an asterisk ‘*’ denoting any atom. The distance, if present, must be in Angstrom. If it is omitted then the bond length from the initial geometry is used.

Valid examples:
All single bonds C C to 1.4
All bonds O H to 0.98
All bonds O H
All bonds H *</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ConvergeR2</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1e-08</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Convergence criterion on the max squared difference, in atomic units.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ConvergeRV</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1e-08</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Convergence criterion on the orthogonality of the constraint and the relative atomic velocity, in atomic units.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Iterations</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">100</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Number of iterations.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently it’s only possible to constrain bonds that are part of the System. This means that bonds not specified in the System block or not found by the engine will not be constrained.</p>
</div>
</div>
<div class="section" id="re-starting-a-simulation">
<span id="index-2"></span><h2>(Re-)Starting a simulation<a class="headerlink" href="#re-starting-a-simulation" title="Permalink to this headline">¶</a></h2>
<p>The state of a system at the beginning of a simulation is defined by the
positions and momenta of all atoms. The positions can be set in the input or
loaded from a file as described under <a class="reference internal" href="../System.html#systemdefinition"><span class="std std-ref">Geometry, System definition</span></a>. Initial
velocities are then supplied using the <code class="docutils literal notranslate"><span class="pre">InitialVelocities</span></code> block.</p>
<p>Probably the most common way to start up a simulation is to draw the initial
velocities from a Maxwell-Boltzmann distribution by setting <code class="docutils literal notranslate"><span class="pre">Type=Random</span></code> and
<code class="docutils literal notranslate"><span class="pre">Temperature</span></code> to a suitable value. Alternatively, velocities can be loaded
from an <code class="docutils literal notranslate"><span class="pre">ams.rkf</span></code> file produced by an earlier simulation using
<code class="docutils literal notranslate"><span class="pre">Type=FromFile</span></code> and <code class="docutils literal notranslate"><span class="pre">File</span></code>. This is the recommended way to start a
production simulation from the results of a short preparation/equilibration run.</p>
<p>Velocities of all atoms in units of Å/fs can also be explicitly defined in the
<code class="docutils literal notranslate"><span class="pre">Values</span></code> block after setting <code class="docutils literal notranslate"><span class="pre">Type=Input</span></code>. This is mainly useful to repeat
or extend simulations done by other programs. For example, velocities can be
extracted from the <code class="docutils literal notranslate"><span class="pre">vels</span></code> or <code class="docutils literal notranslate"><span class="pre">moldyn.vel</span></code> files used by the <a class="reference external" href="../../ReaxFF/index.html">standalone
ReaxFF</a> program. A simple AWK script is supplied in
<code class="docutils literal notranslate"><span class="pre">scripting/standalone/reaxff-ams/vels2ams.awk</span></code> to help with the conversion.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">InitialVelocities</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Sets the frequency for printing to stdout and storing the molecular configuration on the .rkf file.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">File</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">AMS RKF file containing the initial velocities.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Temperature</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Kelvin</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Initial temperature</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Sets the temperature for the Maxwell-Boltzmann distribution when the type of the initial velocities is set to random, in which case specifying this key is mandatory.

AMSinput will use the first temperature of the first thermostat as default.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Type</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Multiple Choice</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Random</td>
</tr>
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body">[Zero, Random, FromFile, Input]</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Initial velocities</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Specifies the initial velocities to assign to the atoms. Three methods to assign velocities are available.

Zero: All atom are at rest at the beginning of the calculation.

Random: Initial atom velocities follow a Maxwell-Boltzmann distribution for the temperature given by the [MolecularDynamics%InitialVelocities%Temperature] keyword.

FromFile: Load the velocities from a previous ams result file.

Input: Atom’s velocities are set to the values specified in the [MolecularDynamics%InitialVelocities%Values] block, which can be accessed via the Expert AMS panel in AMSinput.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Values</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Non-standard block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">This block specifies the velocity of each atom, in Angstrom/fs, when [MolecularDynamics%InitialVelocities%Type] is set to Input. Each row must contain three floating point values (corresponding to the x,y,z component of the velocity vector) and a number of rows equal to the number of atoms must be present, given in the same order as the [System%Atoms] block.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>The MD module also supports exact restarts of interrupted simulations by
pointing the <code class="docutils literal notranslate"><span class="pre">Restart</span></code> key to an <code class="docutils literal notranslate"><span class="pre">ams.rkf</span></code> file. This will restore the
entire state of the MD module from the last available checkpoint (if the
previous simulation was interrupted) or from the final state (if the previous
simulation ended after <code class="docutils literal notranslate"><span class="pre">NSteps</span></code>). An earlier trajectory can thus be seamlessly
extended by increasing <code class="docutils literal notranslate"><span class="pre">NSteps</span></code> and using <code class="docutils literal notranslate"><span class="pre">Restart</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">Restart</span></code> should be combined with <code class="docutils literal notranslate"><span class="pre">LoadSystem</span></code> from the same <code class="docutils literal notranslate"><span class="pre">ams.rkf</span></code>
to restore the atomic positions.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">Restart</span></code> feature is only intended for exact restarts, so the rest of
the <code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code> settings should be the same as in the original run.
Only <code class="docutils literal notranslate"><span class="pre">NSteps</span></code> and engine settings (contents of the <code class="docutils literal notranslate"><span class="pre">Engine</span></code> block) can
always be changed safely across restarts.</p>
</div>
<p>Although some MD settings (such as the trajectory sampling options) can in
practice be changed without problems, changing others (such as thermostat or
barostat settings) will cause the restart to fail or produce physically
incorrect results. It is thus strongly recommended to only use <code class="docutils literal notranslate"><span class="pre">Restart</span></code> for
exact continuation and <code class="docutils literal notranslate"><span class="pre">InitialVelocities</span> <span class="pre">Type=FromFile</span></code> together with
<code class="docutils literal notranslate"><span class="pre">LoadSystem</span></code> otherwise.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Restart</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Restart from</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">The path to the ams.rkf file from which to restart the simulation.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="thermostats-and-barostats">
<h2>Thermostats and barostats<a class="headerlink" href="#thermostats-and-barostats" title="Permalink to this headline">¶</a></h2>
<p>By default, the MD simulation samples the microcanonical (NVE) ensemble.
Although this is useful to check energy conservation and other basic physical
properties, it does not directly map to common experimental conditions. The
canonical (NVT) ensemble can be sampled instead by applying a <code class="docutils literal notranslate"><span class="pre">Thermostat</span></code>,
which serves as a simulated heat bath around the system, keeping its average
temperature at a set value.</p>
<p id="index-3">AMS offers two thermostats with drastically different properties, mode of
operation, and applicability, selected using the <code class="docutils literal notranslate"><span class="pre">Type</span></code> key:</p>
<dl class="docutils">
<dt>Berendsen</dt>
<dd><p class="first">The Berendsen friction thermostat drives the system to a particular target
temperature by rescaling the velocities of all atoms in each step. This
ensures rapid (exponential) convergence of the temperature with a time
constant <code class="docutils literal notranslate"><span class="pre">Tau</span></code>. However, this thermostat produces an incorrect velocity
distribution and should thus be avoided in all situations where correct
energy fluctuations are important. Additionally, using a too short time
constant <code class="docutils literal notranslate"><span class="pre">Tau</span></code> tends to cause incorrect equipartition of energy between
different degrees of freedom in the system, leading to the “flying ice cube”
phenomenon. The time constant <code class="docutils literal notranslate"><span class="pre">Tau</span></code> should thus be set as large as possible
to limit these artifacts while still providing sufficient temperature
control. Common values of <code class="docutils literal notranslate"><span class="pre">Tau</span></code> for condensed-phase systems lie between 100
fs (strong damping, rapid convergence) and 10 ps (weak coupling with minimal
artifacts).</p>
<p class="last">This thermostat is mainly useful for systems far from equilibrium, for
example during the initial preparation and equilibration phase of a
simulation. The <code class="docutils literal notranslate"><span class="pre">NHC</span></code> thermostat should be preferred where possible.</p>
</dd>
<dt>NHC</dt>
<dd>This enables a chain of coupled Nosé-Hoover thermostats. This method
introduces artificial degrees of freedom representing the heat bath and
ensures correct sampling of the canonical ensemble. The combined total energy
of the system and the heat bath is conserved and shown in the GUI as
<code class="docutils literal notranslate"><span class="pre">Conserved</span> <span class="pre">Energy</span></code>. Checking this quantity for drift and artifacts thus
offers a valuable test of the correctness of the simulation. This thermostat
exhibits oscillatory relaxation with a period of <code class="docutils literal notranslate"><span class="pre">Tau</span></code>. It is thus not well
suited for systems starting far from equilibrium, because the oscillations
may take long to settle. The time constant <code class="docutils literal notranslate"><span class="pre">Tau</span></code> should be at least
comparable to the period of some natural oscillation of the system to ensure
efficient energy transfer. It is commonly on the order of hundreds of
femtoseconds, although higher values may be used if weak coupling is desired.</dd>
</dl>
<p>Multiple independent thermostats can be used to separately control different
non-overlapping regions of the system at the same time. This is done by first defining appropriate
<a class="reference internal" href="../System.html#regions"><span class="std std-ref">Regions</span></a> in the <code class="docutils literal notranslate"><span class="pre">System</span></code> block and then specifying the <code class="docutils literal notranslate"><span class="pre">Thermostat</span></code> block
multiple times with the <code class="docutils literal notranslate"><span class="pre">Region</span></code> key of each thermostat set to an appropriate region expression.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Thermostat</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">This block allows to specify the use of a thermostat during the simulation. Depending on the selected thermostat type, different additional options may be needed to characterize the specific thermostat’ behavior.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">BerendsenApply</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Multiple Choice</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Global</td>
</tr>
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body">[Local, Global]</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Apply Berendsen</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Select how to apply the scaling correction for the Berendsen thermostat:

- per-atom-velocity (Local)
- on the molecular system as a whole (Global).</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ChainLength</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">10</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">NHC chain length</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Number of individual thermostats forming the NHC thermostat</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Duration</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer List</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Duration(s)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Specifies how many steps should a transition from a particular temperature to the next one in sequence take.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Region</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">*</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">The identifier of the region to thermostat. The default ‘*’ applies the thermostat to the entire system. The value can by a plain region name, or a region expression, e.g. ‘*-myregion’ to thermostat all atoms that are not in myregion, or ‘regionA+regionB’ to thermostat the union of the ‘regionA’ and ‘regionB’. Note that if multiple thermostats are used, their regions may not overlap.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Tau</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Femtoseconds</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Damping constant</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">The time constant of the thermostat.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Temperature</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Kelvin</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Temperature(s)</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">The target temperature of the thermostat.

You can specify multiple temperatures (separated by spaces). In that case the Duration field specifies how many steps to use for the transition from one T to the next T (using a linear ramp). For NHC thermostat, the temperature may not be zero.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Type</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Multiple Choice</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">None</td>
</tr>
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body">[None, Berendsen, NHC]</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Thermostat</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Selects the type of the thermostat.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>Just like using a <code class="docutils literal notranslate"><span class="pre">Thermostat</span></code> to control the temperature of the system, a
<code class="docutils literal notranslate"><span class="pre">Barostat</span></code> can be applied to keep the pressure constant by adjusting the
volume. This enables sampling the isenthalpic-isobaric (NpH) ensemble by using
only a barostat or the isothermal-isobaric (NpT) ensemble by combining a
barostat and a thermostat. Unlike thermostats, a barostat always applies to the
entire system and there can thus be at most one barostat defined.</p>
<p id="index-4">AMS offers two barostats with similar properties to the related thermostats:</p>
<dl class="docutils">
<dt>Berendsen</dt>
<dd>The Berendsen friction-like isobaric ensemble method rescales the system in
each step to drive the pressure towards a target value. Similarly to the
<code class="docutils literal notranslate"><span class="pre">Berendsen</span></code> thermostat, the relaxation is exponential with a time constant
<code class="docutils literal notranslate"><span class="pre">Tau</span></code>. Similar considerations for the choice of <code class="docutils literal notranslate"><span class="pre">Tau</span></code> apply as in the
case of the thermostat, but the value of <code class="docutils literal notranslate"><span class="pre">Tau</span></code> for the barostat is
usually at least several times higher than the corresponding <code class="docutils literal notranslate"><span class="pre">Tau</span></code> used for
the thermostat. This barostat does not have any conserved quantity.</dd>
<dt>MTK</dt>
<dd>This enables the Martyna-Tobias-Klein extended Lagrangian barostat, which
generates a true isobaric ensemble by integrating the cell parameters as
additional degrees of freedom. This barostat is derived from the
Andersen-Hoover isotropic barostat and the Parrinello-Rahman-Hoover
anisotropic barostat. Like the <code class="docutils literal notranslate"><span class="pre">NHC</span></code> thermostat, it exhibits oscillatory
relaxation unsuitable for systems far from equilibrium. This barostat must
always be combined with a <code class="docutils literal notranslate"><span class="pre">NHC</span></code> thermostat. One instance of such thermostat
coupled to the atoms as usual, while a second instance is created internally
and coupled to the cell degrees of freedom.</dd>
</dl>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Barostat</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">This block allows to specify the use of a barostat during the simulation.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">BulkModulus</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">2200000000.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Pascal</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">An estimate of the bulk modulus (inverse compressibility) of the system for the Berendsen barostat.

This is only used to make Tau correspond to the true observed relaxation time constant. Values are commonly on the order of 10-100 GPa (1e10 to 1e11) for solids and 1 GPa (1e9) for liquids (2.2e9 for water). Use 1e9 to match the behavior of standalone ReaxFF.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ConstantVolume</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Keep the volume constant while allowing the box shape to change.

This is currently supported only by the MTK barostat.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Duration</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer List</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Specifies how many steps should a transition from a particular pressure to the next one in sequence take.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Equal</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Multiple Choice</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">None</td>
</tr>
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body">[None, XYZ, XY, YZ, XZ]</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Enforce equal scaling of the selected set of dimensions. They will be barostatted as one dimension according to the average pressure over the components.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Pressure</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Pascal</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Specifies the target pressure. 

You can specify multiple pressures (separated by spaces). In that case the Duration field specifies how many steps to use for the transition from one p to the next p (using a linear ramp).</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Scale</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Multiple Choice</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">XYZ</td>
</tr>
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body">[XYZ, Shape, X, Y, Z, XY, YZ, XZ]</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Dimensions that should be scaled by the barostat to maintain pressure. Selecting Shape means that all three dimensions and also all the cell angles are allowed to change.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Tau</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Femtoseconds</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Damping constant</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Specifies the time constant of the barostat.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Type</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Multiple Choice</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">None</td>
</tr>
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body">[None, Berendsen, MTK]</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Barostat</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Selects the type of the barostat.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<span class="target" id="index-5"></span><div class="section" id="temperature-and-pressure-regimes">
<span id="index-6"></span><h3>Temperature and pressure regimes<a class="headerlink" href="#temperature-and-pressure-regimes" title="Permalink to this headline">¶</a></h3>
<p>Arbitrary temperature and pressure regimes can be generated by setting
<code class="docutils literal notranslate"><span class="pre">Temperature</span></code> or <code class="docutils literal notranslate"><span class="pre">Pressure</span></code> to a list of values, corresponding to the
successive set points. This needs to be accompanied by a <code class="docutils literal notranslate"><span class="pre">Duration</span></code> key
specifying the length of each regime segment in steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Thermostat</span>
   <span class="n">Temperature</span> <span class="mi">0</span>     <span class="mi">300</span>     <span class="mi">300</span>     <span class="mi">500</span>     <span class="mi">500</span>     <span class="mi">300</span>
   <span class="n">Duration</span>      <span class="mi">100</span>     <span class="mi">200</span>     <span class="mi">100</span>     <span class="mi">200</span>     <span class="mi">100</span>
<span class="n">End</span>
</pre></div>
</div>
<p>Note that there is always N-1 <code class="docutils literal notranslate"><span class="pre">Duration</span></code> values for N <code class="docutils literal notranslate"><span class="pre">Temperature</span></code> values.
The target temperature of the thermostat in this example will evolve as follows:</p>
<ol class="arabic simple">
<li>Increase linearly from 0 to 300 K over 100 steps.</li>
<li>Stay constant at 300 K for 200 steps.</li>
<li>Increase linearly from 300 to 500 K over 100 steps.</li>
<li>Stay constant at 500 K for 200 steps.</li>
<li>Decrease linearly from 500 to 300 K over 100 steps.</li>
<li>Stay constant at 300 K for the rest of the simulation.</li>
</ol>
</div>
</div>
<div class="section" id="trajectory-sampling-and-output">
<span id="trajectory-sampling"></span><span id="index-7"></span><h2>Trajectory sampling and output<a class="headerlink" href="#trajectory-sampling-and-output" title="Permalink to this headline">¶</a></h2>
<p>A basic principle of the numerical integration of motion in MD is that the
changes in the state of the system between successive time steps are small. This
means that storing the results of every step is not useful, because all the data
is strongly correlated. Instead, a snapshot of the system is taken every N steps,
where N is set low enough to still capture the fastest motion of interest but
high enough to avoid wasting space due to correlations. The resulting sequence
of snapshots is then commonly called the trajectory.</p>
<p>AMS writes the trajectory to the <code class="docutils literal notranslate"><span class="pre">History</span></code> and <code class="docutils literal notranslate"><span class="pre">MDHistory</span></code> sections of
<code class="docutils literal notranslate"><span class="pre">ams.rkf</span></code>, according to the settings in the <code class="docutils literal notranslate"><span class="pre">Trajectory</span></code> block. A snapshot
of the system and various MD variables is stored every <code class="docutils literal notranslate"><span class="pre">SamplingFreq</span></code>
timesteps. By default, this frequency is also used to print basic thermodynamic
parameters of the simulation to the output and log file. Set <code class="docutils literal notranslate"><span class="pre">PrintFreq</span></code>
to override this.</p>
<p>Frequently sampling a long trajectory can generate large volumes of data.
If the space usage becomes a concern, one can selectively disable storing
some parts of the trajectory to save space using the <code class="docutils literal notranslate"><span class="pre">Write*</span></code> keys. Note
however that this will make it impossible to use some analysis methods on the
resulting trajectory:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">WriteBonds</span></code> is necessary for reaction network analysis (ChemTraYzer).
Disabling <code class="docutils literal notranslate"><span class="pre">WriteBonds</span></code> also makes AMSmovie show only guessed bonds instead
of those calculated by the engine.</li>
<li><code class="docutils literal notranslate"><span class="pre">WriteMolecules</span></code> is required by the Molecule Fractions panel in AMSmovie.</li>
<li><code class="docutils literal notranslate"><span class="pre">WriteVelocities</span></code> is required to calculate the velocity autocorrelation
functions needed for diffusivity and IR spectra.</li>
</ul>
<p>The trajectory itself contains only the data needed for subsequent analysis of
the dynamics of the system. However, much more data is usually generated on
every integration step. This includes, for example, the internal data used by an
engine when evaluating the energies and forces. This information is normally
discarded after each step, because it is often very large. However, a
<code class="docutils literal notranslate"><span class="pre">Checkpoint</span></code> containing the complete internal state of the MD driver together
with a result file generated by the engine is stored every <code class="docutils literal notranslate"><span class="pre">Frequency</span></code> steps.
An interrupted simulation can then be restarted from this checkpoint using the
<code class="docutils literal notranslate"><span class="pre">Restart</span></code> keyword. Additionally, the engine result files called
<code class="docutils literal notranslate"><span class="pre">MDStep*.rkf</span></code> can also be used to extract various engine-specific details
about the system, such as the orbitals for QM engines.</p>
<dl class="docutils" id="index-8">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Trajectory</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Sets the frequency for printing to stdout and storing the molecular configuration on the .rkf file.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">PrintFreq</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Printing frequency</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Print current thermodynamic properties to the output every N steps. By default this is done every SamplingFreq steps.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SamplingFreq</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">100</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Sample frequency</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Write the the molecular geometry (and possibly other properties) to the .rkf file once every N steps.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">TProfileGridPoints</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Number of points in the temperature profile. If TProfileGridPoints &gt; 0, a temperature profile along each of the three unit cell axes will be written to the .rkf file. By default, no profile is generated.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">WriteBonds</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Yes</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Write detected bonds to the .rkf file.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">WriteCharges</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Yes</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Write current atomic point charges (if available) to the .rkf file. Disable this to reduce trajectory size if you do not need to analyze charges.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">WriteEngineGradients</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Write atomic gradients (negative of the atomic forces, as calculated by the engine) to the History section of ams.rkf.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">WriteMolecules</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Yes</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Write the results of molecule analysis to the .rkf file.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">WriteVelocities</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Yes</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Write velocities to the .rkf file. Disable this to reduce trajectory size if you do not need to analyze the velocities.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Checkpoint</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Sets the frequency for storing the entire MD state necessary for restarting the calculation.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Frequency</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1000</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Checkpoint frequency</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Write the MD state and engine-specific data to the respective .rkf files once every N steps.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">WriteProperties</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Write the properties from the properties section to the ChecoPoint file once every N steps.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CalcPressure</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Calculate the pressure in periodic systems.

This may be computationally expensive for some engines that require numerical differentiation.

Some other engines can calculate the pressure for negligible additional cost and will always do so, even if this option is disabled.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Print</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">This block controls the printing of additional information to stdout.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">System</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Print the chemical system before and after the simulation.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Velocities</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Print the atomic velocities before and after the simulation.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<span class="target" id="mddeformation"></span><span class="target" id="index-9"></span></div>
<div class="section" id="lattice-deformations-volume-regimes">
<span id="index-10"></span><h2>Lattice deformations (volume regimes)<a class="headerlink" href="#lattice-deformations-volume-regimes" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Deformation</span></code> block can be used to gradually deform the periodic lattice of
the system during a MD simulation. This block can be repeated to define multiple
deformations, which will be applied on every MD step in the order in which they
are listed in the input.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../Examples/MD_Deformation.html#example-md-deformation"><span class="std std-ref">Example demonstrating various lattice deformations</span></a></p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">While a <code class="docutils literal notranslate"><span class="pre">Deformation</span></code> and a <code class="docutils literal notranslate"><span class="pre">Barostat</span></code> can be used at the same time, remember
to set the <code class="docutils literal notranslate"><span class="pre">Scale</span></code> parameter of the barostat so that no dimension is simultaneously
being deformed and barostatted.</p>
</div>
<p>Each <code class="docutils literal notranslate"><span class="pre">Deformation</span></code> block will be active on MD steps between <code class="docutils literal notranslate"><span class="pre">StartStep</span></code> and <code class="docutils literal notranslate"><span class="pre">StopStep</span></code>.</p>
<p>The time dependence of the lattice parameters is defined by the <code class="docutils literal notranslate"><span class="pre">Type</span></code> key:</p>
<dl class="docutils">
<dt>Linear</dt>
<dd>This deformation type adds the same constant amount to the selected lattice parameters
on every simulation step. When used with <code class="docutils literal notranslate"><span class="pre">TargetLattice</span></code>, <code class="docutils literal notranslate"><span class="pre">LatticeVelocity</span></code>, or <code class="docutils literal notranslate"><span class="pre">StrainRate</span></code>,
the lattice matrix <span class="math notranslate nohighlight">\(H\)</span> evolves as <span class="math notranslate nohighlight">\(H(t) = H_0 + \Delta H \cdot t\)</span>,
where <span class="math notranslate nohighlight">\(H_0\)</span> is the lattice at <code class="docutils literal notranslate"><span class="pre">StartStep</span></code>.</dd>
<dt>Exponential</dt>
<dd>When used with <code class="docutils literal notranslate"><span class="pre">StrainRate</span></code>, this type strains the lattice by the given strain matrix <code class="docutils literal notranslate"><span class="pre">\epsilon</span></code>
on every step, so that the lattice matrix <span class="math notranslate nohighlight">\(H\)</span> evolves as <span class="math notranslate nohighlight">\(H(t) = H_0 (1 + \epsilon)^t\)</span>.
When used with <code class="docutils literal notranslate"><span class="pre">LengthRate</span></code>, the length of each lattice vector evolves as
<span class="math notranslate nohighlight">\(l(t) = l_0 (1 + r)^t\)</span>.</dd>
<dt>Sine</dt>
<dd>This is a periodic deformation going from the starting value of the selected lattice
parameters to a set target, and then with the same amplitude to the opposite direction
from the starting lattice.</dd>
<dt>Cosine</dt>
<dd>This periodic deformation oscillates between the starting lattice and a defined target.</dd>
</dl>
<p>The period of the oscillation for the <code class="docutils literal notranslate"><span class="pre">Sine</span></code> and <code class="docutils literal notranslate"><span class="pre">Cosine</span></code> types must be set using
the <code class="docutils literal notranslate"><span class="pre">Period</span></code> key.</p>
<p>The extent of the deformation is defined by setting one of the six mutually exclusive input
keys. These belong to two groups, depending on whether they operate on the lattice matrix
as a whole, or just on the lengths of the individual lattice vectors:</p>
<dl class="docutils">
<dt>TargetLattice, Velocity, and Rate</dt>
<dd>These input keys expect a “lattice-like” matrix of numbers, consisting of up to three rows
containing up to three values each. Each row contains the components of a single lattice vector
and corresponds to a row of the <a class="reference internal" href="../System.html#lattice-vectors"><span class="std std-ref">Lattice block</span></a>. For systems with 1D or
2D periodicity the matrix may be padded to 3x3 with zeros.</dd>
<dt>TargetLength, LengthVelocity, and LengthRate</dt>
<dd>These input keys expect a list of up to three values, defining the desired length of each lattice
vector or the (absolute or relative) rate of its change.</dd>
</dl>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Deformation</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Deform the periodic lattice of the system during the simulation.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">LatticeVelocity</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Non-standard block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Velocity of individual lattice vector components in Angstrom/fs. The format is identical to the System%Lattice block. For Type Sine and Cosine, this defines the maximum velocity (at the inflection point).</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">LengthRate</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">[0.0, 0.0, 0.0]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Relative rate of change of each lattice vector per step.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">LengthVelocity</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">[0.0, 0.0, 0.0]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Angstrom/fs</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Change the length of each lattice vector with this velocity. With Type=Exponential, LengthVelocity is divided by the current lattice vector lengths on StartStep to determine a LengthRate, which is then applied on all subsequent steps. For Type Sine and Cosine, this defines the maximum velocity (at the inflection point).</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Period</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Femtoseconds</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Period of oscillation for Type Sine and Cosine.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ScaleAtoms</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Yes</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Scale the atomic positions together with the lattice vectors. Disable this to deform only the lattice, keeping the coordinates of atoms unchanged.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StartStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">First step at which the deformation will be applied.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StopStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Last step at which the deformation will be applied. If unset or zero, nSteps will be used instead.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StrainRate</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Non-standard block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Strain rate matrix to be applied on every step. The format is identical to the System%Lattice block.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">TargetLattice</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Non-standard block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Target lattice vectors to be achieved by StopStep. The format is identical to the System%Lattice block.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">TargetLength</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">[0.0, 0.0, 0.0]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Target lengths of each lattice vector to be achieved by StopStep. The number of values should equal the periodicity of the system. If a value is zero, the corresponding lattice vector will not be modified.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Type</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Multiple Choice</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Linear</td>
</tr>
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body">[Linear, Exponential, Sine, Cosine]</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Function defining the time dependence of the deformed lattice parameters.

Linear increments the lattice parameters by the same absolute amount every timestep. Exponential multiplies the lattice parameters by the same factor every timestep. Only StrainRate, LengthRate, and LengthVelocity are supported for Type=Exponential. Sine deforms the system from the starting lattice to TargetLattice/TargetLength and then by the same amount to the opposite direction, while Cosine deforms the system from the starting lattice to the target and back.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>Example: Transition from the initial lattice to a 10 Å cube over 1000 steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MolecularDynamics</span>
   <span class="n">Deformation</span>
      <span class="n">StopStep</span> <span class="mi">1000</span>
      <span class="n">TargetLattice</span>
         <span class="mf">10.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
          <span class="mf">0.0</span> <span class="mf">10.0</span>  <span class="mf">0.0</span>
          <span class="mf">0.0</span>  <span class="mf">0.0</span> <span class="mf">10.0</span>
      <span class="n">End</span>
   <span class="n">End</span>
<span class="n">End</span>
</pre></div>
</div>
<p>Example: Oscillate the length of the <em>c</em> lattice vector between the initial value and 20 Å, leaving the <em>a</em> and <em>b</em> vectors unchanged:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MolecularDynamics</span>
   <span class="n">Deformation</span>
      <span class="n">Type</span> <span class="n">Cosine</span>
      <span class="n">Period</span> <span class="mi">100</span>
      <span class="n">TargetLength</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">20</span>
   <span class="n">End</span>
<span class="n">End</span>
</pre></div>
</div>
<p>Example: Stretch the box in the “z” direction by a true exponential strain of 10 ppm per timestep while barostatting the remaining dimensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MolecularDynamics</span>
   <span class="n">Barostat</span> <span class="n">Type</span><span class="o">=</span><span class="n">MTK</span> <span class="n">Pressure</span><span class="o">=</span><span class="mf">1e5</span> <span class="n">Tau</span><span class="o">=</span><span class="mi">1000</span> <span class="n">Scale</span><span class="o">=</span><span class="n">XY</span>
   <span class="n">Deformation</span>
      <span class="n">Type</span> <span class="n">Exponential</span>
      <span class="n">StrainRate</span>
          <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
          <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
          <span class="mf">0.0</span>  <span class="mf">0.0</span> <span class="mf">1e-5</span>
      <span class="n">End</span>
   <span class="n">End</span>
<span class="n">End</span>
</pre></div>
</div>
<span class="target" id="mdaddmolecules"></span><span class="target" id="index-11"></span></div>
<div class="section" id="molecule-gun-adding-molecules-during-simulation">
<span id="index-12"></span><h2>Molecule Gun: adding molecules during simulation<a class="headerlink" href="#molecule-gun-adding-molecules-during-simulation" title="Permalink to this headline">¶</a></h2>
<p>The molecule gun allows you to “shoot” (add with velocity) a molecule into the simulation box.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference external" href="../../Tutorials/MolecularDynamicsAndMonteCarlo/MoleculeGun.html">GUI tutorial</a> on the molecule gun.</p>
</div>
<p>Molecules can be continuously added to the simulation or only once. The initial position
can be pre-set or be random within the simulation box or a part thereof. It can be defined either in the
Cartesian or fractional coordinates. The initial velocity can be specified either directly (in Angstrom per femtosecond)
or as translational temperature or kinetic energy.
Possible applications of the molecule gun include e.g. the simulation of enforced collisions or deposition
processes on surfaces.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">AddMolecules</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Add molecules</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">This block controls adding molecules to the system (a.k.a. the Molecule Gun). Multiple occurrences of this block are possible. 

 By default, molecules are added at random positions in the simulation box with velocity matching the current system temperature. The initial position can be modified using one of the following keywords: Coords, CoordsBox, FractionalCoords, FractionalCoordsBox. The Coords and FractionalCoords keys can optionally be accompanied by CoordsSigma or FractionalCoordsSigma, respectively.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">AtomTemperature</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Kelvin</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Add random velocity corresponding to the specified temperature to individual atoms of the molecule. This only affects rotational and internal degrees of freedom, not the net translational velocity of the inserted molecule as set by the other options.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ContactDistance</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Translate the bullet along the velocity vector until it comes within ContactDistance of any other atom.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Coords</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Place molecules at or around the specified Cartesian coordinates.

This setting takes precedence over other ways to specify initial coordinates of the molecule: [CoordsBox], [FractionalCoords], and [FractionalCoordsBox].</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CoordsBox</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Place molecules at random locations inside the specified box in Cartesian coordinates.

Coordinates of the box corners are specified as: Xmin, Xmax, Ymin, Ymax, Zmin, Zmax.
This setting is ignored if Coords is used.

In AMSinput, if this field is not empty it will be used instead of the default Coords.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CoordsSigma</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Sigma values (one per Cartesian axis) for a Gauss distribution of the initial coordinates. Can only be used together with Coords.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">DeviationAngle</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Degree</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Randomly tilt the shooting direction up to this angle away from the VelocityDirection vector.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Energy</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Hartree</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Initial kinetic energy of the molecule in the shooting direction.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">EnergySigma</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Hartree</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Sigma value for the Gauss distribution of the initial kinetic energy around the specified value. Should only be used together with Energy.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FractionalCoords</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Place molecules at or around the specified fractional coordinates in the main system’s lattice. For non-periodic dimensions a Cartesian value in Angstrom is expected. This setting is ignored if [Coords] or [CoordsBox] is used.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FractionalCoordsBox</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Place molecules at random locations inside the box specified as fractional coordinates in the main system’s lattice.

Coordinates of the box corners are specified as: Xmin, Xmax, Ymin, Ymax, Zmin, Zmax.

For non-periodic dimensions the Cartesian value in Angstrom is expected.

This setting is ignored if [Coords], [CoordsBox], or [FractionalCoords] is used.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FractionalCoordsSigma</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Sigma values (one per axis) for a Gauss distribution of the initial coordinates. For non-periodic dimensions the Cartesian value in Angstrom is expected. Can only be used together with FractionalCoords.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Frequency</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">A molecule is added every [Frequency] steps after the StartStep.

There is never a molecule added at step 0.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MinDistance</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Keep the minimal distance to other atoms of the system when adding the molecule.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MoleFraction</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Defines a mixture to be deposited using one AddMolecules block per component.

AMS will randomly alternate between any guns that have MoleFraction set. These need to all have the same settings for StartStep, StopStep and Frequency. Any additional AddMolecules blocks without MoleFraction will remain completely independent.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">NumAttempts</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">10</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Try adding the molecule up to the specified number of times or until the MinDistance constraint is satisfied. If all attempts fail a message will be printed and the simulation will continue normally.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Rotate</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Rotate the molecule randomly before adding it to the system.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StartStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Step number when the first molecule should be added. After that, molecules are added every Frequency steps.

 For example, ff StartStep=99 and Frequency=100 then a molecule will be added at steps 99, 199, 299, etc…

No molecule will be added at step 0, so if StartStep=0 the first molecule is added at the step number equal to [Frequency].</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StopStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Do not add this molecule after the specified step.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">System</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">String ID of the [System] that will be added with this ‘gun’.

The lattice specified with this System is ignored and the main system’s lattice is used instead.

AMSinput adds the system at the coordinates of the System (thus setting Coords to the center of the System).</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Temperature</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Kelvin</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Initial energy of the molecule in the shooting direction will correspond to the given temperature.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">TemperatureSigma</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Kelvin</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Sigma value for the Gauss distribution of the initial temperature the specified value. Should only be used together with Temperature.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Velocity</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Angstrom/fs</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Initial velocity of the molecule in the shooting direction.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">VelocityDirection</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Velocity direction vector for aimed shooting. It will be random if not specified.

In AMSinput add one or two atoms (which may be dummies).

One atom: use vector from center of the system to add to that atom.

Two atoms: use vector from the first to the second atom.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">VelocitySigma</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Angstrom/fs</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Sigma value for the Gauss distribution of the initial velocity around the specified value. Should only be used together with Velocity.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<span class="target" id="mdremovemolecules"></span></div>
<div class="section" id="removing-molecules-during-simulation">
<span id="index-13"></span><h2>Removing molecules during simulation<a class="headerlink" href="#removing-molecules-during-simulation" title="Permalink to this headline">¶</a></h2>
<p>Molecules <a class="reference internal" href="../Properties.html#bondorders"><span class="std std-ref">detected</span></a> by the AMS driver can also be removed from
the system. This feature can, for example, be used to remove reaction products.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">RemoveMolecules</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Remove molecules</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">This block controls removal of molecules from the system. Multiple occurrences of this block are possible.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Formula</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Molecular formula of the molecules that should be removed from the system. 

The order of elements in the formula is very important and the correct order is: C, H, all other elements in the strictly alphabetic order. 
Element names are case-sensitive, spaces in the formula are not allowed. Digit ‘1’ must be omitted. 

Valid formula examples: C2H6O, H2O, O2S. Invalid formula examples: C2H5OH, H2O1, OH, SO2. Invalid formulas are silently ignored. 

Use * to remove any molecule, which must be combined with SinkBox or SafeBox.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Frequency</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">The specified molecules are removed every so many steps after the StartStep. There is never a molecule removed at step 0.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SafeBox</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Part of the simulation box where molecules may not be removed. Only one of the SinkBox or SafeBox blocks may be present. If this block is present the molecule will not be removed if any of its atoms is within the box. For a periodic dimension it is given as a fraction of the simulation box (the full 0 to 1 range by default). For a non-periodic dimension it represents absolute Cartesian coordinates in Angstrom.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Amax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the first axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Amin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the first axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Bmax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the second axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Bmin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the second axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Cmax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the third axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Cmin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the third axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FractionalCoordsBox</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Safe box</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Do not remove molecules that are (partly) inside the safe box.

Borders of the safe box specified as: Amin, Amax, Bmin, Bmax, Cmin, Cmax.

For periodic dimensions fractional coordinates between 0 and 1 and for non-periodic dimensions Cartesian values in Angstrom are expected.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SinkBox</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Part of the simulation box where matching molecules will be removed. By default, molecules matching the formula will be removed regardless of their location. If this block is present then such a molecule will only be removed if any of its atoms is within the box. For a periodic dimension it is given as a fraction of the simulation box (the full 0 to 1 range by default). For a non-periodic dimension it represents absolute Cartesian coordinates in Angstrom.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Amax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the first axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Amin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the first axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Bmax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the second axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Bmin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the second axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Cmax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the third axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Cmin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the third axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">FractionalCoordsBox</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Sink box</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Remove molecules that are (partly) inside the sink box.

Borders of the sink box specified as: Amin, Amax, Bmin, Bmax, Cmin, Cmax.

For periodic dimensions fractional coordinates between 0 and 1 and for non-periodic dimensions Cartesian values in Angstrom are expected.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StartStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Step number when molecules are removed for the first time. After that, molecules are removed every [Frequency] steps.

For example, if StartStep=99 and Frequency=100 then molecules will be removed at steps 99, 199, 299, etc…

No molecule will be removed at step 0, so if StartStep=0 the first molecules are removed at the step number equal to [Frequency].</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StopStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Do not remove the specified molecules after this step.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When there is a Molecules%AdsorptionSupportRegion defined, the molecule formulas depend on whether the molecule is adsorbed or not.</p>
</div>
</div>
<div class="section" id="accelerated-dynamics">
<h2>Accelerated dynamics<a class="headerlink" href="#accelerated-dynamics" title="Permalink to this headline">¶</a></h2>
<span class="target" id="mdplumedlibrary"></span><div class="section" id="the-plumed-library-support-in-ams">
<span id="index-14"></span><h3>The PLUMED library support in AMS<a class="headerlink" href="#the-plumed-library-support-in-ams" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://www.plumed.org/">PLUMED</a> is a plugin that works with various MD programs and is also available in AMS. It can be used for on-the-fly analysis of the dynamics, or to perform a wide variety of free energy methods. The interface with the plugin is really simple: you just need to specify the PLUMED input in the MolecularDynamics%Plumed%Input block and it will be passed to the library “as is”. At each MD step, the current state of the system will be passed to the plugin to be updated according to the PLUMED input.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Plumed</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Input for PLUMED. The parallel option is still experimental.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Input</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Non-standard block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Input for PLUMED. Contents of this block is passed to PLUMED as is.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Parallel</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Options for double parallelization, which allows to split the available processor cores into groups working through all the available tasks in parallel, resulting in a better parallel performance. The keys in this block determine how to split the available processor cores into groups working in parallel.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">nCoresPerGroup</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Cores per group</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Number of cores in each working group.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nGroups</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Number of groups</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Total number of processor groups. This is the number of tasks that will be executed in parallel.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nNodesPerGroup</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Nodes per group</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Number of nodes in each group. This option should only be used on homogeneous compute clusters, where all used compute nodes have the same number of processor cores.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<span class="target" id="crestmetadynamics"></span></div>
<div class="section" id="metadynamics-for-conformer-rotamer-ensemble-sampling-crest-mtd">
<span id="index-15"></span><h3>Metadynamics for Conformer-Rotamer Ensemble Sampling (CREST-MTD)<a class="headerlink" href="#metadynamics-for-conformer-rotamer-ensemble-sampling-crest-mtd" title="Permalink to this headline">¶</a></h3>
<p>This is a very specific implementation of metadynamics that is only meant for exploration of conformer space,
as used in the Conformer-Rotamer Ensemble Sampling (CREST) approach.
It is an RMSD-based metadynamics that places a new 1-dimensional Gaussian on the potential energy surface every <code class="docutils literal notranslate"><span class="pre">NSteps</span></code> steps.
The Gaussian is a function of the RMSD from the current geometry,
which will  always be zero at the moment of placement.
All Gaussians have the same maximum height (<code class="docutils literal notranslate"><span class="pre">Height</span></code>) and the same width (<code class="docutils literal notranslate"><span class="pre">Width</span></code>).
There is an upper limit of <code class="docutils literal notranslate"><span class="pre">NGaussiansMax</span></code> to the number of Gaussians present in the system,
and when this is exceeded the oldest Gaussian is removed.
By default the Gaussians are gradually introduced, using a scaling function that increases from 0 to 1
with the  simulation time. The keyword <code class="docutils literal notranslate"><span class="pre">ScalingSlope</span></code> in the inputblock <code class="docutils literal notranslate"><span class="pre">GaussianScaling</span></code> determines the
slope of the scaling function with respect to time. The default value of 0.03 <span class="math notranslate nohighlight">\(steps^{-1}\)</span> yields a scaling factor of
nearly 1 after 100 steps.
The keyword <code class="docutils literal notranslate"><span class="pre">ScaleGaussians</span></code> in the inputblock <code class="docutils literal notranslate"><span class="pre">GaussianScaling</span></code> determines whether the Gaussians are scaled at all.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">CRESTMTD</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">CREST_MTD</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Input for CREST metadynamics simulation.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">AddEnergy</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Add the bias energy to the potential energy (to match the gradients)</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">GaussianScaling</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Options for gradual introduction of the Gaussians</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">ScaleGaussians</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Yes</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Introduce the Gaussians gradually, using a scaling function</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ScalingSlope</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.03</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Slope of the scaling function for the Gaussians with respect to time</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Height</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Hartree</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">The height of the Gaussians added</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">NGaussiansMax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Maximum number of Gaussians stored</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">NSteps</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Interval of Gaussian placement</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">RestartFile</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Filename for file from which to read data on Gaussians placed previously.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Width</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Bohr</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">The width of the Gaussians added in terms of the RMSD</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>By default the gradients of the Gaussians with respect to the atom coordinates are added to the state gradients,
but the value of the Gaussians is not added to the energy,
which is common in metadynamics.
For testing purposes it can be useful to add the Gaussian value to the energy, and this can be done with the
keyword <code class="docutils literal notranslate"><span class="pre">AddEnergy</span></code>.
Irrespective of this choice, the energy value of the Gaussian at each geometry is printed in the ams.rkf file
in the section CrestMTDHistory.
It is also possible to use Gaussians from an earlier CREST-MTD simulation,
using the keyword <code class="docutils literal notranslate"><span class="pre">RestartFile</span></code>.</p>
<span class="target" id="cvhd"></span></div>
<div class="section" id="collective-variable-driven-hyperdynamics-cvhd">
<span id="index-16"></span><h3>Collective Variable-driven HyperDynamics (CVHD)<a class="headerlink" href="#collective-variable-driven-hyperdynamics-cvhd" title="Permalink to this headline">¶</a></h3>
<p>The Collective Variable-driven HyperDynamics is a molecular dynamics acceleration method that allows observation of rare events by filling energy minima with a bias potential. In this sense it is similar to metadynamics. The difference of the hyperdynamics is that it ensures that the bias disappears in the transition state region. This difference allows hyperdynamics to calculate the rate of slow processes, for example the ignition phase of combustion.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference external" href="../../Tutorials/MolecularDynamicsAndMonteCarlo/CVHD.html">GUI tutorial</a> on CVHD.</p>
</div>
<p>The CVHD implementation in AMS follows the algorithm described in <a class="reference external" href="https://doi.org/10.1021/acs.jctc.5b00597">K.M. Bal, E.C. Neyts, JCTC, 11 (2015)</a></p>
<p>The StartStep, Frequency, StopStep, and WaitSteps keys define when and how often the bias potential is added, and when it is removed. The Bias block defines parameters of the bias potential peaks and the ColVarBB block describes parameters of the bond-breaking collective variable.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">CVHD</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">CVHD</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Input for the Collective Variable-driven HyperDynamics (CVHD).</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Bias</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">The bias is built from a series of Gaussian peaks deposited on the collective variable axis every [Frequency] steps during MD. Each peak is characterized by its (possibly damped) height and the RMS width (standard deviation).</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">DampingTemp</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Kelvin</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Bias damping T</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">During well-tempered hyperdynamics the height of the added bias is scaled down with an exp(-E/kT) factor [PhysRevLett 100, 020603 (2008)], where E is the current value of the bias at the given CV value and T is the damping temperature DampingTemp. If DampingTemp is zero then no damping is applied.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Delta</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Standard deviation parameter of the Gaussian bias peak.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Height</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Hartree</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Height of the Gaussian bias peak.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ColVarBB</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Collective Variable</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Description of a bond-breaking collective variable (CV) as described in [Bal &amp; Neyts, JCTC, 11 (2015)]. A collective variable may consist of multiple ColVar blocks.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">at1</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Specifies the first bonded atom in the collective variable.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">region</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">*</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Restrict the selection of bonded atoms to a specific region. If this is not set, atoms anywhere in the system will be selected.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">symbol</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Atom type name of the first atom of the bond. The name must be as it appears in the System block. That is, if the atom name contains an extension (e.g C.1) then the full name including the extension must be used here.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">at2</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Specifies the second bonded atom in the collective variable.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">region</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">*</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Restrict the selection of bonded atoms to a specific region. If this is not set, atoms anywhere in the system will be selected.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">symbol</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Atom type name of the second atom of the bond. The value is allowed to be the same as [at1], in which case bonds between atoms of the same type will be included.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">cutoff</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.3</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Bond order cutoff</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Bond order cutoff. Bonds with BO below this value are ignored when creating the initial bond list for the CV. The bond list does not change during lifetime of the variable even if some bond orders drop below the cutoff.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">p</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">6</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Exponent p</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Exponent value p used to calculate the p-norm for this CV.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rmax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">R max</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Max bond distance parameter Rmax used for calculating the CV. It should be close to the transition-state distance for the corresponding bond.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rmin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">R min</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Min bond distance parameter Rmin used for calculating the CV. It should be close to equilibrium distance for the corresponding bond.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Frequency</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Frequency of adding a new bias peak, in steps. 
 New bias is deposited every [Frequency] steps after [StartStep] if the following conditions are satisfied: 
 the current CV value is less than 0.9 (to avoid creating barriers at the transition state), 
 the step number is greater than or equal to [StartStep], and 
 the step number is less than or equal to [StopStep].</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StartStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">If this key is specified, the first bias will be deposited at this step. Otherwise, the first bias peak is added at the step number equal to the Frequency parameter. The bias is never deposited at step 0.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StopStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">No bias will be deposited after the specified step. The already deposited bias will continue to be applied until the reaction event occurs. After that no new CVHD will be started. By default, the CVHD runs for the whole duration of the MD calculation.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">WaitSteps</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">If the CV value becomes equal to 1 and remains at this value for this many steps then the reaction event is considered having taken place. After this, the collective variable will be reset and the bias will be removed.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>During a CVHD calculation, the following variables are saved to the MDHistory section of the RKF file, in addition to other MD properties:</p>
<ul class="simple">
<li><em>BiasEnergy</em> - value the bias energy at the current MD step, in Hartree.</li>
<li><em>MaxBiasEnergy</em> - max BiasEnergy since the last sampling step.</li>
<li><em>BoostFactor</em> - the boost factor at the given MD step. The boost factor is calculated at each MD step as <span class="math notranslate nohighlight">\(boost = e^{E_{bias}/kT}\)</span>, where T is the MD ensemble temperature.</li>
<li><em>MaxBoostFactor</em> - max BoostFactor value since the last sampling step.</li>
<li><em>HyperTime</em> - boosted MD time, in femtoseconds, which is a sum of the hyper-time steps calculated from the current boost factor and the MD time step as <span class="math notranslate nohighlight">\(\Delta t_{boost} = boost * \Delta t\)</span>. In hyperdynamics, the hyper-time value is directly related to the rate of the process boosted by the corresponding collective variable.</li>
</ul>
</div>
<div class="section" id="temperature-replica-exchange">
<h3>Temperature Replica Exchange<a class="headerlink" href="#temperature-replica-exchange" title="Permalink to this headline">¶</a></h3>
<p>Sampling of rare events can be accelerated using the Replica Exchange Molecular Dynamics (REMD) method, also known as Parallel Tempering.
This method runs multiple replicas (copies) of the simulated system in parallel, each in a different ensemble.
In the case of Temperature REMD, these ensembles are all NVT or NpT, each at a different temperature.
Periodically, Monte Carlo swaps are attempted between neighboring ensembles.
If the current configuration of replica A has a sufficient Boltzmann probability in the ensemble of replica B (and vice versa), the two configurations will be swapped.
This causes high-energy configuration to migrate into the high-temperature replicas while low-energy configurations eventually end up in the coldest ensemble.
This facilitates the crossing of energy barriers in the high-temperature ensembles while keeping the coldest replica at a given temperature of interest.
Because each replica always samples an unbiased ensemble, any property can be calculated using standard MD analysis methods without special preparation.</p>
<p>The method is controlled using the ReplicaExchange block:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">ReplicaExchange</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">This block is used for (temperature) Replica Exchange MD (Parallel Tempering) simulations.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">AllowWrongResults</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Allow combining Replica Exchange with other features when the combination is known to produce physically incorrect results.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">EWMALength</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">10</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Length of the exponentially weighted moving average used to smooth swap probabilities for monitoring.

This value is equal to the inverse of the EWMA mixing factor.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SwapFrequency</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">100</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Attempt an exchange every N steps.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">TemperatureFactors</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">This is the ratio of the temperatures of two successive replicas. 

The first value sets the temperature of the second replica with respect to the first replica, the second value sets the temperature of the third replica with respect to the second one, and so on. If there are fewer values than nReplicas, the last value of TemperatureFactor is used for all the remaining replicas.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Temperatures</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">List of temperatures for all replicas except for the first one. 

This is mutually exclusive with TemperatureFactors. Exactly nReplicas-1 temperature values need to be specified, in increasing order. The temperature of the first replica is given by [Thermostat%Temperature].</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nReplicas</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Number of replicas</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Number of replicas to run in parallel.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>The number of replicas set by <code class="docutils literal notranslate"><span class="pre">nReplicas</span></code> must never exceed the total number of processors used for the simulation.
If possible, the total number of processors should be an integer multiple of <code class="docutils literal notranslate"><span class="pre">nReplicas</span></code> to ensure good load balancing.</p>
<p>The temperature of the base (coldest) replica is determined by the <code class="docutils literal notranslate"><span class="pre">Thermostat</span></code> input block, just like in an ordinary MD simulation.
There are two ways to set the temperatures of the remaining replicas, either using <code class="docutils literal notranslate"><span class="pre">Temperatures</span></code> or <code class="docutils literal notranslate"><span class="pre">TemperatureFactors</span></code>.
The latter is typically more convenient, as it makes it easy to set up the optimal geometric progression of temperatures.
In the simplest case, it is enough to supply just a single value in <code class="docutils literal notranslate"><span class="pre">TemperatureFactors</span></code>, setting the common ratio of temperatures of any two adjacent replicas.</p>
<p><code class="docutils literal notranslate"><span class="pre">SwapFrequency</span></code> should be set as low as practical for maximum efficiency.
The value of this parameter isn’t critical because it doesn’t affect the validity of the results.
However, setting it too high will decrease overall acceleration by missing some opportunities to exchange.
Conversely, using a value that is too low will increase the communication overhead and lead to useless back-and-forth swaps between adjacent replicas.
Ideally, <code class="docutils literal notranslate"><span class="pre">SwapFrequency</span></code> should be comparable to the correlation time of the system to ensure that individual exchange attempts are uncorrelated.</p>
<p>The trajectory of each replica is written to a separate RKF file: <em>ams.rkf</em> for the base replica and <em>replicaX.rkf</em> for the other replicas.
One can easily switch between these files in the GUI using <em>File → Related Files</em>.
In addition to data present in any MD trajectory, these files also contain an extra section <em>ReplicaExchangeHistory</em> with the following data items written every <code class="docutils literal notranslate"><span class="pre">SwapFrequency</span></code> steps:</p>
<ul class="simple">
<li><em>AvgSwapProbability</em> – Average swap acceptance for each pair of replicas, smoothed using an exponentially weighted moving average with a mixing factor equal to the inverse of <code class="docutils literal notranslate"><span class="pre">EWMALength</span></code>.</li>
<li><em>{Min,Max,Mean,StdDev}PotentialEnergy</em> – Statistics of the potential energy for each ensemble over the last <code class="docutils literal notranslate"><span class="pre">SwapFrequency</span></code> steps.</li>
<li><em>SystemInEnsemble i</em> – Identifies the system (continuous trajectory) currently running in ensemble (replica) <em>i</em>.</li>
<li><em>EnsembleOfSystem i</em> – Inverse mapping of <em>SystemInEnsemble</em>, giving the current replica number in which the system number <em>i</em> runs.</li>
<li><em>TemperatureOfSystem i</em> – Equivalent to <em>EnsembleOfSystem</em> using temperatures instead of integer numbers to identify ensembles.</li>
</ul>
<p>These data items can be plotted using the <code class="docutils literal notranslate"><span class="pre">MD</span> <span class="pre">Replica</span> <span class="pre">Exchange</span></code> menu in AMSmovie.
For example, plotting <em>TemperatureOfSystem</em> or <em>EnsembleOfSystem</em> is useful to visualize the migration of each system through the space of ensembles, where each curve represents one continuous trajectory.
Plotting potential energy statistics or average acceptances facilitates tuning the number of replicas and their temperatures to achieve efficient acceleration.
The replica exchange method can only work when the potential energy distributions of adjacent ensembles have a sufficient overlap.
This can be easily seen by comparing <em>MaxPotentialEnergy</em> of ensemble <em>i</em> with <em>MinPotentialEnergy</em> of ensemble <em>i+1</em>.
The optimal degree of overlap is such that leads to approximately 20 % of swap attempts getting accepted.
The acceptance of swaps can be monitored by plotting <em>AvgSwapProbability</em> and the corresponding <code class="docutils literal notranslate"><span class="pre">TemperatureFactors</span></code> can then be adjusted to keep it near the optimal value.</p>
<span class="target" id="mdbondboost"></span></div>
<div class="section" id="bond-boost-method">
<span id="index-17"></span><h3>Bond Boost Method<a class="headerlink" href="#bond-boost-method" title="Permalink to this headline">¶</a></h3>
<p>The bond boost method implemented here is described in <a class="footnote-reference" href="#ref3" id="id1">[3]</a>. In this method, the distances between atoms that are relevant to the reaction of interest are calculated to determine the orientation of the reactant molecules. If a suitable initial configuration is recognized, an additional restraint energy (possibly consisting of more than one term) is added to the system that is intended to stretch or compress bonds at a pre-defined rate such that this additional energy can help achieve the energy to cross the reaction barrier. A single term of the restraint energy is depends on the restraints type and its parameters, see <a class="reference internal" href="../Engines.html#restraints-addon"><span class="std std-ref">restraint definitions</span></a> for details. If more than one suitable configuration is found then the one with the smallest sum of distances is used to create the restraints.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference external" href="../../Tutorials/MolecularDynamicsAndMonteCarlo/PolymersBondBoost.html">GUI tutorial</a> on the Bond Boost Method.</p>
</div>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">BondBoost</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Forced reaction (bond boost) definitions. Multiple BondBoost blocks may be specified, which will be treated independently.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Chain</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Specifications of a chain of atoms. When a chain is detected the distance restraints will be activated. No other chain of this type will be detected while any restraints for this chain is active.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">AtomNames</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Atom names specifying the chain. An atom name can optionally be followed by ‘&#64;’ and a region name, in this case only atoms of this type from the given region will be matched. A leading ‘&#64;’ followed by a number indicates that this position in the chain must be occupied by the atom found earlier at the specified position in the chain. For example “O H N C &#64;1” indicates that the last atom in the chain of the five atoms must be the first oxygen, thus defining a 4-membered ring. This is the only way to define a ring because implicit rings will not be detected. For example, “O H N C O” does not include rings.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MaxDistances</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Maximum distances for each pair of atoms in the chain. The number of distances must be one less than the number of AtomNames.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MinDistances</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float List</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Minimum distances for each pair of atoms in the chain. The number of distances must be one less than the number of AtomNames.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">DistanceRestraint</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Specify two atom indices followed by the optimum distance in Angstrom, the the first parameter and, optionally, the profile type and the second parameter.

This restraint will try to keep the distance between the two specified atoms at the given value. For periodic systems this restraint follows the minimum image convention.

Each atom index indicates a position of the corresponding atom in the AtomNames key. Currently recognized restraint profile types: Harmonic (default), Hyperbolic, Erf, GaussianWell. The first parameter is the force constant for the Harmonic, Hyperbolic, and Erf profiles, or well depth for GaussianWell. The second parameter is the asymtotic force value at the infinity for Hyperbolic and Erf profiles, or the sigma parameter for GaussianWell.

Note: the Gaussian well restraint should be used with the Moving flag.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Moving</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Bool</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">No</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Move restraint</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Move the restraints created with this BondBoost. The restraint value will start at the currect coordinate’s value and will move towards the optimum during the restraint’s lifetime. The increment is calculated from the initial deviation and the [NSteps] parameter.

 This feature should be used with the GaussianWell restraint types.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">NSteps</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Boost lifetime</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Number of steps the restraints will remain active until removed. Atoms participating in one reaction are not available for the given number of steps.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">NumInstances</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Number of instances</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Number of reactions of this type taking place simultaneously.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Units</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Multiple Choice</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Default</td>
</tr>
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body">[Default, MD]</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Restr. parameter units</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Change energy, force and force constant units in the DistanceRestraint key from the default (atomic units) to those often used in the MD community (based on kcal/mol and Angstrom). Units for the optimum distances are not affected.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MolecularDynamics</span>
   <span class="n">BondBoost</span>
      <span class="n">NSteps</span> <span class="mi">10000</span>
      <span class="n">Chain</span>
         <span class="n">AtomNames</span>     <span class="n">N</span><span class="o">.</span><span class="mi">1</span>   <span class="n">C</span><span class="o">.</span><span class="n">t</span>    <span class="n">O</span>     <span class="n">H</span>     <span class="nd">@1</span>
         <span class="n">MinDistances</span>     <span class="mf">3.0</span>   <span class="mf">1.2</span>   <span class="mf">1.5</span>   <span class="mf">0.8</span>
         <span class="n">MaxDistances</span>     <span class="mf">3.8</span>   <span class="mf">3.0</span>   <span class="mf">2.5</span>   <span class="mf">1.5</span>
      <span class="n">End</span>
<span class="c1">#     Restraints         i  j   R_0    FC</span>
      <span class="n">DistanceRestraint</span>  <span class="mi">1</span>  <span class="mi">2</span>   <span class="mf">1.5</span>   <span class="mf">0.05</span>   <span class="n">Hyperbolic</span>   <span class="mf">0.7</span>
      <span class="n">DistanceRestraint</span>  <span class="mi">2</span>  <span class="mi">3</span>   <span class="mf">3.5</span>   <span class="mf">0.03</span>   <span class="n">Hyperbolic</span>   <span class="mf">0.5</span>
      <span class="n">DistanceRestraint</span>  <span class="mi">3</span>  <span class="mi">4</span>   <span class="mf">1.0</span>   <span class="mf">0.03</span>   <span class="n">Hyperbolic</span>   <span class="mf">0.5</span>
   <span class="n">End</span>
<span class="n">End</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">AtomNames</span></code>, <code class="docutils literal notranslate"><span class="pre">MinDistances</span></code>, and <code class="docutils literal notranslate"><span class="pre">MaxDistances</span></code> keys constitute the atom chain definitions for the initial configuration. Thus, the example above defines a chain of atoms N.1-C.t-O-H-N.1 with R(N.1-C) in the (3.0,3.8) range, R(C.t-O) in the (1.2,3.0) range, etc.. In this example, the last atoms in the chain is required to be the same as the fist one, thus defining a ring. The specified restraints will push pairs of atoms C-N and O-H close together, which will hopefully let them form a bond, and pull atoms C.t and O away from each other, thus breaking the C-O bond. The restraint type is set to <code class="docutils literal notranslate"><span class="pre">Hyperbolic</span></code> to avoid very large forces that would otherwise result from a harmonic potential at a large deviation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When detecting coordinates, the program uses the full atom name and not just the element name. An atom name consists of the element name optionally followed by a period and a suffix, just like <code class="docutils literal notranslate"><span class="pre">N.1</span></code> and <code class="docutils literal notranslate"><span class="pre">C.t</span></code> in the example above. Using extended names for some atoms one may allow only a subset of bonds to be boosted.</p>
</div>
<span class="target" id="fbmc"></span><span class="target" id="index-18"></span></div>
<div class="section" id="force-bias-monte-carlo-fbmc">
<span id="index-19"></span><h3>Force bias Monte Carlo (fbMC)<a class="headerlink" href="#force-bias-monte-carlo-fbmc" title="Permalink to this headline">¶</a></h3>
<p>Configurational sampling and structural relaxation can be accelerated by the Force bias Monte Carlo method.
Unlike molecular dynamics, this approach does not use the equations of motion or atomic velocities.
Instead, all atoms are randomly displaced in each fbMC steps.
AMS uses an uniform-acceptance force bias Monte Carlo flavour of fbMC called tfMC, as published by Mees et al. <a class="footnote-reference" href="#ref4" id="id2">[4]</a>
Unlike other well-known Monte Carlo methods such as the Metropolis algorithm, fbMC does not generate completely random moves and then test whether these should be accepted or rejected.
Instead, the atomic displacements are generated so that atoms preferably move in the direction of the forces acting on them.
This special biasing enables fbMC to accept every move, sampling the correct canonical ensemble with high efficiency.</p>
<p>In AMS the fbMC method is implemented as an add-on to molecular dynamics, enabling mixed MC-MD simulations.
After every <code class="docutils literal notranslate"><span class="pre">Frequency</span></code> MD steps, the MD procedure is stopped and fbMC takes over, executing <code class="docutils literal notranslate"><span class="pre">NSteps</span></code> Monte Carlo steps.
Once the fbMC procedure completes, the MD simulation continues from the new geometry generated by fbMC while reusing atomic velocities from before the start of fbMC.</p>
<p>The fbMC module requires three main input settings.
Apart from the <code class="docutils literal notranslate"><span class="pre">NSteps</span></code> and <code class="docutils literal notranslate"><span class="pre">Frequency</span></code> defining the mix of molecular dynamics and Monte Carlo, <code class="docutils literal notranslate"><span class="pre">Temperature</span></code> needs to be set as desired to sample a particular canonical (NVT) ensemble.
Although the fbMC procedure always runs in constant temperature mode, the rest of the MD simulation can in principle use any ensemble (with or without a thermostat or barostat).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To run a pure fbMC simulation with no molecular dynamics component, leave <code class="docutils literal notranslate"><span class="pre">Frequency</span></code> set to 1 (the default), set the MD <code class="docutils literal notranslate"><span class="pre">TimeStep</span></code> and <code class="docutils literal notranslate"><span class="pre">InitialVelocities</span></code> to zero, and do not use other MD features such as a thermostat or a barostat.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">AMS currently cannot write sampled geometries to the trajectory during the fbMC procedure. To see the evolution of the system during a long fbMC run, split it into multiple shorter fbMC passes to let the MD driver sample the current state between them. To do this, set the <code class="docutils literal notranslate"><span class="pre">NSteps</span></code> for fbMC to the desired trajectory sampling interval, keep <code class="docutils literal notranslate"><span class="pre">Frequency</span></code> set to 1 and set <code class="docutils literal notranslate"><span class="pre">Trajectory</span> <span class="pre">SamplingFreq</span></code> to 1.</p>
</div>
<p>The amount of acceleration provided by fbMC depends on the <code class="docutils literal notranslate"><span class="pre">StepLength</span></code> parameter, which defines the maximum displacement of the lightest atom in the system.
The default value of 0.1 Å is relatively conservative.
Increasing <code class="docutils literal notranslate"><span class="pre">StepLength</span></code> leads to faster evolution of the system, but setting it too high can lead to inaccurate sampling or cause crashes by generating geometries that are too distorted.</p>
<p>An estimate of the timescale associated with fbMC (tfMC) steps will be printed to the output.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">fbMC</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">fbMC</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">This block sets up force bias Monte Carlo interleaved with the molecular dynamics simulation.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Frequency</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Run the fbMC procedure every Frequency MD steps.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">MassRoot</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">2.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Inverse of the exponent used to mass-weight fbMC steps.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">NSteps</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Number of steps</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Number of fbMC steps to perform on every invocation of the procedure.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">PrintFreq</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Printing frequency</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Print current thermodynamic properties to the output every N fbMC steps. This defaults to the PrintFreq set in the Trajectory block. Setting this to zero disables printing fbMC steps.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StartStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">First step at which the fbMC procedure may run.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StepLength</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.1</td>
</tr>
<tr class="field-odd field"><th class="field-name">Unit:</th><td class="field-body">Angstrom</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Maximum allowed displacement of the lightest atom in the system in each Cartesian coordinate in one fbMC step.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StopStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Last step at which the fbMC procedure may run. If unset or zero, there is no limit.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Temperature</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Kelvin</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Temperature used for fbMC.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div>
</div>
<div class="section" id="non-equilibrium-md-nemd">
<span id="index-20"></span><h2>Non-equilibrium MD (NEMD)<a class="headerlink" href="#non-equilibrium-md-nemd" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-21"></span><span class="target" id="index-22"></span><span class="target" id="index-23"></span><div class="section" id="t-nemd-for-thermoconductivity-heat-exchange">
<span id="index-24"></span><h3>T-NEMD for thermoconductivity: heat exchange<a class="headerlink" href="#t-nemd-for-thermoconductivity-heat-exchange" title="Permalink to this headline">¶</a></h3>
<p>There are different methods to study thermal conductivity using non-equilibrium molecular dynamics (NEMD). A common feature of these methods is that they require the system to be divided into three or more zones, each with its own thermostat and other properties. One method maintains the temperature of the heat source and the heat sink zones at the given temperature using two different thermostats and measures the amount of heat transferred. These method does not require any special features besides a standard thermostat and a possibility to calculate the amount of heat accumulated by the thermostat per unit of time. The accumulated thermostat energies are available in the MDHistory section of ams.rkf file, in variables called ‘XXXXstat#Energy’, where XXXX is a 4-letter abbreviation of the thermo-/barostat (‘BerT’ for a Berendset thermostat, ‘NHCT’ for an NHC thermostat, ‘NHTB’ for an MTK barostat, etc.) and ‘#’ is a 1-digit index of the thermo-/barostat.</p>
<p>In the other method, the heat flow is constant and the induced temperature gradient is measured. This method is implemented in AMS in three variants: a simple heat exchange, HEX <a class="footnote-reference" href="#ref1" id="id3">[1]</a> and eHEX <a class="footnote-reference" href="#ref2" id="id4">[2]</a>. In the simple heat exchange method the atom velocities are scaled up (or down) by a factor corresponding to the amount of heat deposited to the heat source (or withdrawn from the heat sink) without paying attention to the conservation of the total momentum of the heat source (or sink). In the HEX method the velocities are scaled in such a way that the total momentum is conserved. This, however, introduces a small but measurable drift in the total energy. The eHEX algorithm improves upon the HEX by adding a third-order time-integration correction to remove the drift.</p>
<p>This method is controlled by the HeatExchange sub-block of the MolecularDynamics block:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">MolecularDynamics</span></code></dt>
<dd><dl class="first last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">HeatExchange</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Recurring:</th><td class="field-body">True</td>
</tr>
<tr class="field-odd field"><th class="field-name">GUI name:</th><td class="field-body">Heat exchange</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Input for the heat-exchange non-equilibrium MD (T-NEMD).</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">HeatingRate</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Unit:</th><td class="field-body">Hartree/fs</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Rate at which the energy is added to the Source and removed from the Sink. A heating rate of 1 Hartree/fs equals to about 0.00436 Watt of power being transferred through the system.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Method</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Multiple Choice</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">Simple</td>
</tr>
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body">[Simple, HEX, eHEX]</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Heat exchange method used.

 Simple: kinetic energy of the atoms of the source and sink regions is modified irrespective of that of the center of mass (CoM) of the region (recommended for solids). 

 HEX: kinetic energy of the atoms of these regions is modified keeping that of the corresponding CoM constant. 

 eHEX: an enhanced version of HEX that conserves the total energy better (recommended for gases and liquids).</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Sink</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Defines the heat sink region (where the heat will be removed).</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">AtomList</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer List</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Sink region</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">The atoms that are part of the sink.

This key is ignored if the [Box] block or [Region] key is present.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Box</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Part of the simulation box (in fractional cell coordinates) defining the heat sink. If this block is specified, then by default, the whole box in each of the three dimensions is used, which usually does not make much sense. Normally, you will want to set the bounds along one of the axes.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Amax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the first axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Amin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the first axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Bmax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the second axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Bmin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the second axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Cmax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the third axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Cmin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the third axis.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Region</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Sink region</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">The region that is the sink.

This key is ignored if the [Box] block is present.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Source</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Defines the heat source region (where the heat will be added).</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">AtomList</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer List</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Source region</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">The atoms that are part of the source.

This key is ignored if the [Box] block or [Region] key is present.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Box</span></code></dt>
<dd><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Block</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Part of the simulation box (in fractional cell coordinates) defining the heat source. If this block is specified, then by default, the whole box in each of the three dimensions is used, which usually does not make much sense. Normally, you will want to set the bounds along one of the axes. This block is mutually exclusive with the FirstAtom/LastAtom setting.</td>
</tr>
</tbody>
</table>
<dl class="last docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Amax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the first axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Amin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the first axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Bmax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the second axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Bmin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the second axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Cmax</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">1.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the upper bound along the third axis.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Cmin</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Float</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0.0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Coordinate of the lower bound along the third axis.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Region</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">String</td>
</tr>
<tr class="field-even field"><th class="field-name">GUI name:</th><td class="field-body">Source region</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">The region that is the source.

This key is ignored if the [Box] block is present.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StartStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Default value:</th><td class="field-body">0</td>
</tr>
<tr class="field-odd field"><th class="field-name">Description:</th><td class="field-body">Index of the MD step at which the heat exchange will start.</td>
</tr>
</tbody>
</table>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StopStep</span></code></dt>
<dd><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">Integer</td>
</tr>
<tr class="field-even field"><th class="field-name">Description:</th><td class="field-body">Index of the MD step at which the heat exchange will stop.</td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>One should be careful when choosing a value for the HeatingRate because a too large value may lead to pyrolysis of the heat source or to an abnormal termination when all the kinetic energy of the heat sink has been drained. The optimal value depends on the size of the system, its heat conductivity and the desired temperature gradient value. The thermal conductivity <em>k</em> can be calculated by dividing the heat flow rate <em>W</em> by the temperature gradient <em>grad(T)</em> and by the flow cross-section area <em>S</em>: <span class="math notranslate nohighlight">\(k = W/(S \cdot grad(T))\)</span>. See the <a class="reference internal" href="#trajectory-sampling"><span class="std std-ref">trajectory sampling</span></a> section above on how to obtain the temperature profile from which the <em>grad(T)</em> can be computed.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="ref1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>T. Ikeshoji and B. Hafskjold, <em>Non-equilibrium molecular dynamics calculation of heat conduction in liquid and through liquid-gas interface</em> <a class="reference external" href="https://doi.org/10.1080/00268979400100171">Molecular Physics 81, 251-261 (1994)</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="ref2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>P. Wirnsberger, D. Frenkel, and C. Dellago, <em>An enhanced version of the heat exchange algorithm with excellent energy conservation properties</em> <a class="reference external" href="http://dx.doi.org/10.1063/1.4931597">Journal of Chemical Physics 143, 124104 (2015)</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="ref3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[3]</a></td><td>A. Vashisth, C. Ashraf, W. Zhang, C.E. Bakis, and A.C.T. van Duin, <em>Accelerated ReaxFF simulations for describing the reactive cross-linking of polymers</em>, <a class="reference external" href="https://doi.org/10.1021/acs.jpca.8b03826">J. Phys. Chem.  A, 122, 6633-6642 (2018)</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="ref4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[4]</a></td><td>M.J. Mees, G. Pourtois, E. C. Neyts, B. J. Thijsse, and André Stesmans, <em>Uniform-acceptance force-bias Monte Carlo method with time scale to study solid-state diffusion</em>, <a class="reference external" href="https://doi.org/10.1103/PhysRevB.85.134301">Phys. Rev. B 85, 134301 (2012)</a></td></tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
          </div>
          <!--STARTNOSOLR-->
<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="TrajectoryReplay.html" class="btn btn-neutral float-right" title="Trajectory replay" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Excited_State_Optimizations.html" class="btn btn-neutral" title="Excited state optimizations" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/> 

<!-- start :: footer -->
		<footer class="site-footer block">
			<div class="container">
				<div class="row">
					<div class="footer-column" >
	<ul>
		<li id="nav_menu-2" class="widget widget_nav_menu "><h3>Application Areas</h3><div class="menu-application-areas-container"><ul id="menu-application-areas" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/batteries/">Batteries &#038; PVs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/chemical-bonding-analysis/">Bonding Analysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/catalysis/">Catalysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/heavy-elements/">Heavy Elements</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/inorganic-chemistry/">Inorganic Chemistry</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/pharma/">Life Sciences</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/materials-science/">Materials Science</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/nanotechnology/">Nanotechnology</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/oil-and-gas/">Oil and Gas</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/organic-electronics/">Organic Electronics</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/polymers/">Polymers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/spectroscopy/">Spectroscopy</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/teaching/">Teaching</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-7" class="widget widget_nav_menu "><h3>Products</h3><div class="menu-product-navigation-container"><ul id="menu-product-navigation" class="menu">
<li id="menu-item-40263" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40263"><a href="https://www.scm.com/product/ams/">AMS Driver</a></li>
<li id="menu-item-7235" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7235"><a href="https://www.scm.com/product/adf/">ADF</a></li>
<li id="menu-item-7236" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7236"><a href="https://www.scm.com/product/band_periodicdft/">BAND</a></li>
<li id="menu-item-7237" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7237"><a href="https://www.scm.com/product/cosmo-rs/">COSMO-RS</a></li>
<li id="menu-item-7238" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7238"><a href="https://www.scm.com/product/dftb/">DFTB</a></li>
<li id="menu-item-7239" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7239"><a href="https://www.scm.com/product/gui/">GUI</a></li>
<li id="menu-item-44383" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-44383"><a href="https://www.scm.com/product/machine-learning-potentials/">MLPotential</a></li>
<li id="menu-item-7240" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7240"><a href="https://www.scm.com/product/mopac/">MOPAC</a></li>
<li id="menu-item-40262" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40262"><a href="https://www.scm.com/product/plams/">PLAMS</a></li>
<li id="menu-item-43701" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-43701"><a href="https://www.scm.com/product/quantum-espresso/">Quantum ESPRESSO</a></li>
<li id="menu-item-7241" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7241"><a href="https://www.scm.com/product/reaxff/">ReaxFF</a></li></ul></div></li><li id="nav_menu-26" class="widget widget_nav_menu "><div class="menu-licensing-container"><ul id="menu-licensing" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/">Pricing &#038; Licensing</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/">Price Quote</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/calculate-your-price/">Price Calculator</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/consulting/">Scientific Consulting</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/adf-resellers/">Resellers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/scm-license-terms/">License Terms</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/ordering-procedure/">Ordering</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-6" class="widget widget_nav_menu "><h3>Support</h3><div class="menu-support-navigation-container"><ul id="menu-support-navigation" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/">Support Overview</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-installation-videos/">Installation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-tutorials-and-manuals/">Documentation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/doc/Tutorials/GUI_overview/GUI_overview_tutorials.html">GUI Tutorials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/downloads/">Downloads</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/faq/">FAQs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/adf-discussion-list/">Discussion List</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/documentation-previous-versions/release-notes/">Release Notes</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/adf-teaching-materials/">Teaching Materials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/adf-hands-on-workshops/">Workshops</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/web-presentations-by-adf-experts/">Webinars</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/videos-tutorials-and-web-presentations/">Videos</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/brochures/">Brochure</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/amsterdam-modeling-suite/research-papers-citing-adf/">Papers Citing ADF</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/highlights/">Literature Highlights</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-28" class="widget widget_nav_menu "><h3>About Us</h3><div class="menu-about-us-container"><ul id="menu-about-us" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/contact-us/">Contact Us</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/eu-projects/">EU Projects</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-authors/">Contributors</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-people/">The SCM Team</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/collaborations/">Collaborations</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/careers/">Careers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/mission-vision/">Mission &#038; Vision</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/newsletters/">Newsletters</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/news/">News</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/">Events</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
			</ul>
</div>				</div>
			</div>
		</footer>
		<footer class="disclaimer-footer">
			<img src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="">
			<nav class="menu-service-navigation-container"><ul id="menu-service-navigation" class="menu-service navbar-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-73"><a href="https://www.scm.com/copyright/">Copyright</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72"><a href="https://www.scm.com/terms-of-use/">Terms of Use</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-71"><a href="https://www.scm.com/privacy-policy/">Privacy Policy</a></li>
</ul></nav></footer>	
		<!-- end :: footer -->

<!--ENDNOSOLR-->
        </div>
      </div>

    </section>
  </div>
  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2021.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCRWHZZ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/../../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>