

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
<META name="ROBOTS" content="NOINDEX, NOFOLLOW">
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multi-level energy expression &mdash; Quild 2021.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/theme_tabs.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/panels-bootstrap.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Quild 2021.1 documentation" href="index.html"/>
        <link rel="next" title="AddRemove method for capping atoms" href="AddRemove_method_for_capping_atoms.html"/>
        <link rel="prev" title="Basic philosophy" href="Basic_philosophy.html"/> 

  
  <script src="_static/js/jquery.min.js"></script>
  <script src="_static/js/bootstrap.min.js"></script>
  <script src="_static/js/modernizr.min.js"></script>
  <script src="_static/js/app.js"></script>
<script type="text/javascript">
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NCRWHZZ');</script>
<!-- End Google Tag Manager -->

</head>

<body class="wy-body-for-nav" role="document">
  <!--STARTNOSOLR-->
  <header class="site-header navbar-fixed-top compact">
      <nav class="main navbar navbar-default">
        <div class="headerbar_container">
          <a role="button" href="/free-trial/" class="btn btn-sm btn-primary">Free trial</a>
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div class="navbar-brand">
              <a class="logo" href="https://www.scm.com">
                <img class="logo-small" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="Software for Chemistry &amp; Materials" />
                <img class="logo-full" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo.svg" alt="Software for Chemistry &amp; Materials" />
              </a>
            </div>
          </div>
          <div class="nav-wrapper">
            <div class="collapse navbar-collapse">
              <ul id="menu-primary-navigation" class="nav navbar-nav"><li id="menu-item-40077" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-40077"><a title="Applications" href="https://www.scm.com/applications/">Applications</a></li>
<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a title="Products" href="https://www.scm.com/amsterdam-modeling-suite/">Products</a></li>
<li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36"><a title="Support" href="https://www.scm.com/support/">Support</a></li>
<li id="menu-item-37" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37"><a title="About us" href="https://www.scm.com/about-us/">About us</a></li>
</ul>                           <span class="search"><a class="menu_search_link" href="https://www.scm.com/search.php"></a><span class="sr-only">Search</span></span>
            </div>
          </div>
        </div>
      </nav>
 </header>
    

   
  <div id="doc-wrapper">
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          

          
          </a>

          
          
  <ul>
      <li class="wy-breadcrumbs-aside">
        
           
           
        
      </li>
  </ul>
 
<!--ENDNOSOLR-->
             <!--STARTNOSOLR-->
<div role="search">
  <form id="rtd-search-form" class="wy-form search-docs-form" action="https://www.scm.com/search.php" method="get">
  <div class="input-group">
    <input type="text" name="search" placeholder="Search Quild" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <input type="hidden" name="root" value="doctrunk" />


    <input type="hidden" name="cat" value="doc-Quild" />


    <span class="input-group-btn">
			<button type="submit" class="btn btn-primary"><span class="sr-only">Search</span><span class="fa fa-search"></span></button>
		</span>
	</div>
  </form>
</div>
<!--ENDNOSOLR-->
          

          
        </div>
<!--STARTNOSOLR-->
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="QUILD.html">QUantum-regions Interconnected by Local Descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Whats_new.html">What’s new in the 2018 version</a></li>
<li class="toctree-l1"><a class="reference internal" href="Whats_new.html#what-s-new-in-the-2017-version">What’s new in the 2017 version</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#anti-ferromagnetic-coupling">Anti-ferromagnetic coupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#upscaling-low-frequencies-in-gibbs-free-energy">Upscaling low frequencies in Gibbs free energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#bug-fix">Bug fix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Whats_new.html#what-s-new-in-the-2009-01-version">What’s new in the 2009.01 version</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#gui-support">GUI-support</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#symmetry-within-quild">Symmetry within QUILD</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#more-qm-programs">More QM programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#frequency-calculations-for-qm-mm-and-multi-level-qm-qm-and-qm-mm-schemes">Frequency calculations for QM, MM and multi-level QM/QM and QM/MM schemes</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#spin-contamination-correction-per-region">Spin-contamination correction per region</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#improved-transitionstate-ts-search">Improved TransitionState (TS) search</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#simplified-and-more-detailed-output">Simplified and more detailed output</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#improved-generation-of-primitive-coordinates">Improved generation of primitive coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#frozen-coordinates-versus-constraints">Frozen coordinates versus constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="Whats_new.html#numerical-gradients-per-region">Numerical gradients per region</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Basic_philosophy.html">Basic philosophy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Multi-level energy expression</a></li>
<li class="toctree-l1"><a class="reference internal" href="AddRemove_method_for_capping_atoms.html">AddRemove method for capping atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="Improved_geometry_optimization.html">Improved geometry optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Special_cases.html">Special cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="How_to_call_the_program.html">How to call the program</a></li>
<li class="toctree-l1"><a class="reference internal" href="Input_description.html">Input description</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#relevant-keywords-in-quild-block">Relevant Keywords in QUILD block</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#constr-subblock-in-quild-block">CONSTR subblock in QUILD block</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#frozen-subblock-in-quild-block">FROZEN subblock in QUILD block</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#symrot-subblock-in-quild-block">SYMROT subblock in QUILD block</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#tsrc-subblock-in-quild-block">TSRC subblock in QUILD block</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#region-subblocks-in-quild-block">REGION subblocks in QUILD block</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#addremove-subblock-in-quild-block">ADDREMOVE subblock in QUILD block</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#description-subblocks-in-quild-block">DESCRIPTION subblocks in QUILD block</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#numerical-versus-analytical-hessians-for-multi-level-vibrational-frequencies">Numerical versus analytical Hessians for multi-level vibrational frequencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#use-of-a-generic-description-for-use-with-user-provided-qm-program">Use of a GENERIC description for use with user-provided QM-program</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#spin-contamination-correction-per-region">Spin-contamination correction per region</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#interactions-subblock-in-quild-block">INTERACTIONS subblock in QUILD block</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_description.html#inline-options-in-the-quild-block">INLINE options in the QUILD block</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Example_inputfiles.html">Example inputfiles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Example_inputfiles.html#vibrational-frequencies-for-multi-level-qm-qm-scheme">Vibrational frequencies for multi-level QM/QM scheme</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_inputfiles.html#symmetry-rotation-with-td-symmetry-for-geometry-and-c2v-for-orbitals">Symmetry rotation with T<sub>d</sub>  symmetry for geometry and C<sub>2v</sub>  for orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_inputfiles.html#optimization-with-b3lyp-through-the-post-scf-metagga-scheme">Optimization with B3LYP through the post-SCF METAGGA scheme</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_inputfiles.html#optimization-with-b3lyp-as-scf-functional">Optimization with B3LYP as SCF functional</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_inputfiles.html#geometry-optimization-with-qm-mm-treatment-of-water-dimer">Geometry optimization with QM/MM treatment of water dimer</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_inputfiles.html#lineartransit-run-for-bimolecular-nucleophilic-reaction-of-f-and-ch3-cl">LinearTransit run for bimolecular nucleophilic reaction of F<sup>-</sup>  and CH<sub>3</sub> Cl</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_inputfiles.html#geometry-optimization-of-pure-spin-state-for-spin-contaminated-system">Geometry optimization of pure spin state for spin-contaminated system</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_inputfiles.html#lineartransit-run-for-water-dimer">LinearTransit run for water dimer</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example_inputfiles.html#interface-to-the-ams-driver">Interface to the AMS driver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Required_citations.html">Required Citations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Required_citations.html#external-programs-and-libraries">External programs and Libraries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="References.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Quild</a>
      </nav>
<!--ENDNOSOLR-->

      
      <div class="wy-nav-content">
        <div class="rst-content">
        <!--STARTNOSOLR-->
<div class="header" role="navigation" aria-label="breadcrumbs navigation">
 
  <ul class="wy-breadcrumbs">
    <li><a href="Quild.html/../../Documentation/index.html">Documentation</a>/</li>
    <li><a href="index.html">Quild</a>/</li>
      
    <li class="orange-text">Multi-level energy expression</li>
  </ul>
  <p>
 
</div>
<!--ENDNOSOLR-->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multi-level-energy-expression">
<h1>Multi-level energy expression<a class="headerlink" href="#multi-level-energy-expression" title="Permalink to this headline">¶</a></h1>
<p>Similar to the ONIOM approach [<a class="reference internal" href="References.html#reference-38"><span class="std std-ref">38-39</span></a>]  the total energy within the multi-level approach is obtained by combining the different energies, for instance, for the interactions in a protein depicted schematically below, with the active site (region 1, in yellow), the rest of the protein (region 2, in pink) and solvent (region 3, in blue).</p>
<img alt="_images/image005.png" src="_images/image005.png" />
<p>Suppose we want to treat the active site using a GGA functional in a large basis set, the rest of the protein by LDA in a small basis, and the solvent at MM level. The energy expression is then obtained by a sequence of 5 jobs:</p>
<p>E = E<sub>MM</sub>  (1,2,3) + E<sub>LDA</sub>  (1,2) - E<sub>MM</sub>  (1,2) + E<sub>GGA</sub>  (1) - E<sub>LDA</sub>  (1)</p>
<p>First, the total system is described at the MM level (top-right), then the MM description for regions 1 and 2 is replaced by LDA (middle-right), and finally the LDA description for region 1 is replaced by the GGA description (bottom-right). This splitting up of the total system into different jobs is fully automated, the user only has to assign the different regions and give descriptions for the QM and MM methods to be used.</p>
<img alt="_images/image010.png" src="_images/image010.png" />
<p>A second example of using a multi-level approach is posed by the application to DNA. In this case we do not want to replace all interactions within one region, but merely the <em>interaction</em> between two different regions. This is again achieved by a sequence of jobs, as indicated in the figure above on the right hand side. First, we have a BP86 job for the whole system (top, in blue). Second, we add the LDA interaction energy for the left-side stacked basepair in a series of three jobs (middle, in yellow) and remove the corresponding BP86 interaction energy (middle, in blue). Third, we add the LDA interaction energy (bottom, in pink) and remove the corresponding BP86 interaction energy (bottom, in blue) for the right-side stacked basepair.</p>
<p>The corresponding input for the second example would be schematically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QUILD</span>
  <span class="n">NR_REGIONS</span> <span class="mi">5</span>

  <span class="n">REGION</span> <span class="mi">1</span>
    <span class="mi">17</span><span class="o">-</span><span class="mi">30</span>
  <span class="n">SUBEND</span>
  <span class="n">REGION</span> <span class="mi">2</span>
    <span class="mi">77</span><span class="o">-</span><span class="mi">91</span>
  <span class="n">SUBEND</span>
  <span class="n">REGION</span> <span class="mi">3</span>
    <span class="mi">47</span><span class="o">-</span><span class="mi">60</span>
  <span class="n">SUBEND</span>
  <span class="n">REGION</span> <span class="mi">4</span>
    <span class="mi">111</span><span class="o">-</span><span class="mi">122</span>
  <span class="n">SUBEND</span>
  <span class="n">REGION</span> <span class="mi">5</span>
    <span class="mi">1</span><span class="o">-</span><span class="mi">16</span> <span class="mi">31</span><span class="o">-</span><span class="mi">46</span> <span class="mi">61</span><span class="o">-</span><span class="mi">76</span> <span class="mi">92</span><span class="o">-</span><span class="mi">110</span> <span class="mi">123</span><span class="o">-</span><span class="mi">125</span>
  <span class="n">SUBEND</span>

  <span class="n">DESCRIPTION</span> <span class="mi">1</span>
    <span class="n">CHARGE</span> <span class="o">-</span><span class="mi">2</span>
    <span class="n">XC</span>
      <span class="n">GGA</span> <span class="n">Becke</span><span class="o">-</span><span class="n">Perdew</span>
    <span class="n">END</span>
    <span class="n">BASIS</span>
      <span class="nb">type</span> <span class="n">TZ2P</span>
      <span class="n">core</span> <span class="n">SMALL</span>
    <span class="n">END</span>
  <span class="n">SUBEND</span>
  <span class="n">DESCRIPTION</span> <span class="mi">2</span>
    <span class="n">XC</span>
      <span class="n">GGA</span> <span class="n">Becke</span><span class="o">-</span><span class="n">Perdew</span>
    <span class="n">END</span>
    <span class="n">BASIS</span>
      <span class="nb">type</span> <span class="n">TZ2P</span>
      <span class="n">core</span> <span class="n">SMALL</span>
    <span class="n">END</span>
  <span class="n">SUBEND</span>
  <span class="n">DESCRIPTION</span> <span class="mi">3</span>
    <span class="n">BASIS</span>
      <span class="nb">type</span> <span class="n">TZ2P</span>
      <span class="n">core</span> <span class="n">SMALL</span>
    <span class="n">END</span>
  <span class="n">SUBEND</span>

  <span class="n">INTERACTIONS</span>
    <span class="n">TOTAL</span>     <span class="n">description</span> <span class="mi">1</span>
    <span class="n">INTXN</span> <span class="n">region</span> <span class="mi">1</span> <span class="n">region</span> <span class="mi">2</span>       <span class="n">description</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">description</span> <span class="mi">2</span>
    <span class="n">INTXN</span> <span class="n">region</span> <span class="mi">3</span> <span class="n">region</span> <span class="mi">4</span>       <span class="n">description</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">description</span> <span class="mi">2</span>
  <span class="n">SUBEND</span>

<span class="n">END</span>
</pre></div>
</div>
<p>Next, we provide a line-by-line explanation of the above input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QUILD</span>
</pre></div>
</div>
<p>All input relevant for performing the QUILD job must be specified within a QUILD block. QUILD takes care of the remaining input that is needed in runs of ADF or other programs that are invoked (in a “black-box” manner) by QUILD. Exceptions are, for example, GEOMETRY, GEOVAR, etc., which are specified according to the ADF input syntax. Thus, detailed input parameters for the various programs that QUILD communicates with can be passed through to these programs via the QUILD input block (within DESCRIPTION subblocks, see below). Therefore, any option that is available in ADF (ZORA, COSMO, LDA, GGA, MGGA, HYBRIDS) or in the other programs (NEWMM, ORCA, DFTB, MOPAC, GENERIC) is also available in QUILD.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NR_REGIONS</span> <span class="mi">5</span>
</pre></div>
</div>
<p>The number of regions is set to five. The definition of the atoms that belong to each region is given in the REGION subblocks below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">REGION</span> <span class="mi">1</span>
  <span class="mi">17</span><span class="o">-</span><span class="mi">30</span>
<span class="n">SUBEND</span>
<span class="n">REGION</span> <span class="mi">2</span>
  <span class="mi">77</span><span class="o">-</span><span class="mi">91</span>
<span class="n">SUBEND</span>
<span class="n">REGION</span> <span class="mi">3</span>
  <span class="mi">47</span><span class="o">-</span><span class="mi">60</span>
<span class="n">SUBEND</span>
<span class="n">REGION</span> <span class="mi">4</span>
  <span class="mi">111</span><span class="o">-</span><span class="mi">122</span>
<span class="n">SUBEND</span>
<span class="n">REGION</span> <span class="mi">5</span>
  <span class="mi">1</span><span class="o">-</span><span class="mi">16</span> <span class="mi">31</span><span class="o">-</span><span class="mi">46</span> <span class="mi">61</span><span class="o">-</span><span class="mi">76</span> <span class="mi">92</span><span class="o">-</span><span class="mi">110</span> <span class="mi">123</span><span class="o">-</span><span class="mi">125</span>
<span class="n">SUBEND</span>
</pre></div>
</div>
<p>In the above example, atoms 17 to 30 make up region 1 (an equivalent input would be to specify each atom number individually, i.e.: “17 18 19 20 21 22 23 24 25 26 27 28 29 30”), atoms 77 to 91 region 2, atoms 47 to 60 region 3, atoms 111 to 122 region 4, and the remaining atoms region 5. <em>It is not necessary to define all regions explicitly: the first job (with the description as defined by the</em> TOTAL <em>line in the</em> INTERACTIONS* subblock) includes all atoms automatically. Only those regions which are explicitly used within the*INTERACTIONS* subblock need to be defined, i.e. in this case the definition of region 5 is not actually used.* Note that the atom numbers are obtained by counting consecutively the atoms in the ATOMS block on input.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DESCRIPTION</span> <span class="mi">1</span>
  <span class="n">CHARGE</span> <span class="o">-</span><span class="mi">2</span>
  <span class="n">XC</span>
    <span class="n">GGA</span> <span class="n">Becke</span><span class="o">-</span><span class="n">Perdew</span>
  <span class="n">END</span>
  <span class="n">BASIS</span>
    <span class="nb">type</span> <span class="n">TZ2P</span>
    <span class="n">core</span> <span class="n">SMALL</span>
  <span class="n">END</span>
<span class="n">SUBEND</span>
<span class="n">DESCRIPTION</span> <span class="mi">2</span>
  <span class="n">XC</span>
    <span class="n">GGA</span> <span class="n">Becke</span><span class="o">-</span><span class="n">Perdew</span>
  <span class="n">END</span>
  <span class="n">BASIS</span>
    <span class="nb">type</span> <span class="n">TZ2P</span>
    <span class="n">core</span> <span class="n">SMALL</span>
  <span class="n">END</span>
<span class="n">SUBEND</span>
<span class="n">DESCRIPTION</span> <span class="mi">3</span>
  <span class="n">BASIS</span>
    <span class="nb">type</span> <span class="n">TZ2P</span>
    <span class="n">core</span> <span class="n">SMALL</span>
  <span class="n">END</span>
<span class="n">SUBEND</span>
</pre></div>
</div>
<p>Given here are the different descriptions that are needed for the BP86 and LDA treatments of the different regions. Note that there are two different descriptions using BP86, one (DESCRIPTION 1) for the complete system that has total charge -2, and a second one (DESCRIPTION 2) for the interaction between two stacked bases. For non-ADF (i.e. NEWMM, ORCA, DFTB, MOPAC, or GENERIC) jobs, on the first line of the corresponding DESCRIPTION subblock it should say so, as given in the example below for description 4 (HF/STO-3G with ORCA):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DESCRIPTION 4 ORCA   ! Options are ADF, DFTB, NEWMM, MOPAC, ORCA, GENERIC
  %coords
    mult 2
    charge -1
  end
  %method method hf
  end
  %basis basis sto_3g
  end
SUBEND
</pre></div>
</div>
<p>Note that in case of geometry optimizations where one of the jobs uses ORCA, the run-type (keyword runtyp) should be set to “gradient” in order that a “job*.engrad” file is written (by ORCA) that contains the ORCA energy and gradient. The QUILD program will automatically add this runtyp keyword to the corresponding input block. If the ORCA job deals with either an unrestricted job, or with a non-zero charge, it is best to put these data in the %coords block as shown above.</p>
<p>Together with the general input (apart from ATOMS, GEOMETRY, etc. blocks that are automatically generated by the QUILD program) the contents of these DESCRIPTION subblocks will constitute the “black-box” inputfile for the different programs. If there are differences in charge (<em>vide supra</em>), the charges of the total system and the regions should be given in these DESCRIPTION subblocks. Also when either the region is Unrestricted and the total system not (or vice versa), the description of being unrestricted (or not) should be given in the DESCRIPTION subblocks. Note that the general input contents is pasted only into input files for programs within the ADF program package, for external programs such as ORCA <strong>only the automatically generated atomic coordinates part and the part given in the DESCRIPTION subblock is put into the input file for the ORCA job.</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INTERACTIONS</span>
  <span class="n">TOTAL</span>     <span class="n">description</span> <span class="mi">1</span>
  <span class="n">INTXN</span> <span class="n">region</span> <span class="mi">1</span> <span class="n">region</span> <span class="mi">2</span>       <span class="n">description</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">description</span> <span class="mi">2</span>
  <span class="n">INTXN</span> <span class="n">region</span> <span class="mi">3</span> <span class="n">region</span> <span class="mi">4</span>       <span class="n">description</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">description</span> <span class="mi">2</span>
<span class="n">SUBEND</span>
</pre></div>
</div>
<p>This is the subblock that determines how the multi-level job is setup. The total system will be treated by description 1, i.e. BP86 for all atoms. Then in the second line, the BP86 interaction between regions 1 and 2 is replaced by the corresponding LDA interaction. In the last line, the BP86 interaction between regions 3 and 4 is replaced by the LDA interaction. In total there are therefore 5 ADF(by jobs per geometry cycle. When the ADF program package is setup to run in parallel, and this is taken care of properly in the $AMSBIN/start script, then also within QUILD this is used. At present no attempt has been made yet to prepare the interface for the parallel version of ORCA, the user is responsible for installing the ORCA program.</p>
</div>


           </div>
          </div>
          <!--STARTNOSOLR-->
<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="AddRemove_method_for_capping_atoms.html" class="btn btn-neutral float-right" title="AddRemove method for capping atoms" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Basic_philosophy.html" class="btn btn-neutral" title="Basic philosophy" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/> 

<!-- start :: footer -->
		<footer class="site-footer block">
			<div class="container">
				<div class="row">
					<div class="footer-column" >
	<ul>
		<li id="nav_menu-2" class="widget widget_nav_menu "><h3>Application Areas</h3><div class="menu-application-areas-container"><ul id="menu-application-areas" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/batteries/">Batteries &#038; PVs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/chemical-bonding-analysis/">Bonding Analysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/catalysis/">Catalysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/heavy-elements/">Heavy Elements</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/inorganic-chemistry/">Inorganic Chemistry</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/pharma/">Life Sciences</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/materials-science/">Materials Science</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/nanotechnology/">Nanotechnology</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/oil-and-gas/">Oil and Gas</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/organic-electronics/">Organic Electronics</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/polymers/">Polymers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/spectroscopy/">Spectroscopy</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/teaching/">Teaching</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-7" class="widget widget_nav_menu "><h3>Products</h3><div class="menu-product-navigation-container"><ul id="menu-product-navigation" class="menu">
<li id="menu-item-40263" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40263"><a href="https://www.scm.com/product/ams/">AMS Driver</a></li>
<li id="menu-item-7235" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7235"><a href="https://www.scm.com/product/adf/">ADF</a></li>
<li id="menu-item-7236" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7236"><a href="https://www.scm.com/product/band_periodicdft/">BAND</a></li>
<li id="menu-item-7237" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7237"><a href="https://www.scm.com/product/cosmo-rs/">COSMO-RS</a></li>
<li id="menu-item-7238" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7238"><a href="https://www.scm.com/product/dftb/">DFTB</a></li>
<li id="menu-item-7239" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7239"><a href="https://www.scm.com/product/gui/">GUI</a></li>
<li id="menu-item-44383" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-44383"><a href="https://www.scm.com/product/machine-learning-potentials/">MLPotential</a></li>
<li id="menu-item-7240" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7240"><a href="https://www.scm.com/product/mopac/">MOPAC</a></li>
<li id="menu-item-40262" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40262"><a href="https://www.scm.com/product/plams/">PLAMS</a></li>
<li id="menu-item-43701" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-43701"><a href="https://www.scm.com/product/quantum-espresso/">Quantum ESPRESSO</a></li>
<li id="menu-item-7241" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7241"><a href="https://www.scm.com/product/reaxff/">ReaxFF</a></li></ul></div></li><li id="nav_menu-26" class="widget widget_nav_menu "><div class="menu-licensing-container"><ul id="menu-licensing" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/">Pricing &#038; Licensing</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/">Price Quote</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/calculate-your-price/">Price Calculator</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/consulting/">Scientific Consulting</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/adf-resellers/">Resellers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/scm-license-terms/">License Terms</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/ordering-procedure/">Ordering</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-6" class="widget widget_nav_menu "><h3>Support</h3><div class="menu-support-navigation-container"><ul id="menu-support-navigation" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/">Support Overview</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-installation-videos/">Installation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-tutorials-and-manuals/">Documentation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/doc/Tutorials/GUI_overview/GUI_overview_tutorials.html">GUI Tutorials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/downloads/">Downloads</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/faq/">FAQs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/adf-discussion-list/">Discussion List</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/documentation-previous-versions/release-notes/">Release Notes</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/adf-teaching-materials/">Teaching Materials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/adf-hands-on-workshops/">Workshops</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/web-presentations-by-adf-experts/">Webinars</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/videos-tutorials-and-web-presentations/">Videos</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/brochures/">Brochure</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/amsterdam-modeling-suite/research-papers-citing-adf/">Papers Citing ADF</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/highlights/">Literature Highlights</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-28" class="widget widget_nav_menu "><h3>About Us</h3><div class="menu-about-us-container"><ul id="menu-about-us" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/contact-us/">Contact Us</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/eu-projects/">EU Projects</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-authors/">Contributors</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-people/">The SCM Team</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/collaborations/">Collaborations</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/careers/">Careers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/mission-vision/">Mission &#038; Vision</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/newsletters/">Newsletters</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/news/">News</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/">Events</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
			</ul>
</div>				</div>
			</div>
		</footer>
		<footer class="disclaimer-footer">
			<img src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="">
			<nav class="menu-service-navigation-container"><ul id="menu-service-navigation" class="menu-service navbar-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-73"><a href="https://www.scm.com/copyright/">Copyright</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72"><a href="https://www.scm.com/terms-of-use/">Terms of Use</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-71"><a href="https://www.scm.com/privacy-policy/">Privacy Policy</a></li>
</ul></nav></footer>	
		<!-- end :: footer -->

<!--ENDNOSOLR-->
        </div>
      </div>

    </section>
  </div>
  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2021.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCRWHZZ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/../../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>