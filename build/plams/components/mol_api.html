

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
<META name="ROBOTS" content="NOINDEX, NOFOLLOW">
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Molecule &mdash; PLAMS 2021.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/theme_tabs.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/panels-bootstrap.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PLAMS 2021.1 documentation" href="../index.html"/>
        <link rel="up" title="Molecule" href="molecule.html"/>
        <link rel="next" title="Atom" href="atombond.html"/>
        <link rel="prev" title="Molecule" href="molecule.html"/> 

  
  <script src="../_static/js/jquery.min.js"></script>
  <script src="../_static/js/bootstrap.min.js"></script>
  <script src="../_static/js/modernizr.min.js"></script>
  <script src="../_static/js/app.js"></script>
<script type="text/javascript">
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NCRWHZZ');</script>
<!-- End Google Tag Manager -->

</head>

<body class="wy-body-for-nav" role="document">
  <!--STARTNOSOLR-->
  <header class="site-header navbar-fixed-top compact">
      <nav class="main navbar navbar-default">
        <div class="headerbar_container">
          <a role="button" href="/free-trial/" class="btn btn-sm btn-primary">Free trial</a>
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div class="navbar-brand">
              <a class="logo" href="https://www.scm.com">
                <img class="logo-small" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="Software for Chemistry &amp; Materials" />
                <img class="logo-full" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo.svg" alt="Software for Chemistry &amp; Materials" />
              </a>
            </div>
          </div>
          <div class="nav-wrapper">
            <div class="collapse navbar-collapse">
              <ul id="menu-primary-navigation" class="nav navbar-nav"><li id="menu-item-40077" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-40077"><a title="Applications" href="https://www.scm.com/applications/">Applications</a></li>
<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a title="Products" href="https://www.scm.com/amsterdam-modeling-suite/">Products</a></li>
<li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36"><a title="Support" href="https://www.scm.com/support/">Support</a></li>
<li id="menu-item-37" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37"><a title="About us" href="https://www.scm.com/about-us/">About us</a></li>
</ul>                           <span class="search"><a class="menu_search_link" href="https://www.scm.com/search.php"></a><span class="sr-only">Search</span></span>
            </div>
          </div>
        </div>
      </nav>
 </header>
    

   
  <div id="doc-wrapper">
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/plams_logo.png" class="logo" />
          
          </a>

          
          
  <ul>
      <li class="wy-breadcrumbs-aside">
        
           
           
        
      </li>
  </ul>
 
<!--ENDNOSOLR-->
             <!--STARTNOSOLR-->
<div role="search">
  <form id="rtd-search-form" class="wy-form search-docs-form" action="https://www.scm.com/search.php" method="get">
  <div class="input-group">
    <input type="text" name="search" placeholder="Search PLAMS" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <input type="hidden" name="root" value="doctrunk" />


    <input type="hidden" name="cat" value="doc-scripting" />


    <span class="input-group-btn">
			<button type="submit" class="btn btn-primary"><span class="sr-only">Search</span><span class="fa fa-search"></span></button>
		</span>
	</div>
  </form>
</div>
<!--ENDNOSOLR-->
          

          
        </div>
<!--STARTNOSOLR-->
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#what-is-plams">What is PLAMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#what-can-be-done-with-plams">What can be done with PLAMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#simple-example">Simple example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#what-plams-is-not">What PLAMS is <em>not</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#about-this-documentation">About this documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../started.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../started.html#library-contents">Library contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../started.html#installing-plams">Installing PLAMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../started.html#updating-plams">Updating PLAMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../started.html#running-plams">Running PLAMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../started.html#defaults-file">Defaults file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../started.html#the-launch-script">The launch script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../started.html#working-folder-location">Working folder location</a></li>
<li class="toctree-l3"><a class="reference internal" href="../started.html#passing-variables">Passing variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../started.html#importing-past-jobs">Importing past jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../started.html#restarting-failed-script">Restarting failed script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../started.html#multiple-input-scripts">Multiple input scripts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="components.html">Components overview</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="settings.html">Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="settings.html#tree-like-structure">Tree-like structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="settings.html#dot-notation">Dot notation</a></li>
<li class="toctree-l3"><a class="reference internal" href="settings.html#case-sensitivity">Case sensitivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="settings.html#global-settings">Global settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="settings.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jobs.html">Jobs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jobs.html#preparing-a-job">Preparing a job</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jobs.html#contents-of-job-settings">Contents of job settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="jobs.html#default-settings">Default settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jobs.html#running-a-job">Running a job</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jobs.html#name-conflicts">Name conflicts</a></li>
<li class="toctree-l4"><a class="reference internal" href="jobs.html#prerun-and-postrun-methods">Prerun and postrun methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="jobs.html#preview-mode">Preview mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jobs.html#job-api">Job API</a></li>
<li class="toctree-l3"><a class="reference internal" href="jobs.html#single-jobs">Single jobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jobs.html#subclassing-singlejob">Subclassing SingleJob</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="jobs.html#multijobs">Multijobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="jobs.html#using-multijob">Using MultiJob</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="results.html">Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="results.html#files-in-the-job-folder">Files in the job folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="results.html#synchronization-of-parallel-job-executions">Synchronization of parallel job executions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="results.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="results.html#cleaning-job-folder">Cleaning job folder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="results.html#cleaning-for-multijobs">Cleaning for multijobs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="results.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="runners.html">Job runners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="runners.html#local-job-runner">Local job runner</a></li>
<li class="toctree-l3"><a class="reference internal" href="runners.html#remote-job-runner">Remote job runner</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="jobmanager.html">Job manager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jobmanager.html#rerun-prevention">Rerun prevention</a></li>
<li class="toctree-l3"><a class="reference internal" href="jobmanager.html#pickling">Pickling</a></li>
<li class="toctree-l3"><a class="reference internal" href="jobmanager.html#restarting-scripts">Restarting scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="jobmanager.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Public functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="functions.html#logging">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="functions.html#binding-decorators">Binding decorators</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="molecule.html">Molecule</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Molecule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#atom-labeling">Atom labeling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="atombond.html">Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="atombond.html#bond">Bond</a></li>
<li class="toctree-l3"><a class="reference internal" href="mol_rdkit.html">RDKit interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="mol_ase.html">ASE interface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#periodic-table">Periodic Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#units">Units</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#geometry-tools">Geometry tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#file-format-conversion-tools">File format conversion tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="trajectories.html">Trajectories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="xyz.html">XYZ trajectory files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="xyz.html#xyz-history-files">XYZ history files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rkf.html">RKF trajectory files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rkf.html#rkf-history-files">RKF history files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dcd.html">DCD trajectory files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interfaces/interfaces.html">Interfaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interfaces/amssuite.html">Amsterdam Modeling Suite</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/ams.html">AMS driver and engines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/ams.html#preparing-input">Preparing input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/ams.html#preparing-runscript">Preparing runscript</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/ams.html#molecule-handling">Molecule handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/ams.html#amsjob-api">AMSJob API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/ams.html#amsresults-api">AMSResults API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/amsworker.html">AMS worker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/amsworker.html#amsworker-api">AMSWorker API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/amsworker.html#amsworkerresults-api">AMSWorkerResults API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/amsworker.html#amsworkerpool-api">AMSWorkerPool API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/postadf.html">Analysis tools: Densf, FCF, analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/kffiles.html">KF files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/crs.html">COSMO-RS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crs.html#settings">Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crs.html#settings-with-multiple-compound">Settings with multiple compound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crs.html#adf-and-crsjob">ADF and CRSJob</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crs.html#cosmo-rs-parameters">COSMO-RS Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crs.html#data-analyses-and-plotting">Data analyses and plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crs.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/adf.html">ADF (pre-2020 version)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/adf.html#preparing-input">Preparing input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/adf.html#preparing-runscript">Preparing runscript</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/adf.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/reaxff.html">ReaxFF (pre-2019 version)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../interfaces/thirdparty.html">Other programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/cp2k.html">CP2K</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/cp2k.html#settings">Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/cp2k.html#molecule-parsing">Molecule parsing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/cp2k.html#loading-jobs">Loading jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/cp2k.html#molecule-loading">Molecule loading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/cp2k.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/crystal.html">Crystal</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crystal.html#preparing-a-calculation">Preparing a calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crystal.html#molecule-parsing">Molecule parsing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crystal.html#results-extraction">Results extraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crystal.html#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/crystal.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/dftbplus.html">DFTB+</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/dftbplus.html#preparing-a-calculation">Preparing a calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/dftbplus.html#results-extraction">Results extraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/dftbplus.html#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/dftbplus.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/dirac.html">Dirac</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/dirac.html#preparing-a-calculation">Preparing a calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/dirac.html#results-extraction">Results extraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/dirac.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/mopac.html">MOPAC (standalone program)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/mopac.html#preparing-input">Preparing input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/mopac.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/orca.html">ORCA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/orca.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/raspa.html">RASPA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/raspa.html#input">Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/raspa.html#molecule-parsing">Molecule parsing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/raspa.html#loading-jobs">Loading jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../interfaces/raspa.html#api">API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/examples.html#id1">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/He2DissociationCurve.html">Helium dimer dissociation curve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/WaterOptimization.html">Geometry optimization of water</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/ManyJobsInParallel.html">Many jobs in parallel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/BasisSetBenchmark.html">Benchmark accuracy of basis sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/ExcitationsWorkflow.html">Workflow: filtering molecules based on excitation energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/ChargeTransferIntegralsADF.html">Charge transfer integrals with ADF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/gammascan.html">Tuning the range separation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/examples.html#pre-made-recipes">Pre-made recipes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/ams_crs.html">ADF and COSMO-RS workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/adffragment.html">ADF fragment job</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/ReorganizationEnergy.html">Reorganization Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/adfnbo.html">NBO with ADF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/numgrad.html">Numerical gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/numhess.html">Numerical Hessian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/molecule_gun.html">ReaxFF molecule gun</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/global_minimum.html">Global Minimum Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/vibrationASE.html">Vibrational analysis with ASE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/vibrationASE.html#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/vibrationASE.html#api">API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook/cookbook.html">Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/cookbook.html#settings-and-input">Settings and input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#create-an-input-block-with-an-header">Create an input block with an header</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#create-an-empty-input-block">Create an empty input block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#convert-an-ams-text-input-into-an-ams-job">Convert an AMS text input into an AMS job</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#convert-an-ams-text-input-into-settings-object">Convert an AMS text input into settings object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#convert-an-ams-run-file-into-an-amsjob">Convert an AMS .run file into an AMSJob</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/cookbook.html#molecules">Molecules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#generate-a-molecule-from-a-smiles-string">Generate a molecule from a SMILES string</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#counting-rings">Counting rings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/cookbook.html#extracting-results">Extracting Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#directly-from-functions">Directly from Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cookbook/cookbook.html#examples-total-energy-and-final-structure">Examples: Total Energy and Final Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cookbook/cookbook.html#amsresults-api-functions">AMSResults API Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#from-the-rkf-interface">From the RKF Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#finding-section-variable-pairs">Finding Section/Variable Pairs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cookbook/cookbook.html#from-python-directories">From Python Directories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cookbook/cookbook.html#kfbrowser">KFBrowser</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#from-md-trajectories">From MD trajectories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cookbook/cookbook.html#general-md-properties">General MD properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cookbook/cookbook.html#molecules-from-trajectories">Molecules from trajectories</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cookbook/cookbook.html#accessing-old-jobs">Accessing Old Jobs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#binding-native-plams-jobs">Binding Native PLAMS Jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cookbook/cookbook.html#binding-old-rkf-files">Binding old RKF Files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../citations.html">Citations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">PLAMS</a>
      </nav>
<!--ENDNOSOLR-->

      
      <div class="wy-nav-content">
        <div class="rst-content">
        <!--STARTNOSOLR-->
<div class="header" role="navigation" aria-label="breadcrumbs navigation">
 
  <ul class="wy-breadcrumbs">
    <li><a href="../PLAMS.html/../../Documentation/index.html">Documentation</a>/</li>
    <li><a href="../index.html">PLAMS</a>/</li>
      
          <li><a href="components.html">Components overview</a>/</li>
      
          <li><a href="molecule.html">Molecule</a>/</li>
      
    <li class="orange-text">Molecule</li>
  </ul>
  <p>
 
</div>
<!--ENDNOSOLR-->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="molecule">
<h1>Molecule<a class="headerlink" href="#molecule" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="scm.plams.mol.molecule.Molecule">
<em class="property">class </em><code class="descname">Molecule</code><span class="sig-paren">(</span><em>filename=None</em>, <em>inputformat=None</em>, <em>positions=None</em>, <em>numbers=None</em>, <em>lattice=None</em>, <em>**other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>A class representing the molecule object.</p>
<p>An instance of this class has the following attributes:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">atoms</span></code> – list of <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> objects that belong to the molecule</li>
<li><code class="docutils literal notranslate"><span class="pre">bonds</span></code> – list of <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> objects between atoms listed in <code class="docutils literal notranslate"><span class="pre">atoms</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">lattice</span></code> – list of lattice vectors in case of periodic structures</li>
<li><code class="docutils literal notranslate"><span class="pre">properties</span></code> – <a class="reference internal" href="settings.html#scm.plams.core.settings.Settings" title="scm.plams.core.settings.Settings"><code class="xref py py-class docutils literal notranslate"><span class="pre">Settings</span></code></a> instance storing all other information about the molecule</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Each <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> in <code class="docutils literal notranslate"><span class="pre">atoms</span></code> list and each <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> in <code class="docutils literal notranslate"><span class="pre">bonds</span></code> list has a reference to the parent molecule. Moreover, each atom stores the list of bonds it’s a part of and each bond stores references to atoms it bonds. That creates a complex net of references between objects that are part of a molecule. Consistency of this data is crucial for proper functioning of many methods. Because of that it is advised not to modify contents of <code class="docutils literal notranslate"><span class="pre">atoms</span></code> and <code class="docutils literal notranslate"><span class="pre">bonds</span></code> by hand. When you need to alter your molecule, methods <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.add_atom" title="scm.plams.mol.molecule.Molecule.add_atom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_atom()</span></code></a>, <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.delete_atom" title="scm.plams.mol.molecule.Molecule.delete_atom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_atom()</span></code></a>, <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.add_bond" title="scm.plams.mol.molecule.Molecule.add_bond"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_bond()</span></code></a> and <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.delete_bond" title="scm.plams.mol.molecule.Molecule.delete_bond"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_bond()</span></code></a> can be used to ensure that all these references are updated properly.</p>
</div>
<p>Creating a <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object for your calculation can be done in several ways. You can start with an empty molecule and manually add all atoms (and bonds, if needed):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">atnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="n">mol</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">atnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
<p>This approach can be useful for building small molecules, especially if you wish to parametrize some of atomic coordinates (like in <a class="reference internal" href="../intro.html#simple-example"><span class="std std-ref">Simple example</span></a>), but in general it’s not very practical.
If coordinates and atom numbers are available, instantiation can be done by passing a value to the <cite>positions</cite>, <cite>numbers</cite> and optionally the <cite>lattice</cite> arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xyz</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># 10 atoms, 3 coordinates per atom</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="c1"># 10 carbon atoms. If left None, will initialize to dummy atoms</span>
<span class="n">lattice</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span> <span class="c1"># lattice should have a shape of {1,2,3}x3</span>
<span class="n">mol</span>     <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">positions</span><span class="o">=</span><span class="n">xyz</span><span class="p">,</span> <span class="n">numbers</span><span class="o">=</span><span class="n">numbers</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">lattice</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, one can import atomic coordinates from some external file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;xyz/Benzene.xyz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The constructor of a <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> object accepts four arguments that can be used to supply this information from a file in your filesystem. <em>filename</em> should be a string with a path (absolute or relative) to such a file. <em>inputformat</em> describes the format of the file. Currently, the following formats are supported: <code class="docutils literal notranslate"><span class="pre">xyz</span></code>, <code class="docutils literal notranslate"><span class="pre">mol</span></code>, <code class="docutils literal notranslate"><span class="pre">mol2</span></code> and <code class="docutils literal notranslate"><span class="pre">pdb</span></code>. If <em>inputformat</em> is <code class="docutils literal notranslate"><span class="pre">ase</span></code> the file reader engine of the ASE.io module is used, enabling you to read all input formats supported by <a class="reference internal" href="mol_ase.html#aseinterface"><span class="std std-ref">ASE interface</span></a>. See <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.read" title="scm.plams.mol.molecule.Molecule.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> for further details. If the <em>inputformat</em> argument is not supplied, PLAMS will try to deduce it by examining the extension of the provided file, so in most of cases it is not needed to use <em>inputformat</em>, if only the file has the proper extension. Some formats (<code class="docutils literal notranslate"><span class="pre">xyz</span></code> and <code class="docutils literal notranslate"><span class="pre">pdb</span></code>) allow to store more than one geometry of a particular molecule within a single file. See the respective <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.read" title="scm.plams.mol.molecule.Molecule.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> function for details how to access them. All <em>other</em> keyword arguments will be passed to the appropriate read function for the selected or determined file format.</p>
<p>If a <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> is initialized from an external file, the path to this file (<em>filename</em> argument) is stored in <code class="docutils literal notranslate"><span class="pre">properties.source</span></code>. The base name of the file (filename without the extension) is kept in <code class="docutils literal notranslate"><span class="pre">properties.name</span></code>.</p>
<p>It is also possible to write a molecule to a file in one of the formats mentioned above or using the ASE.io engine. See <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.write" title="scm.plams.mol.molecule.Molecule.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> for details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">lattice</span></code> attribute is used to store information about lattice vectors in case of periodic structures. Some job types will automatically use that data while constructing input files. <code class="docutils literal notranslate"><span class="pre">lattice</span></code> should be a list of up to 3 vectors (for different types of periodicity: chain, slab or bulk), each of which needs to be a list or a tuple of 3 numbers.</p>
<p>Lattice vectors can be directly read from and written to <code class="docutils literal notranslate"><span class="pre">xyz</span></code> files using the following convention (please mind the fact that this is an unofficial extension to the XYZ format):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>3

    H      0.000000      0.765440     -0.008360
    O      0.000000      0.000000      0.593720
    H      0.000000     -0.765440     -0.008360
VEC1       3.000000      0.000000      0.000000
VEC2       0.000000      3.000000      0.000000
VEC3       0.000000      0.000000      3.000000
</pre></div>
</div>
<p>For 1D (2D) periodicity please supply only <code class="docutils literal notranslate"><span class="pre">VEC1</span></code> (<code class="docutils literal notranslate"><span class="pre">VEC1</span></code> and <code class="docutils literal notranslate"><span class="pre">VEC2</span></code>). Writing lattice vectors to <code class="docutils literal notranslate"><span class="pre">xyz</span></code> files can be disabled by simply reseting the <code class="docutils literal notranslate"><span class="pre">lattice</span></code> attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">lattice</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<p>The detailed description of all available methods is presented below. Many of these methods require arguments that are atoms belonging to the current molecule. It can by done by using a reference to an <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> object present it the <code class="docutils literal notranslate"><span class="pre">atoms</span></code> list, but not by passing a number of an atom (its position within <code class="docutils literal notranslate"><span class="pre">atoms</span></code> list). Unlike some other tools, PLAMS does not use integer numbers as primary identifiers of atoms. It is done to prevent problems when atoms within a molecule are reordered or some atoms are deleted. References to <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> or <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> objects can be obtained directly from <code class="docutils literal notranslate"><span class="pre">atoms</span></code> or <code class="docutils literal notranslate"><span class="pre">bonds</span></code> lists, or with dictionary-like bracket notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;xyz/Ammonia.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">guess_bonds</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         H      0.942179      0.000000     -0.017370</span>
<span class="go">    2         H     -0.471089      0.815951     -0.017370</span>
<span class="go">    3         N      0.000000      0.000000      0.383210</span>
<span class="go">    4         H     -0.471089     -0.815951     -0.017370</span>
<span class="go">  Bonds:</span>
<span class="go">   (1)--1.0--(3)</span>
<span class="go">   (2)--1.0--(3)</span>
<span class="go">   (3)--1.0--(4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">at</span> <span class="o">=</span> <span class="n">mol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
<span class="go">         H      0.942179      0.000000     -0.017370</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">mol</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(         H      0.942179      0.000000     -0.017370 )--1.0--(         N      0.000000      0.000000      0.383210 )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">mol</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the purpose of <code class="docutils literal notranslate"><span class="pre">mol[i]</span></code> notation, the numbering of atoms within a molecule starts with 1. Negative integers can be used to access atoms enumerated in the reversed order (<code class="docutils literal notranslate"><span class="pre">mol[-1]</span></code> for the last atom etc.)</p>
</div>
<p>However, if you feel more familiar with identifying atoms by natural numbers, you can use <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.set_atoms_id" title="scm.plams.mol.molecule.Molecule.set_atoms_id"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_atoms_id()</span></code></a> to equip each atom of the molecule with <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute equal to atom’s position within <code class="docutils literal notranslate"><span class="pre">atoms</span></code> list. This method can also be helpful to track changes in your molecule during tasks that can reorder atoms.</p>
<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>filename=None</em>, <em>inputformat=None</em>, <em>positions=None</em>, <em>numbers=None</em>, <em>lattice=None</em>, <em>**other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>atoms=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of the molecule. The copy has atoms, bonds and all other components distinct from the original molecule (it is so called “deep copy”).</p>
<p>By default the entire molecule is copied. It is also possible to copy only some part of the molecule, indicated by <em>atoms</em> argument. It should be a list of atoms that belong to the molecule. If used, only these atoms, together with any bonds between them, are copied and included in the returned molecule.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.add_molecule">
<code class="descname">add_molecule</code><span class="sig-paren">(</span><em>other</em>, <em>copy=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.add_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.add_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Add some <em>other</em> molecule to this one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">protein</span> <span class="o">+=</span> <span class="n">water</span>
</pre></div>
</div>
<p>If <em>copy</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, <em>other</em> molecule is copied and the copy is added to this molecule. Otherwise, <em>other</em> molecule is directly merged with this one
The <code class="docutils literal notranslate"><span class="pre">properties</span></code> of this molecule are <a class="reference internal" href="settings.html#scm.plams.core.settings.Settings.soft_update" title="scm.plams.core.settings.Settings.soft_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">soft_updated</span></code></a> with the  <code class="docutils literal notranslate"><span class="pre">properties</span></code> of the <em>other</em> molecules.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.add_atom">
<code class="descname">add_atom</code><span class="sig-paren">(</span><em>atom</em>, <em>adjacent=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.add_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new <em>atom</em> to the molecule.</p>
<p><em>atom</em> should be an <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> instance that does not belong to any molecule. Bonds between the new atom and other atoms of the molecule can be automatically added based on <em>adjacent</em> argument. It should be a list describing atoms of the molecule that the new atom is connected to. Each element of <em>adjacent</em> list can either be a pair <code class="docutils literal notranslate"><span class="pre">(Atom,</span> <span class="pre">order)</span></code> to indicate new bond’s order (use <code class="docutils literal notranslate"><span class="pre">Bond.AR</span></code> for aromatic bonds) or an <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> instance (a single bond is created in this case).</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span> <span class="c1">#create an empty molecule</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="n">mol</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">h1</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">h2</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">adjacent</span><span class="o">=</span><span class="p">[</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="p">(</span><span class="n">o</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.delete_atom">
<code class="descname">delete_atom</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.delete_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.delete_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an <em>atom</em> from the molecule.</p>
<p><em>atom</em> should be an <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> instance that belongs to the molecule. All bonds containing this atom are removed too.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#delete all hydrogens</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;protein.pdb&#39;</span><span class="p">)</span>
<span class="n">hydrogens</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span> <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">atnum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">hydrogens</span><span class="p">:</span> <span class="n">mol</span><span class="o">.</span><span class="n">delete_atom</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#delete first two atoms</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;geom.xyz&#39;</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">delete_atom</span><span class="p">(</span><span class="n">mol</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">mol</span><span class="o">.</span><span class="n">delete_atom</span><span class="p">(</span><span class="n">mol</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#since the second atom of original molecule is now the first</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.add_bond">
<code class="descname">add_bond</code><span class="sig-paren">(</span><em>arg1</em>, <em>arg2=None</em>, <em>order=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.add_bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.add_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new bond to the molecule.</p>
<p>This method can be used in two different ways. You can call it with just one argument being a <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> instance (other arguments are then ignored):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Bond</span><span class="p">(</span><span class="n">mol</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mol</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="n">Bond</span><span class="o">.</span><span class="n">AR</span><span class="p">)</span> <span class="c1">#create aromatic bond between 2nd and 4th atom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>The other way is to pass two atoms (and possibly bond order) and new <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> object will be created automatically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">mol</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">mol</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="n">Bond</span><span class="o">.</span><span class="n">AR</span><span class="p">)</span>
</pre></div>
</div>
<p>In both cases both atoms that are bonded have to belong to the molecule, otherwise an exception is raised.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.delete_bond">
<code class="descname">delete_bond</code><span class="sig-paren">(</span><em>arg1</em>, <em>arg2=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.delete_bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.delete_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a bond from the molecule.</p>
<p>Just like <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.add_bond" title="scm.plams.mol.molecule.Molecule.add_bond"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_bond()</span></code></a>, this method accepts either a single argument that is a <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> instance, or two arguments being instances of <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>. In both cases objects used as arguments have to belong to the molecule.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.delete_all_bonds">
<code class="descname">delete_all_bonds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.delete_all_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.delete_all_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete all bonds from the molecule.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.find_bond">
<code class="descname">find_bond</code><span class="sig-paren">(</span><em>atom1</em>, <em>atom2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.find_bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.find_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Find and return a bond between <em>atom1</em> and <em>atom2</em>. Both atoms have to belong to the molecule. If no bond between chosen atoms exists, the retured value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.set_atoms_id">
<code class="descname">set_atoms_id</code><span class="sig-paren">(</span><em>start=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.set_atoms_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.set_atoms_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Equip each atom of the molecule with the <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute equal to its position within <code class="docutils literal notranslate"><span class="pre">atoms</span></code> list.</p>
<p>The starting value of the numbering can be set with <em>start</em> (starts at 1 by default).</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.unset_atoms_id">
<code class="descname">unset_atoms_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.unset_atoms_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.unset_atoms_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete <code class="docutils literal notranslate"><span class="pre">id</span></code> attributes of all atoms.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.neighbors">
<code class="descname">neighbors</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of neighbors of <em>atom</em> within the molecule.</p>
<p><em>atom</em> has to belong to the molecule. Returned list follows the same order as the <code class="docutils literal notranslate"><span class="pre">bonds</span></code> attribute of <em>atom</em>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.bond_matrix">
<code class="descname">bond_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.bond_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.bond_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a square numpy array with bond orders. The size of the array is equal to the number of atoms.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.separate">
<code class="descname">separate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.separate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.separate" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate the molecule into connected components.</p>
<p>Returned is a list of new <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> objects (all atoms and bonds are disjoint with the original molecule). Each element of this list is identical to one connected component of the base molecule. A connected component is a subset of atoms such that there exists a path (along one or more bonds) between any two atoms. Usually these connected components are molecules.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;xyz_dimers/NH3-H2O.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">guess_bonds</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         N     -1.395591     -0.021564      0.000037</span>
<span class="go">    2         H     -1.629811      0.961096     -0.106224</span>
<span class="go">    3         H     -1.862767     -0.512544     -0.755974</span>
<span class="go">    4         H     -1.833547     -0.330770      0.862307</span>
<span class="go">    5         O      1.568501      0.105892      0.000005</span>
<span class="go">    6         H      0.606736     -0.033962     -0.000628</span>
<span class="go">    7         H      1.940519     -0.780005      0.000222</span>
<span class="go">  Bonds:</span>
<span class="go">   (5)--1.0--(7)</span>
<span class="go">   (5)--1.0--(6)</span>
<span class="go">   (1)--1.0--(3)</span>
<span class="go">   (1)--1.0--(4)</span>
<span class="go">   (1)--1.0--(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">separate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         N     -1.395591     -0.021564      0.000037</span>
<span class="go">    2         H     -1.629811      0.961096     -0.106224</span>
<span class="go">    3         H     -1.862767     -0.512544     -0.755974</span>
<span class="go">    4         H     -1.833547     -0.330770      0.862307</span>
<span class="go">  Bonds:</span>
<span class="go">   (1)--1.0--(3)</span>
<span class="go">   (1)--1.0--(4)</span>
<span class="go">   (1)--1.0--(2)</span>

<span class="go">  Atoms:</span>
<span class="go">    1         O      1.568501      0.105892      0.000005</span>
<span class="go">    2         H      0.606736     -0.033962     -0.000628</span>
<span class="go">    3         H      1.940519     -0.780005      0.000222</span>
<span class="go">  Bonds:</span>
<span class="go">   (1)--1.0--(3)</span>
<span class="go">   (1)--1.0--(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.guess_bonds">
<code class="descname">guess_bonds</code><span class="sig-paren">(</span><em>atom_subset=None</em>, <em>dmax=1.28</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.guess_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.guess_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to guess bonds in the molecule based on types and positions of atoms.</p>
<p>All previously existing bonds are removed. New bonds are generated based on interatomic distances and information about maximal number of bonds for each atom type (<code class="docutils literal notranslate"><span class="pre">connectors</span></code> property, taken from <a class="reference internal" href="utils.html#scm.plams.tools.periodic_table.PeriodicTable" title="scm.plams.tools.periodic_table.PeriodicTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeriodicTable</span></code></a>).</p>
<p>The problem of finding molecular bonds for a given set of atoms in space does not have a general solution, especially considering the fact the chemical bond in itself is not a precisely defined concept. For every method, no matter how sophisticated, there will always be corner cases for which the method produces disputable results. Moreover, depending on the context (area of application) the desired solution for a particular geometry may vary. Please do not treat this method as an oracle always providing a proper solution. The algorithm used here gives very good results for geometries that are not very far from the optimal geometry, especially consisting of lighter atoms. All kinds of organic molecules, including aromatic ones, usually work very well. Problematic results can emerge for transition metal complexes, transition states, incomplete molecules etc.</p>
<p>The algorithm used scales as <em>n log n</em> where <em>n</em> is the number of atoms.</p>
<p>The <em>atom_subset</em> argument can be used to limit the bond guessing to a subset of atoms, it should be an iterable container with atoms belonging to this molecule.</p>
<p>The <em>dmax</em> argument gives the maximum value for ratio of the bond length to the sum of atomic radii for the two atoms in the bond.</p>
<p>The bond order for any bond to a metal atom will be set to 1.</p>
<div class="admonition danger">
<p class="first admonition-title">Warning</p>
<p class="last">This method works reliably only for geometries representing complete molecules. If some atoms are missing (for example, a protein without hydrogens) the resulting set of bonds would usually contain more bonds or bonds with higher order than expected.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.in_ring">
<code class="descname">in_ring</code><span class="sig-paren">(</span><em>arg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.in_ring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.in_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if an atom or a bond belonging to this <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> forms a ring. <em>arg</em> should be an instance of <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> or <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> belonging to this <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.supercell">
<code class="descname">supercell</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.supercell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.supercell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instance representing a supercell build by replicating this <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> along its lattice vectors.</p>
<p>One should provide in input an integer matrix <span class="math notranslate nohighlight">\(T_{i,j}\)</span> representing the supercell transformation (<span class="math notranslate nohighlight">\(\vec{a}_i' = \sum_j T_{i,j}\vec{a}_j\)</span>). The size of the matrix should match the number of lattice vectors, i.e. 3x3 for 3D periodic systems, 2x2 for 2D periodic systems and one number for 1D periodic systems. The matrix can be provided in input as either a nested list or as a numpy matrix.</p>
<p>For a diagonal supercell expansion (i.e. <span class="math notranslate nohighlight">\(T_{i \neq j}=0\)</span>) one can provide in input n positive integers instead of a matrix, where n is number of lattice vectors in the molecule. e.g. This <code class="docutils literal notranslate"><span class="pre">mol.supercell([[2,0],[0,2]])</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">mol.supercell(2,2)</span></code>.</p>
<p>The returned <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> is fully distinct from the current one, in a sense that it contains a different set of <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> and <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> instances. However, each atom of the returned <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> carries an additional information about its origin within the supercell. If <code class="docutils literal notranslate"><span class="pre">atom</span></code> is an <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> instance in the supercell, <code class="docutils literal notranslate"><span class="pre">atom.properties.supercell.origin</span></code> points to the <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> instance of the original molecule that was copied to create <code class="docutils literal notranslate"><span class="pre">atom</span></code>, while <code class="docutils literal notranslate"><span class="pre">atom.properties.supercell.index</span></code> stores the tuple (with length equal to the number of lattice vectors) with cell index. For example, <code class="docutils literal notranslate"><span class="pre">atom.properties.supercell.index</span> <span class="pre">==</span> <span class="pre">(2,1,0)</span></code> means that <code class="docutils literal notranslate"><span class="pre">atom</span></code> is a copy of <code class="docutils literal notranslate"><span class="pre">atom.properties.supercell.origin</span></code> that was translated twice along the first lattice vector, once along the second vector, and not translated along the third vector.</p>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graphene</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;graphene.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">graphene</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         C      0.000000      0.000000      0.000000</span>
<span class="go">    2         C      1.230000      0.710000      0.000000</span>
<span class="go">  Lattice:</span>
<span class="go">        2.4600000000     0.0000000000     0.0000000000</span>
<span class="go">        1.2300000000     2.1304224933     0.0000000000</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">graphene_supercell</span> <span class="o">=</span> <span class="n">graphene</span><span class="o">.</span><span class="n">supercell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># diagonal supercell expansion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">graphene_supercell</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         C      0.000000      0.000000      0.000000</span>
<span class="go">    2         C      1.230000      0.710000      0.000000</span>
<span class="go">    3         C      1.230000      2.130422      0.000000</span>
<span class="go">    4         C      2.460000      2.840422      0.000000</span>
<span class="go">    5         C      2.460000      0.000000      0.000000</span>
<span class="go">    6         C      3.690000      0.710000      0.000000</span>
<span class="go">    7         C      3.690000      2.130422      0.000000</span>
<span class="go">    8         C      4.920000      2.840422      0.000000</span>
<span class="go">  Lattice:</span>
<span class="go">        4.9200000000     0.0000000000     0.0000000000</span>
<span class="go">        2.4600000000     4.2608449866     0.0000000000</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;diamond.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">diamond</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         C     -0.446100     -0.446200     -0.446300</span>
<span class="go">    2         C      0.446400      0.446500      0.446600</span>
<span class="go">  Lattice:</span>
<span class="go">        0.0000000000     1.7850000000     1.7850000000</span>
<span class="go">        1.7850000000     0.0000000000     1.7850000000</span>
<span class="go">        1.7850000000     1.7850000000     0.0000000000</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond_supercell</span> <span class="o">=</span> <span class="n">diamond</span><span class="o">.</span><span class="n">supercell</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">diamond_supercell</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         C     -0.446100     -0.446200     -0.446300</span>
<span class="go">    2         C      0.446400      0.446500      0.446600</span>
<span class="go">    3         C      1.338900      1.338800     -0.446300</span>
<span class="go">    4         C      2.231400      2.231500      0.446600</span>
<span class="go">    5         C      1.338900     -0.446200      1.338700</span>
<span class="go">    6         C      2.231400      0.446500      2.231600</span>
<span class="go">    7         C     -0.446100      1.338800      1.338700</span>
<span class="go">    8         C      0.446400      2.231500      2.231600</span>
<span class="go">  Lattice:</span>
<span class="go">        3.5700000000     0.0000000000     0.0000000000</span>
<span class="go">        0.0000000000     3.5700000000     0.0000000000</span>
<span class="go">        0.0000000000     0.0000000000     3.5700000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.unit_cell_volume">
<code class="descname">unit_cell_volume</code><span class="sig-paren">(</span><em>unit='angstrom'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.unit_cell_volume"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.unit_cell_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the volume of the unit cell of a 3D system.</p>
<p><em>unit</em> is the unit of length, the cube of which will be used as the unit of volume.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.cell_lengths">
<code class="descname">cell_lengths</code><span class="sig-paren">(</span><em>unit='angstrom'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.cell_lengths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.cell_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lengths of the lattice vector. Returns a list with the same length as self.lattice</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.cell_angles">
<code class="descname">cell_angles</code><span class="sig-paren">(</span><em>unit='degree'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.cell_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.cell_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the angles between lattice vectors.</p>
<dl class="docutils">
<dt>unit <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>output unit</dd>
</dl>
<p>For 2D systems, returns a list [gamma]</p>
<p>For 3D systems, returns a list [alpha, beta, gamma]</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.set_integer_bonds">
<code class="descname">set_integer_bonds</code><span class="sig-paren">(</span><em>action='warn'</em>, <em>tolerance=0.0001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.set_integer_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.set_integer_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert non-integer bond orders into integers.</p>
<p>For example, bond orders of aromatic systems are no longer set to the non-integer
value of <code class="docutils literal notranslate"><span class="pre">1.5</span></code>, instead adopting bond orders of <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
<p>The implemented function walks a set of graphs constructed from all non-integer bonds,
converting the orders of aforementioned bonds to integers by alternating calls to
<a class="reference external" href="https://docs.python.org/3.6/library/math.html#math.ceil" title="(in Python v3.6)"><code class="xref py py-func docutils literal notranslate"><span class="pre">math.ceil()</span></code></a> and <a class="reference external" href="https://docs.python.org/3.6/library/math.html#math.floor" title="(in Python v3.6)"><code class="xref py py-func docutils literal notranslate"><span class="pre">math.floor()</span></code></a>.
The implication herein is that both <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(i+1\)</span> are considered valid
(integer) values for any bond order within the <span class="math notranslate nohighlight">\((i, i+1)\)</span> interval.
Floats which can be represented exactly as an integer, <em>e.g.</em> <span class="math notranslate nohighlight">\(1.0\)</span>,
are herein treated as integers.</p>
<p>Can be used for sanitizaing any Molecules passed to the
<a class="reference internal" href="mol_rdkit.html#module-scm.plams.interfaces.molecule.rdkit" title="scm.plams.interfaces.molecule.rdkit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code></a> module,
as its functions are generally unable to handle Molecules with non-integer bond orders.</p>
<p>By default this function will issue a warning if the total (summed) bond orders
before and after are not equal to each other within a given <em>tolerance</em>.
Accepted values are for <em>action</em> are <code class="docutils literal notranslate"><span class="pre">&quot;ignore&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;warn&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;raise&quot;</span></code>,
which respectivelly ignore such cases, issue a warning or raise a <code class="xref py py-exc docutils literal notranslate"><span class="pre">MoleculeError</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="kn">import</span> <span class="n">Molecule</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">benzene</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         C      1.193860     -0.689276      0.000000</span>
<span class="go">    2         C      1.193860      0.689276      0.000000</span>
<span class="go">    3         C      0.000000      1.378551      0.000000</span>
<span class="go">    4         C     -1.193860      0.689276      0.000000</span>
<span class="go">    5         C     -1.193860     -0.689276      0.000000</span>
<span class="go">    6         C     -0.000000     -1.378551      0.000000</span>
<span class="go">    7         H      2.132911     -1.231437     -0.000000</span>
<span class="go">    8         H      2.132911      1.231437     -0.000000</span>
<span class="go">    9         H      0.000000      2.462874     -0.000000</span>
<span class="go">   10         H     -2.132911      1.231437     -0.000000</span>
<span class="go">   11         H     -2.132911     -1.231437     -0.000000</span>
<span class="go">   12         H     -0.000000     -2.462874     -0.000000</span>
<span class="go">  Bonds:</span>
<span class="go">   (3)--1.5--(4)</span>
<span class="go">   (5)--1.5--(6)</span>
<span class="go">   (1)--1.5--(6)</span>
<span class="go">   (2)--1.5--(3)</span>
<span class="go">   (4)--1.5--(5)</span>
<span class="go">   (1)--1.5--(2)</span>
<span class="go">   (3)--1.0--(9)</span>
<span class="go">   (6)--1.0--(12)</span>
<span class="go">   (5)--1.0--(11)</span>
<span class="go">   (4)--1.0--(10)</span>
<span class="go">   (2)--1.0--(8)</span>
<span class="go">   (1)--1.0--(7)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">benzene</span><span class="o">.</span><span class="n">set_integer_bonds</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">benzene</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         C      1.193860     -0.689276      0.000000</span>
<span class="go">    2         C      1.193860      0.689276      0.000000</span>
<span class="go">    3         C      0.000000      1.378551      0.000000</span>
<span class="go">    4         C     -1.193860      0.689276      0.000000</span>
<span class="go">    5         C     -1.193860     -0.689276      0.000000</span>
<span class="go">    6         C     -0.000000     -1.378551      0.000000</span>
<span class="go">    7         H      2.132911     -1.231437     -0.000000</span>
<span class="go">    8         H      2.132911      1.231437     -0.000000</span>
<span class="go">    9         H      0.000000      2.462874     -0.000000</span>
<span class="go">   10         H     -2.132911      1.231437     -0.000000</span>
<span class="go">   11         H     -2.132911     -1.231437     -0.000000</span>
<span class="go">   12         H     -0.000000     -2.462874     -0.000000</span>
<span class="go">  Bonds:</span>
<span class="go">   (3)--1.0--(4)</span>
<span class="go">   (5)--1.0--(6)</span>
<span class="go">   (1)--2.0--(6)</span>
<span class="go">   (2)--2.0--(3)</span>
<span class="go">   (4)--2.0--(5)</span>
<span class="go">   (1)--1.0--(2)</span>
<span class="go">   (3)--1.0--(9)</span>
<span class="go">   (6)--1.0--(12)</span>
<span class="go">   (5)--1.0--(11)</span>
<span class="go">   (4)--1.0--(10)</span>
<span class="go">   (2)--1.0--(8)</span>
<span class="go">   (1)--1.0--(7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.index">
<code class="descname">index</code><span class="sig-paren">(</span><em>value</em>, <em>start=1</em>, <em>stop=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first index of the specified Atom or Bond.</p>
<p>Providing an <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> will return its 1-based index, while a <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> returns a 2-tuple with the 1-based indices of its atoms.</p>
<p>Raises a <code class="xref py py-exc docutils literal notranslate"><span class="pre">MoleculeError</span></code> if the provided is not an Atom/Bond or if the Atom/bond is not part of the molecule.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span><span class="p">,</span> <span class="n">Bond</span><span class="p">,</span> <span class="n">Atom</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="p">:</span> <span class="n">Atom</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bond</span><span class="p">:</span> <span class="n">Bond</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">atom</span><span class="p">))</span>
<span class="go">1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">bond</span><span class="p">))</span>
<span class="go">(1, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.round_coords">
<code class="descname">round_coords</code><span class="sig-paren">(</span><em>decimals=0</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.round_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.round_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Round the Cartesian coordinates of this instance to <em>decimals</em>.</p>
<p>By default, with <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>, the coordinates of this instance are updated inplace.
If <code class="docutils literal notranslate"><span class="pre">inplace=False</span></code> then a new copy of this Molecule is returned with its
coordinates rounded.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         H      1.234567      0.000000      0.000000</span>
<span class="go">    2         H      0.000000      0.000000      0.000000</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_rounded</span> <span class="o">=</span> <span class="n">round_coords</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol_rounded</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         H      1.000000      0.000000      0.000000</span>
<span class="go">    2         H      0.000000      0.000000      0.000000</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">round_coords</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         H      1.234000      0.000000      0.000000</span>
<span class="go">    2         H      0.000000      0.000000      0.000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.get_connection_table">
<code class="descname">get_connection_table</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.get_connection_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.get_connection_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a connection table with atom indices (starting at 0)</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.get_molecule_indices">
<code class="descname">get_molecule_indices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.get_molecule_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.get_molecule_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the bond information to identify submolecules</p>
<p>Returns a list of lists of indices (e.g. for two methane molecules: [[0,1,2,3,4],[5,6,7,8,9]])</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.get_fragment">
<code class="descname">get_fragment</code><span class="sig-paren">(</span><em>indices</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.get_fragment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.get_fragment" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a submolecule from self</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.locate_rings">
<code class="descname">locate_rings</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.locate_rings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.locate_rings" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the rings in the structure</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.order_ring">
<code class="descname">order_ring</code><span class="sig-paren">(</span><em>ring_indices</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.order_ring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.order_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Order the ring indices so that they are sequential along the ring</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>vector</em>, <em>unit='angstrom'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Move the molecule in space by <em>vector</em>, expressed in <em>unit</em>.</p>
<p><em>vector</em> should be an iterable container of length 3 (usually tuple, list or numpy array). <em>unit</em> describes unit of values stored in <em>vector</em>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.rotate_lattice">
<code class="descname">rotate_lattice</code><span class="sig-paren">(</span><em>matrix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.rotate_lattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.rotate_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate <strong>only</strong> lattice vectors of the molecule with given rotation <em>matrix</em>.</p>
<p><em>matrix</em> should be a container with 9 numerical values. It can be a list (tuple, numpy array etc.) listing matrix elements row-wise, either flat (<code class="docutils literal notranslate"><span class="pre">[1,2,3,4,5,6,7,8,9]</span></code>) or in two-level fashion (<code class="docutils literal notranslate"><span class="pre">[[1,2,3],[4,5,6],[7,8,9]]</span></code>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method does not check if <em>matrix</em> is a proper rotation matrix.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>matrix</em>, <em>lattice=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the molecule with given rotation <em>matrix</em>. If <em>lattice</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, rotate lattice vectors too.</p>
<p><em>matrix</em> should be a container with 9 numerical values. It can be a list (tuple, numpy array etc.) listing matrix elements row-wise, either flat (<code class="docutils literal notranslate"><span class="pre">[1,2,3,4,5,6,7,8,9]</span></code>) or in two-level fashion (<code class="docutils literal notranslate"><span class="pre">[[1,2,3],[4,5,6],[7,8,9]]</span></code>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method does not check if <em>matrix</em> is a proper rotation matrix.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.align_lattice">
<code class="descname">align_lattice</code><span class="sig-paren">(</span><em>convention='AMS'</em>, <em>zero=1e-10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.align_lattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.align_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the molecule in such a way that lattice vectors are aligned with the coordinate system.</p>
<p>This method is meant to be used with periodic systems only. Using it on a <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instance with an empty <code class="docutils literal notranslate"><span class="pre">lattice</span></code> attribute has no effect.</p>
<p>Possible values of the <em>convention</em> argument are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">AMS</span></code> (default) – for 1D systems the lattice vector aligned with X axis. For 2D systems both lattice vectors aligned with XY plane. No constraints for 3D systems</li>
<li><code class="docutils literal notranslate"><span class="pre">reax</span></code> (convention used by <a class="reference external" href="https://www.scm.com/product/reaxff">ReaxFF</a>) – second lattice vector (if present) aligned with YZ plane. Third vector (if present) aligned with Z axis.</li>
</ul>
<p><em>zero</em> argument can be used to specify the numerical tolerance for zero (used to determine if some vector is already aligned with a particular axis or plane).</p>
<p>The returned boolean value indicates if any rotation happened.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.rotate_bond">
<code class="descname">rotate_bond</code><span class="sig-paren">(</span><em>bond</em>, <em>moving_atom</em>, <em>angle</em>, <em>unit='radian'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.rotate_bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.rotate_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate part of this molecule containing <em>moving_atom</em> along axis defined by <em>bond</em> by an <em>angle</em> expressed in <em>unit</em>.</p>
<p><em>bond</em> should be chosen in such a way, that it divides the molecule into two parts (using a bond that forms a ring results in a <code class="xref py py-exc docutils literal notranslate"><span class="pre">MoleculeError</span></code>). <em>moving_atom</em> has to belong to <em>bond</em> and is used to pick which part of the molecule is rotated. A positive angle denotes counterclockwise rotation (when looking along the bond, from the stationary part of the molecule).</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.resize_bond">
<code class="descname">resize_bond</code><span class="sig-paren">(</span><em>bond</em>, <em>moving_atom</em>, <em>length</em>, <em>unit='angstrom'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.resize_bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.resize_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the length of <em>bond</em> to <em>length</em> expressed in <em>unit</em> by moving part of the molecule containing <em>moving_atom</em></p>
<p><em>bond</em> should be chosen in such a way, that it divides the molecule into two parts (using a bond that forms a ring results in a <code class="xref py py-exc docutils literal notranslate"><span class="pre">MoleculeError</span></code>). <em>moving_atom</em> has to belong to <em>bond</em> and is used to pick which part of the molecule is moved.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.closest_atom">
<code class="descname">closest_atom</code><span class="sig-paren">(</span><em>point</em>, <em>unit='angstrom'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.closest_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.closest_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the atom of the molecule that is the closest one to some <em>point</em> in space.</p>
<p><em>point</em> should be an iterable container of length 3 (for example: tuple, <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>, list, numpy array). <em>unit</em> describes unit of values stored in <em>point</em>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.distance_to_point">
<code class="descname">distance_to_point</code><span class="sig-paren">(</span><em>point</em>, <em>unit='angstrom'</em>, <em>result_unit='angstrom'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.distance_to_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.distance_to_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the distance between the molecule and some <em>point</em> in space (distance between <em>point</em> and <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.closest_atom" title="scm.plams.mol.molecule.Molecule.closest_atom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">closest_atom()</span></code></a>).</p>
<p><em>point</em> should be an iterable container of length 3 (for example: tuple, <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>, list, numpy array). <em>unit</em> describes unit of values stored in <em>point</em>. Returned value is expressed in <em>result_unit</em>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.distance_to_mol">
<code class="descname">distance_to_mol</code><span class="sig-paren">(</span><em>other</em>, <em>result_unit='angstrom'</em>, <em>return_atoms=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.distance_to_mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.distance_to_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the distance between the molecule and some <em>other</em> molecule.</p>
<p>The distance is measured as the smallest distance between any atom of this molecule and any atom of <em>other</em> molecule. Returned distance is expressed in <em>result_unit</em>.</p>
<p>If <em>return_atoms</em> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, only a single number is returned.  If <em>return_atoms</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a tuple <code class="docutils literal notranslate"><span class="pre">(distance,</span> <span class="pre">atom1,</span> <span class="pre">atom2)</span></code> where <code class="docutils literal notranslate"><span class="pre">atom1</span></code> and <code class="docutils literal notranslate"><span class="pre">atom2</span></code> are atoms fulfilling the minimal distance, with atom1 belonging to this molecule and atom2 to <em>other</em>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.wrap">
<code class="descname">wrap</code><span class="sig-paren">(</span><em>self</em>, <em>length</em>, <em>angle=2*pi</em>, <em>length_unit='angstrom'</em>, <em>angle_unit='radian'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.wrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.wrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform the molecule wrapping its x-axis around z-axis. This method is useful for building nanotubes or molecular wedding rings.</p>
<p>Atomic coordinates are transformed in the following way:</p>
<ul class="simple">
<li>z coordinates remain untouched</li>
<li>x axis gets wrapped around the circle centered in the origin of new coordinate system. Each segment of x axis of length <em>length</em> ends up as an arc of a circle subtended by an angle <em>angle</em>. The radius of this circle is R = <em>length</em>/<em>angle</em>.</li>
<li>part of the plane between the x axis and the line y=R is transformed into the interior of the circle, with line y=R being squashed into a single point - the center of the circle.</li>
<li>part of the plane above line y=R is dropped</li>
<li>part of the plane below x axis is transformed into outside of the circle</li>
<li>transformation is done in such a way that distances along y axis are preserved</li>
</ul>
<p>Before:</p>
<img alt="../_images/wrap.png" src="../_images/wrap.png" />
<p>After:</p>
<img alt="../_images/wrap2.png" src="../_images/wrap2.png" />
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.get_center_of_mass">
<code class="descname">get_center_of_mass</code><span class="sig-paren">(</span><em>unit='angstrom'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.get_center_of_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.get_center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the center of mass of the molecule (as a tuple). Returned coordinates are expressed in <em>unit</em>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.get_mass">
<code class="descname">get_mass</code><span class="sig-paren">(</span><em>unit='amu'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.get_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.get_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mass of the molecule, by default in atomic mass units.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.get_density">
<code class="descname">get_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.get_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.get_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the density in kg/m^3</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.get_formula">
<code class="descname">get_formula</code><span class="sig-paren">(</span><em>as_dict=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.get_formula"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.get_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the molecular formula of the molecule according to the Hill system.</p>
<p>Here molecular formula is a dictionary with keys being atomic symbols. The value for each key is the number of atoms of that type. If <em>as_dict</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, that dictionary is returned. Otherwise, it is converted into a string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;Ubiquitin.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">get_formula</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
<span class="go">{&#39;N&#39;: 105, &#39;C&#39;: 378, &#39;O&#39;: 118, &#39;S&#39;: 1, &#39;H&#39;: 629}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">get_formula</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
<span class="go">C378H629N105O118S1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.apply_strain">
<code class="descname">apply_strain</code><span class="sig-paren">(</span><em>strain</em>, <em>voigt_form=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.apply_strain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.apply_strain" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a strain deformation to a periodic system (i.e. with a non-empty <code class="docutils literal notranslate"><span class="pre">lattice</span></code> attribute).
The atoms in the unit cell will be strained accordingly, keeping the fractional atomic coordinates constant.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">voigt_form=False</span></code>, <em>strain</em> should be a container with n*n numerical values, where n is the number of <code class="docutils literal notranslate"><span class="pre">lattice</span></code> vectors. It can be a list (tuple, numpy array etc.) listing matrix elements row-wise, either flat (e.g. <code class="docutils literal notranslate"><span class="pre">[e_xx,</span> <span class="pre">e_xy,</span> <span class="pre">e_xz,</span> <span class="pre">e_yx,</span> <span class="pre">e_yy,</span> <span class="pre">e_yz,</span> <span class="pre">e_zx,</span> <span class="pre">e_zy,</span> <span class="pre">e_zz]</span></code>) or in two-level fashion (e.g. <code class="docutils literal notranslate"><span class="pre">[[e_xx,</span> <span class="pre">e_xy,</span> <span class="pre">e_xz],[e_yx,</span> <span class="pre">e_yy,</span> <span class="pre">e_yz],[e_zx,</span> <span class="pre">e_zy,</span> <span class="pre">e_zz]]</span></code>).
If <code class="docutils literal notranslate"><span class="pre">voigt_form=True</span></code>, <em>strain</em> should be passed in voigt form (for 3D periodic systems: <code class="docutils literal notranslate"><span class="pre">[e_xx,</span> <span class="pre">e_yy,</span> <span class="pre">e_zz,</span> <span class="pre">gamma_yz,</span> <span class="pre">gamma_xz,</span> <span class="pre">gamma_xy]</span></code>; for 2D periodic systems: <code class="docutils literal notranslate"><span class="pre">[e_xx,</span> <span class="pre">e_yy,</span> <span class="pre">gamma_xy]</span></code>; for 1D periodic systems: <code class="docutils literal notranslate"><span class="pre">[e_xx]</span></code>  with e_xy = gamma_xy/2,…). Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graphene</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;graphene.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">graphene</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         C      0.000000      0.000000      0.000000</span>
<span class="go">    2         C      1.230000      0.710141      0.000000</span>
<span class="go">  Lattice:</span>
<span class="go">        2.4600000000     0.0000000000     0.0000000000</span>
<span class="go">        1.2300000000     2.1304224900     0.0000000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">graphene</span><span class="o">.</span><span class="n">apply_strain</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">voigt_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="go">  Atoms:</span>
<span class="go">    1         C      0.000000      0.000000      0.000000</span>
<span class="go">    2         C      1.353000      0.852169      0.000000</span>
<span class="go">  Lattice:</span>
<span class="go">        2.7060000000     0.0000000000     0.0000000000</span>
<span class="go">        1.3530000000     2.5565069880     0.0000000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.map_to_central_cell">
<code class="descname">map_to_central_cell</code><span class="sig-paren">(</span><em>around_origin=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.map_to_central_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.map_to_central_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps all atoms to the original cell. If <em>around_origin=True</em> the atoms will be mapped to the cell with fractional coordinates [-0.5,0.5], otherwise to the the cell in which all fractional coordinates are in the [0:1] interval.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.perturb_atoms">
<code class="descname">perturb_atoms</code><span class="sig-paren">(</span><em>max_displacement=0.01</em>, <em>unit='angstrom'</em>, <em>atoms=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.perturb_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.perturb_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly perturb the coordinates of the atoms in the molecule.</p>
<p>Each Cartesian coordinate is displaced by a random value picked out of a uniform distribution in the interval <em>[-max_displacement, +max_displacement]</em> (converted to requested <em>unit</em>).</p>
<p>By default, all atoms are perturbed. It is also possible to perturb only part of the molecule, indicated by <em>atoms</em> argument. It should be a list of atoms belonging to the molecule.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.perturb_lattice">
<code class="descname">perturb_lattice</code><span class="sig-paren">(</span><em>max_displacement=0.01</em>, <em>unit='angstrom'</em>, <em>ams_convention=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.perturb_lattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.perturb_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly perturb the lattice vectors.</p>
<p>The Cartesian components of the lattice vectors are changed by a random value picked out of a uniform distribution in the interval <em>[-max_displacement, +max_displacement]</em> (converted to requested <em>unit</em>).</p>
<p>If <em>ams_convention=True</em> then for 1D-periodic systems only the x-component of the lattice vector is perturbed, and for 2D-periodic systems only the xy-components of the lattice vectors are perturbed.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.substitute">
<code class="descname">substitute</code><span class="sig-paren">(</span><em>connector</em>, <em>ligand</em>, <em>ligand_connector</em>, <em>bond_length=None</em>, <em>steps=12</em>, <em>cost_func_mol=None</em>, <em>cost_func_array=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.substitute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.substitute" title="Permalink to this definition">¶</a></dt>
<dd><p>Substitute a part of this molecule with <em>ligand</em>.</p>
<p><em>connector</em> should be a pair of atoms that belong to this molecule and form a bond. The first atom of <em>connector</em> is the atom to which the  ligand will be connected. The second atom of <em>connector</em> is removed from the molecule, together with all “further” atoms connected to it (that allows, for example, to substitute the whole functional group with another). Using <em>connector</em> that is a part or a ring triggers an exception.</p>
<p><em>ligand_connector</em> is a <em>connector</em> analogue, but for <em>ligand</em>. IT describes the bond in the <em>ligand</em> that will be connected with the bond in this molecule descibed by <em>connector</em>.</p>
<p>If this molecule or <em>ligand</em> don’t have any bonds, <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.guess_bonds" title="scm.plams.mol.molecule.Molecule.guess_bonds"><code class="xref py py-meth docutils literal notranslate"><span class="pre">guess_bonds()</span></code></a> is used.</p>
<p>After removing all unneeded atoms, the <em>ligand</em> is translated to a new position, rotated, and connected by bond with the core molecule. The new <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> is added between the first atom of <em>connector</em> and the first atom of <em>ligand_connector</em>. The length of that bond can be adjusted with <em>bond_length</em> argument, otherwise the default is the sum of atomic radii taken from <a class="reference internal" href="utils.html#scm.plams.tools.periodic_table.PeriodicTable" title="scm.plams.tools.periodic_table.PeriodicTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeriodicTable</span></code></a>.</p>
<p>Then the <em>ligand</em> is rotated along newly created bond to find the optimal position. The full 360 degrees angle is divided into <em>steps</em> equidistant rotations and each such rotation is evaluated using a cost function. The orientation with the minimal cost is chosen.</p>
<p>The default cost function is:</p>
<div class="math notranslate nohighlight">
\[\sum_{i \in mol, j\in lig} e^{-R_{ij}}\]</div>
<p>A different cost function can be also supplied by the user, using one of the two remaining arguments: <em>cost_func_mol</em> or <em>cost_func_array</em>. <em>cost_func_mol</em> should be a function that takes two <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instances: this molecule (after removing unneeded atoms) and ligand in a particular orientation (also without unneeded atoms) and returns a single number (the lower the number, the better the fit). <em>cost_func_array</em> is analogous, but instead of <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instances it takes two numpy arrays (with dimensions: number of atoms x 3) with coordinates of this molecule and the ligand. If both are supplied, <em>cost_func_mol</em> takes precedence over <em>cost_func_array</em>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__repr__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__len__">
<code class="descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__len__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>The length of the molecule is the number of atoms.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__str__">
<code class="descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__str__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return str(self).</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.str">
<code class="descname">str</code><span class="sig-paren">(</span><em>decimal=6</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.str" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string representation of the molecule.</p>
<p>Information about atoms is printed in <code class="docutils literal notranslate"><span class="pre">xyz</span></code> format fashion – each atom in a separate, enumerated line. Then, if the molecule contains any bonds, they are printed. Each bond is printed in a separate line, with information about both atoms and bond order. Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Atoms:
  1         N       0.00000       0.00000       0.38321
  2         H       0.94218       0.00000      -0.01737
  3         H      -0.47109       0.81595      -0.01737
  4         H      -0.47109      -0.81595      -0.01737
Bonds:
  (1)----1----(2)
  (1)----1----(3)
  (1)----1----(4)
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__iter__">
<code class="descname">__iter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__iter__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over atoms.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>The bracket notation can be used to access atoms or bonds directly.</p>
<p>If <em>key</em> is a single int (<code class="docutils literal notranslate"><span class="pre">mymol[i]</span></code>), return i-th atom of the molecule. If <em>key</em> is a pair of ints (<code class="docutils literal notranslate"><span class="pre">mymol[(i,j)]</span></code>), return the bond between i-th and j-th atom (<code class="docutils literal notranslate"><span class="pre">None</span></code> if such a bond does not exist). Negative integers can be used to access atoms enumerated in the reversed order.</p>
<p>This notation is read only: things like <code class="docutils literal notranslate"><span class="pre">mymol[3]</span> <span class="pre">=</span> <span class="pre">Atom(...)</span></code> are forbidden.</p>
<p>Numbering of atoms within a molecule starts with 1.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__add__">
<code class="descname">__add__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__add__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new molecule that is a sum of this molecule and some <em>other</em> molecule:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">newmol</span> <span class="o">=</span> <span class="n">mol1</span> <span class="o">+</span> <span class="n">mol2</span>
</pre></div>
</div>
<p>The new molecule has atoms, bonds and all other elements distinct from both components. The <code class="docutils literal notranslate"><span class="pre">properties</span></code> of <code class="docutils literal notranslate"><span class="pre">newmol</span></code> are a copy of the <code class="docutils literal notranslate"><span class="pre">properties</span></code> of <code class="docutils literal notranslate"><span class="pre">mol1</span></code> <a class="reference internal" href="settings.html#scm.plams.core.settings.Settings.soft_update" title="scm.plams.core.settings.Settings.soft_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">soft_updated</span></code></a> with the <code class="docutils literal notranslate"><span class="pre">properties</span></code> of <code class="docutils literal notranslate"><span class="pre">mol2</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__iadd__">
<code class="descname">__iadd__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__iadd__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__iadd__" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy <em>other</em> molecule and add the copy to this one.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__round__">
<code class="descname">__round__</code><span class="sig-paren">(</span><em>ndigits=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__round__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__round__" title="Permalink to this definition">¶</a></dt>
<dd><p>Magic method for rounding this instance’s Cartesian coordinates; called by the builtin <a class="reference external" href="https://docs.python.org/3.6/library/functions.html#round" title="(in Python v3.6)"><code class="xref py py-func docutils literal notranslate"><span class="pre">round()</span></code></a> function.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__getstate__">
<code class="descname">__getstate__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__getstate__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__getstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object which is to-be pickled by, <em>e.g.</em>, <a class="reference external" href="https://docs.python.org/3.6/library/pickle.html#pickle.dump" title="(in Python v3.6)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pickle.dump()</span></code></a>.
As <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instances are heavily nested objects,
pickling them can raise a <a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#RecursionError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RecursionError</span></code></a>.
This issue is herein avoided relying on the <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.as_dict" title="scm.plams.mol.molecule.Molecule.as_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.as_dict()</span></code></a> method.
See <a class="reference external" href="https://docs.python.org/3/library/pickle.html#pickling-class-instances">Pickling Class Instances</a>
for more details.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__setstate__">
<code class="descname">__setstate__</code><span class="sig-paren">(</span><em>state: dict</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__setstate__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__setstate__" title="Permalink to this definition">¶</a></dt>
<dd><p>Counterpart of <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.__getstate__" title="scm.plams.mol.molecule.Molecule.__getstate__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.__getstate__()</span></code></a>; used for unpickling molecules.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Store all information about the molecule in a dictionary.</p>
<p>The returned dictionary is, in principle, identical to <code class="docutils literal notranslate"><span class="pre">self.__dict__</span></code> of the current instance, apart from the fact that all <a class="reference internal" href="atombond.html#scm.plams.mol.atom.Atom" title="scm.plams.mol.atom.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> and <a class="reference internal" href="atombond.html#scm.plams.mol.bond.Bond" title="scm.plams.mol.bond.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> instances in <code class="docutils literal notranslate"><span class="pre">atoms</span></code> and <code class="docutils literal notranslate"><span class="pre">bonds</span></code> lists are replaced with dictionaries storing corresponing information.</p>
<p>This method is a counterpart of <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.from_dict" title="scm.plams.mol.molecule.Molecule.from_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_dict()</span></code></a>.</p>
</dd></dl>

<dl class="classmethod">
<dt id="scm.plams.mol.molecule.Molecule.from_dict">
<em class="property">classmethod </em><code class="descname">from_dict</code><span class="sig-paren">(</span><em>dictionary</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a new <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instance based on the information stored in a <em>dictionary</em>.</p>
<p>This method is a counterpart of <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.as_dict" title="scm.plams.mol.molecule.Molecule.as_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_dict()</span></code></a>.</p>
</dd></dl>

<dl class="classmethod">
<dt id="scm.plams.mol.molecule.Molecule.from_elements">
<em class="property">classmethod </em><code class="descname">from_elements</code><span class="sig-paren">(</span><em>elements</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.from_elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.from_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a new <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instance based on a list of <em>elements</em>.</p>
<p>By default it sets all coordinates to zero</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.as_array">
<code class="descname">as_array</code><span class="sig-paren">(</span><em>atom_subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.as_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.as_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return cartesian coordinates of this molecule’s atoms as a numpy array.</p>
<p><em>atom_subset</em> argument can be used to specify only a subset of atoms, it should be an iterable container with atoms belonging to this molecule.</p>
<p>Returned value is a n*3 numpy array where n is the number of atoms in the whole molecule, or in <em>atom_subset</em>, if used.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.from_array">
<code class="descname">from_array</code><span class="sig-paren">(</span><em>xyz_array</em>, <em>atom_subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.from_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.from_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the cartesian coordinates of this <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>, containing n atoms, with coordinates provided by a (≤n)*3 numpy array <em>xyz_array</em>.</p>
<p><em>atom_subset</em> argument can be used to specify only a subset of atoms, it should be an iterable container with atoms belonging to this molecule. It should have the same length as the first dimenstion of <em>xyz_array</em>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.__array__">
<code class="descname">__array__</code><span class="sig-paren">(</span><em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.__array__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.__array__" title="Permalink to this definition">¶</a></dt>
<dd><p>A magic method for constructing numpy arrays.</p>
<p>This method ensures that passing a <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instance to <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html">numpy.array</a> produces an array of Cartesian coordinates (see <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.as_array" title="scm.plams.mol.molecule.Molecule.as_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Molecule.as_array()</span></code></a>).
The array <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html">data type</a> can, optionally, be specified in <em>dtype</em>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.readxyz">
<code class="descname">readxyz</code><span class="sig-paren">(</span><em>f</em>, <em>geometry=1</em>, <em>**other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.readxyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.readxyz" title="Permalink to this definition">¶</a></dt>
<dd><p>XYZ Reader:</p>
<p>The xyz format allows to store more than one geometry of a particular molecule within a single file.
In such cases the <em>geometry</em> argument can be used to indicate which (in order of appearance in the file) geometry to import.
Default is the first one (<em>geometry</em> = 1).</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.readpdb">
<code class="descname">readpdb</code><span class="sig-paren">(</span><em>f</em>, <em>geometry=1</em>, <em>**other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.readpdb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.readpdb" title="Permalink to this definition">¶</a></dt>
<dd><p>PDB Reader:</p>
<p>The pdb format allows to store more than one geometry of a particular molecule within a single file.
In such cases the <em>geometry</em> argument can be used to indicate which (in order of appearance in the file) geometry to import.
The default is the first one (<em>geometry</em> = 1).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="scm.plams.mol.molecule.Molecule._mol_from_rkf_section">
<em class="property">static </em><code class="descname">_mol_from_rkf_section</code><span class="sig-paren">(</span><em>sectiondict</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule._mol_from_rkf_section"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule._mol_from_rkf_section" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instance constructed from the contents of the whole <code class="docutils literal notranslate"><span class="pre">.rkf</span></code> file section, supplied as a dictionary returned by <a class="reference internal" href="../interfaces/kffiles.html#scm.plams.tools.kftools.KFFile.read_section" title="scm.plams.tools.kftools.KFFile.read_section"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KFFile.read_section</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.readin">
<code class="descname">readin</code><span class="sig-paren">(</span><em>f</em>, <em>**other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.readin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.readin" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a file containing a System block used in AMS driver input files.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.writein">
<code class="descname">writein</code><span class="sig-paren">(</span><em>f</em>, <em>**other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.writein"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.writein" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the Molecule instance to a file as a System block from the AMS driver input files.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em>, <em>inputformat=None</em>, <em>**other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read molecular coordinates from a file.</p>
<p><em>filename</em> should be a string with a path to a file. If <em>inputformat</em> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it should be one of supported formats or engines (keys occurring in the class attribute <code class="docutils literal notranslate"><span class="pre">_readformat</span></code>). Otherwise, the format is deduced from the file extension. For files without an extension the <cite>xyz</cite> format is used.</p>
<p>All <em>other</em> options are passed to the chosen format reader.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>outputformat=None</em>, <em>mode='w'</em>, <em>**other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write molecular coordinates to a file.</p>
<p><em>filename</em> should be a string with a path to a file. If <em>outputformat</em> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it should be one of supported formats or engines (keys occurring in the class attribute <code class="docutils literal notranslate"><span class="pre">_writeformat</span></code>). Otherwise, the format is deduced from the file extension. For files without an extension the <cite>xyz</cite> format is used.</p>
<p><em>mode</em> can be either ‘w’ (overwrites the file if the file exists) or ‘a’ (appends to the file if the file exists).</p>
<p>All <em>other</em> options are passed to the chosen format writer.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.add_hatoms">
<code class="descname">add_hatoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; scm.plams.mol.molecule.Molecule<a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.add_hatoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.add_hatoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds missing hydrogen atoms to the current molecule.
Returns a new Molecule instance.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">atnum</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         O      0.000000       0.000000       0.000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h2o</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">add_hatoms</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">h2o</span><span class="p">)</span>
<span class="go">  Atoms:</span>
<span class="go">    1         O      0.000000       0.000000       0.000000</span>
<span class="go">    2         H     -0.109259       0.893161       0.334553</span>
<span class="go">    3         H      0.327778       0.033891      -0.901672</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="scm.plams.mol.molecule.Molecule.rmsd">
<em class="property">static </em><code class="descname">rmsd</code><span class="sig-paren">(</span><em>mol1</em>, <em>mol2</em>, <em>return_rotmat=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/molecule.html#Molecule.rmsd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the
<a class="reference external" href="https://en.wikipedia.org/wiki/Kabsch_algorithm">Kabsch algorithm</a> to align and
calculate the root-mean-square deviation of two systems’ atomic positions.</p>
<p>Assumes all elements and their order is the same in both systems, will check this if <cite>check == True</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>rmsd <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>Root-mean-square-deviation of atomic coordinates</dd>
<dt>rotmat <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd>If <cite>return_rotmat</cite> is <cite>True</cite>, will additionally return the rotation matrix
that aligns <cite>mol2</cite> onto <cite>mol1</cite>.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.assign_chirality">
<code class="descname">assign_chirality</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.assign_chirality" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns stereo-info to PLAMS molecule by invoking RDKIT</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.find_permutation">
<code class="descname">find_permutation</code><span class="sig-paren">(</span><em>other</em>, <em>level=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.find_permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder atoms in this molecule to match the order in some <em>other</em> molecule. The reordering is applied only if the perfect match is found. Returned value is the applied permutation (as a list of integers) or <code class="docutils literal notranslate"><span class="pre">None</span></code>, if no reordering was performed. See also <code class="xref py py-func docutils literal notranslate"><span class="pre">find_permutation()</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.get_chirality">
<code class="descname">get_chirality</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.get_chirality" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the chirality of the atoms</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.label">
<code class="descname">label</code><span class="sig-paren">(</span><em>level=1</em>, <em>keep_labels=False</em>, <em>flags=None</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the label of this molecule using chosen <em>level</em> of detail.</p>
<p>Possible levels are:</p>
<ul class="simple">
<li><strong>0</strong>: does not pefrom any atom labeling, returns empirical formula (see <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.get_formula" title="scm.plams.mol.molecule.Molecule.get_formula"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_formula()</span></code></a>)</li>
<li><strong>1</strong>: only direct connectivity is considered, without bond orders (in other words, treats all the bonds as single bonds)</li>
<li><strong>2</strong>: use connectivity and bond orders</li>
<li><strong>3</strong>: use connectivity, bond orders and some spatial information to distinguish R/S and E/Z isomers</li>
<li><strong>4</strong>: use all above, plus more spatial information to distinguish different rotamers and different types of coordination complexes</li>
</ul>
<p>If you need more precise control of what is taken into account while computing the label (or adjust the tolerance for geometrical operations) you can use the <em>flags</em> argument. It should be a dictionary of parameters recognized by <a class="reference internal" href="#scm.plams.mol.identify.label_atoms" title="scm.plams.mol.identify.label_atoms"><code class="xref py py-func docutils literal notranslate"><span class="pre">label_atoms()</span></code></a>. Each of two letter boolean flags has to be present in <em>flags</em>. If you use <em>flags</em>, <em>level</em> is ignored.</p>
<p>The <em>level</em> argument can also be a tuple of integers. In that case the labeling algorithm is run multiple times and the returned value is a tuple (with the same length as <em>level</em>) containing labels calculated with given levels of detail.</p>
<p>This function, by default, erases <code class="docutils literal notranslate"><span class="pre">IDname</span></code> attributes of all atoms at the end. You can change this behavior with <em>keep_labels</em> argument.</p>
<p>If the molecule does not contain bonds, <a class="reference internal" href="#scm.plams.mol.molecule.Molecule.guess_bonds" title="scm.plams.mol.molecule.Molecule.guess_bonds"><code class="xref py py-meth docutils literal notranslate"><span class="pre">guess_bonds()</span></code></a> is used to determine them.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method is a new PLAMS feature and its still somewhat experimental. The exact details of the algorithm can, and probably will, change in future. You are more than welcome to provide any feedback or feature requests.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="scm.plams.mol.molecule.Molecule.numbers">
<code class="descname">numbers</code><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of all atomic numbers in the Molecule. Can also be used to set all numbers at once.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.readase">
<code class="descname">readase</code><span class="sig-paren">(</span><em>f</em>, <em>**other</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.readase" title="Permalink to this definition">¶</a></dt>
<dd><p>Read Molecule using ASE engine</p>
<p>The <code class="docutils literal notranslate"><span class="pre">read</span></code> function of the <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> class passes a file descriptor into here, so in this case you must specify the <em>format</em> to be read by ASE:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;file.cif&#39;</span><span class="p">,</span> <span class="n">inputformat</span><span class="o">=</span><span class="s1">&#39;ase&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;cif&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The ASE Atoms object then gets converted to a PLAMS Molecule and returned.
All <em>other</em> options are passed to <code class="docutils literal notranslate"><span class="pre">ASE.io.read()</span></code>.
See <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/io/io.html">https://wiki.fysik.dtu.dk/ase/ase/io/io.html</a> on how to use it.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The nomenclature of PLAMS and ASE is incompatible for reading multiple geometries, make sure that you only read single geometries with ASE! Reading multiple geometries is not supported, each geometry needs to be read individually.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.set_local_labels">
<code class="descname">set_local_labels</code><span class="sig-paren">(</span><em>niter=2</em>, <em>flags=None</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.set_local_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Set atomic labels (IDnames) that are unique for local structures of a molecule</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">niter</span></code> – The number of iterations in the atom labeling scheme</li>
</ul>
<p>The idea of this method is that the number of iterations can be specified.
If kept low (default niter), local structures over different molecules will have the same label.</p>
</dd></dl>

<dl class="method">
<dt id="scm.plams.mol.molecule.Molecule.writease">
<code class="descname">writease</code><span class="sig-paren">(</span><em>f</em>, <em>**other</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.writease" title="Permalink to this definition">¶</a></dt>
<dd><p>Write molecular coordinates using ASE engine.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">write</span></code> function of the <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> class passes a file descriptor into here, so in this case you must specify the <em>format</em> to be written by ASE.
All <em>other</em> options are passed to <code class="docutils literal notranslate"><span class="pre">ASE.io.write()</span></code>.
See <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/io/io.html">https://wiki.fysik.dtu.dk/ase/ase/io/io.html</a> on how to use it.</p>
<p>These two write the same content to the respective files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;filename.anyextension&#39;</span><span class="p">,</span> <span class="n">outputformat</span><span class="o">=</span><span class="s1">&#39;ase&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;gen&#39;</span><span class="p">)</span>
<span class="n">molecule</span><span class="o">.</span><span class="n">writease</span><span class="p">(</span><span class="s1">&#39;filename.anyextension&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;gen&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="scm.plams.mol.molecule.Molecule.symbols">
<code class="descname">symbols</code><a class="headerlink" href="#scm.plams.mol.molecule.Molecule.symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of all atomic symbols in the Molecule. Can also be used to set all symbols at once.</p>
</dd></dl>

</dd></dl>

<div class="section" id="atom-labeling">
<h2>Atom labeling<a class="headerlink" href="#atom-labeling" title="Permalink to this headline">¶</a></h2>
<p>This subsection describes API of <code class="docutils literal notranslate"><span class="pre">identify</span></code> module, which is used to assign unique names to atoms in a molecule.
Unique atom names are used in <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> labeling (<a class="reference internal" href="#scm.plams.mol.molecule.Molecule.label" title="scm.plams.mol.molecule.Molecule.label"><code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code></a>).
.. and in the method restoring the order of atoms (<code class="xref py py-meth docutils literal notranslate"><span class="pre">reorder()</span></code>).
All the functions below, apart from <a class="reference internal" href="#scm.plams.mol.identify.label_atoms" title="scm.plams.mol.identify.label_atoms"><code class="xref py py-func docutils literal notranslate"><span class="pre">label_atoms()</span></code></a>, are for internal use and they are not visible in the main PLAMS namespace.</p>
<dl class="function">
<dt id="scm.plams.mol.identify.label_atoms">
<code class="descname">label_atoms</code><span class="sig-paren">(</span><em>molecule</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#label_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.label_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Label atoms in <em>molecule</em>.</p>
<p>Boolean keyword arguments:</p>
<ul class="simple">
<li><em>BO</em> – include bond orders</li>
<li><em>RS</em> – include R/S stereoisomerism</li>
<li><em>EZ</em> – include E/Z stereoisomerism</li>
<li><em>DH</em> – include some dihedrals to detect alkane rotamers and syn-anti conformers in cycloalkanes</li>
<li><em>CO</em> – include more spatial info to detect different conformation of coordination complexes (flat square, octaedr etc.)</li>
</ul>
<p>Numerical keyword arguments:</p>
<ul class="simple">
<li><em>twist_tol</em> – tolerance for <a class="reference internal" href="#scm.plams.mol.identify.twist" title="scm.plams.mol.identify.twist"><code class="xref py py-func docutils literal notranslate"><span class="pre">twist()</span></code></a> function</li>
<li><em>bend_tol</em> – tolerance for <a class="reference internal" href="#scm.plams.mol.identify.bend" title="scm.plams.mol.identify.bend"><code class="xref py py-func docutils literal notranslate"><span class="pre">bend()</span></code></a> function</li>
</ul>
<p>Diherdals considered with <em>DH</em> are all the dihedrals A-B-C-D such that A is a unique neighbor or B and D is a unique neighbor of C.</p>
<p>For atoms with 4 or more neighbors, the <em>CO</em> flag includes information about relative positions of equivalent/non-equivalent neighbors by checking if vectors from the central atom to the neighbors form 90 or 180 degrees angles.</p>
</dd></dl>

<dl class="function">
<dt id="scm.plams.mol.identify.molecule_name">
<code class="descname">molecule_name</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#molecule_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.molecule_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the label of the whole <em>molecule</em> based on <code class="docutils literal notranslate"><span class="pre">IDname</span></code> attributes of all the atoms.</p>
</dd></dl>

<dl class="function">
<dt id="scm.plams.mol.identify.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize atom labeling algorithm by setting <code class="docutils literal notranslate"><span class="pre">IDname</span></code> and <code class="docutils literal notranslate"><span class="pre">IDdone</span></code> attributes for all atoms in <em>molecule</em>.</p>
</dd></dl>

<dl class="function">
<dt id="scm.plams.mol.identify.iterate">
<code class="descname">iterate</code><span class="sig-paren">(</span><em>molecule</em>, <em>flags</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#iterate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform one iteration of atom labeling alogrithm.</p>
<p>First, mark all atoms that are unique and have only unique neighbors as “done”. Then calculate new label for each atom that is not done. Return True if the number of different atom labels increased during this iteration.</p>
</dd></dl>

<dl class="function">
<dt id="scm.plams.mol.identify.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove <code class="docutils literal notranslate"><span class="pre">IDname</span></code> and <code class="docutils literal notranslate"><span class="pre">IDdone</span></code> attributes from all atoms in <em>molecule</em>.</p>
</dd></dl>

<dl class="function">
<dt id="scm.plams.mol.identify.new_name">
<code class="descname">new_name</code><span class="sig-paren">(</span><em>atom</em>, <em>flags</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#new_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.new_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute new label for <em>atom</em>.</p>
<p>The new label is based on the existing label of <em>atom</em>, labels of all its neighbors and (possibly) some additional conformational information. The labels of neighbors are not obtained directly by reading neighbor’s <code class="docutils literal notranslate"><span class="pre">IDname</span></code> but rather by a process called “knocking”. The <em>atom</em> knocks all its bonds. Each knocked bond returns an identifier describing the atom on the other end of the bond. The identifier is composed of knocked atom’s <code class="docutils literal notranslate"><span class="pre">IDname</span></code> together with some additional information desribing the character of the bond and knocked atom’s spatial environment. The exact behavior of this mechanism is adjusted by the contents of <em>flags</em> dictionary (see <a class="reference internal" href="#scm.plams.mol.identify.label_atoms" title="scm.plams.mol.identify.label_atoms"><code class="xref py py-func docutils literal notranslate"><span class="pre">label_atoms()</span></code></a> for details).</p>
</dd></dl>

<dl class="function">
<dt id="scm.plams.mol.identify.knock">
<code class="descname">knock</code><span class="sig-paren">(</span><em>A</em>, <em>bond</em>, <em>flags</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#knock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.knock" title="Permalink to this definition">¶</a></dt>
<dd><p>Atom <em>A</em> knocks one of its bonds.</p>
<p><em>bond</em> has to be a bond formed by atom <em>A</em>. The other end of this bond (atom S) returns its description, consisting of its <code class="docutils literal notranslate"><span class="pre">IDname</span></code> plus, possibly, some additional information. If <em>BO</em> flag is set, the description includes the bond order of <em>bond</em>. If <em>EZ</em> flag is set, the description includes additional bit of information whenever E/Z isomerism is possible. If <em>DH</em> flag is set, the description includes additional information for all dihedrals A-S-N-F such that A is a unique neighbor of S and F is a unique neighbor of N.</p>
</dd></dl>

<dl class="function">
<dt id="scm.plams.mol.identify.twist">
<code class="descname">twist</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em>, <em>v3</em>, <em>tolerance=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#twist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.twist" title="Permalink to this definition">¶</a></dt>
<dd><p>Given 3 vectors in 3D space measure their “chirality” with <em>tolerance</em>.</p>
<p>Returns a pair. The first element is an integer number measuring the orientation (clockwise vs counterclockwise) of <em>v1</em> and <em>v3</em> while looking along <em>v2</em>. Values 1 and -1 indicate this case and the second element of returned pair is <code class="docutils literal notranslate"><span class="pre">None</span></code>. Value 0 indicates that <em>v1</em>, <em>v2</em>, and <em>v3</em> are coplanar, and the second element of the returned pair is indicating if two turns made by going <em>v1</em>-&gt;*v2*-&gt;*v3* are the same (left-left, right-right) or the opposite (left-right, right-left).</p>
</dd></dl>

<dl class="function">
<dt id="scm.plams.mol.identify.bend">
<code class="descname">bend</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em>, <em>tolerance=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#bend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.bend" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if two vectors in 3D space are parallel or perpendicular, with <em>tolerance</em> (in degrees).</p>
<p>Returns 1 if <em>v1</em> and <em>v2</em> are collinear, 2 if they are perpendicular, 0 otherwise.</p>
</dd></dl>

<dl class="function">
<dt id="scm.plams.mol.identify.unique_atoms">
<code class="descname">unique_atoms</code><span class="sig-paren">(</span><em>atomlist</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scm/plams/mol/identify.html#unique_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scm.plams.mol.identify.unique_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter <em>atomlist</em> (list or <a class="reference internal" href="#scm.plams.mol.molecule.Molecule" title="scm.plams.mol.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>) for atoms with unique <code class="docutils literal notranslate"><span class="pre">IDname</span></code>.</p>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <!--STARTNOSOLR-->
<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="atombond.html" class="btn btn-neutral float-right" title="Atom" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="molecule.html" class="btn btn-neutral" title="Molecule" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/> 

<!-- start :: footer -->
		<footer class="site-footer block">
			<div class="container">
				<div class="row">
					<div class="footer-column" >
	<ul>
		<li id="nav_menu-2" class="widget widget_nav_menu "><h3>Application Areas</h3><div class="menu-application-areas-container"><ul id="menu-application-areas" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/batteries/">Batteries &#038; PVs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/chemical-bonding-analysis/">Bonding Analysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/catalysis/">Catalysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/heavy-elements/">Heavy Elements</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/inorganic-chemistry/">Inorganic Chemistry</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/pharma/">Life Sciences</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/materials-science/">Materials Science</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/nanotechnology/">Nanotechnology</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/oil-and-gas/">Oil and Gas</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/organic-electronics/">Organic Electronics</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/polymers/">Polymers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/spectroscopy/">Spectroscopy</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/teaching/">Teaching</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-7" class="widget widget_nav_menu "><h3>Products</h3><div class="menu-product-navigation-container"><ul id="menu-product-navigation" class="menu">
<li id="menu-item-40263" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40263"><a href="https://www.scm.com/product/ams/">AMS Driver</a></li>
<li id="menu-item-7235" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7235"><a href="https://www.scm.com/product/adf/">ADF</a></li>
<li id="menu-item-7236" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7236"><a href="https://www.scm.com/product/band_periodicdft/">BAND</a></li>
<li id="menu-item-7237" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7237"><a href="https://www.scm.com/product/cosmo-rs/">COSMO-RS</a></li>
<li id="menu-item-7238" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7238"><a href="https://www.scm.com/product/dftb/">DFTB</a></li>
<li id="menu-item-7239" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7239"><a href="https://www.scm.com/product/gui/">GUI</a></li>
<li id="menu-item-44383" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-44383"><a href="https://www.scm.com/product/machine-learning-potentials/">MLPotential</a></li>
<li id="menu-item-7240" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7240"><a href="https://www.scm.com/product/mopac/">MOPAC</a></li>
<li id="menu-item-40262" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40262"><a href="https://www.scm.com/product/plams/">PLAMS</a></li>
<li id="menu-item-43701" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-43701"><a href="https://www.scm.com/product/quantum-espresso/">Quantum ESPRESSO</a></li>
<li id="menu-item-7241" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7241"><a href="https://www.scm.com/product/reaxff/">ReaxFF</a></li></ul></div></li><li id="nav_menu-26" class="widget widget_nav_menu "><div class="menu-licensing-container"><ul id="menu-licensing" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/">Pricing &#038; Licensing</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/">Price Quote</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/calculate-your-price/">Price Calculator</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/consulting/">Scientific Consulting</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/adf-resellers/">Resellers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/scm-license-terms/">License Terms</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/ordering-procedure/">Ordering</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-6" class="widget widget_nav_menu "><h3>Support</h3><div class="menu-support-navigation-container"><ul id="menu-support-navigation" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/">Support Overview</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-installation-videos/">Installation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-tutorials-and-manuals/">Documentation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/doc/Tutorials/GUI_overview/GUI_overview_tutorials.html">GUI Tutorials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/downloads/">Downloads</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/faq/">FAQs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/adf-discussion-list/">Discussion List</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/documentation-previous-versions/release-notes/">Release Notes</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/adf-teaching-materials/">Teaching Materials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/adf-hands-on-workshops/">Workshops</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/web-presentations-by-adf-experts/">Webinars</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/videos-tutorials-and-web-presentations/">Videos</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/brochures/">Brochure</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/amsterdam-modeling-suite/research-papers-citing-adf/">Papers Citing ADF</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/highlights/">Literature Highlights</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-28" class="widget widget_nav_menu "><h3>About Us</h3><div class="menu-about-us-container"><ul id="menu-about-us" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/contact-us/">Contact Us</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/eu-projects/">EU Projects</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-authors/">Contributors</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-people/">The SCM Team</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/collaborations/">Collaborations</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/careers/">Careers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/mission-vision/">Mission &#038; Vision</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/newsletters/">Newsletters</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/news/">News</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/">Events</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
			</ul>
</div>				</div>
			</div>
		</footer>
		<footer class="disclaimer-footer">
			<img src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="">
			<nav class="menu-service-navigation-container"><ul id="menu-service-navigation" class="menu-service navbar-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-73"><a href="https://www.scm.com/copyright/">Copyright</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72"><a href="https://www.scm.com/terms-of-use/">Terms of Use</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-71"><a href="https://www.scm.com/privacy-policy/">Privacy Policy</a></li>
</ul></nav></footer>	
		<!-- end :: footer -->

<!--ENDNOSOLR-->
        </div>
      </div>

    </section>
  </div>
  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2021.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCRWHZZ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/../../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>