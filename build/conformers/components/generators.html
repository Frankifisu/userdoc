

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
<META name="ROBOTS" content="NOINDEX, NOFOLLOW">
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.2. Generators &mdash; AMSConformers 2021.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme_tabs.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/panels-bootstrap.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="AMSConformers 2021.1 documentation" href="../index.html"/>
        <link rel="up" title="2. Components" href="components.html"/>
        <link rel="next" title="2.3. ConformerOptimizer" href="optimizer.html"/>
        <link rel="prev" title="2.1. Conformers" href="conformers.html"/> 

  
  <script src="../_static/js/jquery.min.js"></script>
  <script src="../_static/js/bootstrap.min.js"></script>
  <script src="../_static/js/modernizr.min.js"></script>
  <script src="../_static/js/app.js"></script>
<script type="text/javascript">
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NCRWHZZ');</script>
<!-- End Google Tag Manager -->

</head>

<body class="wy-body-for-nav" role="document">
  <!--STARTNOSOLR-->
  <header class="site-header navbar-fixed-top compact">
      <nav class="main navbar navbar-default">
        <div class="headerbar_container">
          <a role="button" href="/free-trial/" class="btn btn-sm btn-primary">Free trial</a>
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div class="navbar-brand">
              <a class="logo" href="https://www.scm.com">
                <img class="logo-small" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="Software for Chemistry &amp; Materials" />
                <img class="logo-full" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo.svg" alt="Software for Chemistry &amp; Materials" />
              </a>
            </div>
          </div>
          <div class="nav-wrapper">
            <div class="collapse navbar-collapse">
              <ul id="menu-primary-navigation" class="nav navbar-nav"><li id="menu-item-40077" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-40077"><a title="Applications" href="https://www.scm.com/applications/">Applications</a></li>
<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a title="Products" href="https://www.scm.com/amsterdam-modeling-suite/">Products</a></li>
<li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36"><a title="Support" href="https://www.scm.com/support/">Support</a></li>
<li id="menu-item-37" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37"><a title="About us" href="https://www.scm.com/about-us/">About us</a></li>
</ul>                           <span class="search"><a class="menu_search_link" href="https://www.scm.com/search.php"></a><span class="sr-only">Search</span></span>
            </div>
          </div>
        </div>
      </nav>
 </header>
    

   
  <div id="doc-wrapper">
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          

          
          </a>

          
          
  <ul>
      <li class="wy-breadcrumbs-aside">
        
           
           
        
      </li>
  </ul>
 
<!--ENDNOSOLR-->
             <!--STARTNOSOLR-->
<div role="search">
  <form id="rtd-search-form" class="wy-form search-docs-form" action="https://www.scm.com/search.php" method="get">
  <div class="input-group">
    <input type="text" name="search" placeholder="Search AMSConformers" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <input type="hidden" name="root" value="doctrunk" />


    <input type="hidden" name="cat" value="doc-AMSConformers" />


    <span class="input-group-btn">
			<button type="submit" class="btn btn-primary"><span class="sr-only">Search</span><span class="fa fa-search"></span></button>
		</span>
	</div>
  </form>
</div>
<!--ENDNOSOLR-->
          

          
        </div>
<!--STARTNOSOLR-->
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">1. AMSConformers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#python-library-for-conformer-generation">1.1. Python library for conformer generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#simple-example">1.2. Simple example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#comparing-conformer-sets">1.3. Comparing conformer sets</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="components.html">2. Components</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="conformers.html">2.1. Conformers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="conformers.html#uniqueconformersams">2.1.1. UniqueConformersAMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="conformers.html#uniqueconformerscrest">2.1.2. UniqueConformersCrest</a></li>
<li class="toctree-l3"><a class="reference internal" href="conformers.html#uniqueconformerstfd">2.1.3. UniqueConformersTFD</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.2. Generators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rdkitgenerator">2.2.1. RDKitGenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#crestgenerator">2.2.2. CRESTGenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#metadynamicsgenerator">2.2.3. MetadynamicsGenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mdgenerator">2.2.4. MDGenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gcgenerator">2.2.5. GCGenerator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="optimizer.html">2.3. ConformerOptimizer</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">AMSConformers</a>
      </nav>
<!--ENDNOSOLR-->

      
      <div class="wy-nav-content">
        <div class="rst-content">
        <!--STARTNOSOLR-->
<div class="header" role="navigation" aria-label="breadcrumbs navigation">
 
  <ul class="wy-breadcrumbs">
    <li><a href="../AMSConformers.html/../../Documentation/index.html">Documentation</a>/</li>
    <li><a href="../index.html">AMSConformers</a>/</li>
      
          <li><a href="components.html">2. Components</a>/</li>
      
    <li class="orange-text">2.2. Generators</li>
  </ul>
  <p>
 
</div>
<!--ENDNOSOLR-->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="generators">
<h1>2.2. Generators<a class="headerlink" href="#generators" title="Permalink to this headline">¶</a></h1>
<p>The Generator classes are not meant to be directly accessed by the user.
Instead, they are used as components of the UniqueConformer classes.</p>
<p>There are two main generator classes, <code class="xref py py-class docutils literal notranslate"><span class="pre">RDKitGenerator</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">CRESTGenerator</span></code>, which have roughly the same interface,
but different settings.
All generators accept an instance of one of the UniqueConformers classes upon initiation.
This conformer set is generally expected to be empty, but is not required to be so.</p>
<p>The CREST method combines three separate methods to generate conformers:
1. CREST metadynamics
2. High temperature MD
3. A genetic combinatorial method that extends an existing conformer set.
Each of these methods can be used separately, via their additional expert generator classes.</p>
<div class="section" id="rdkitgenerator">
<h2>2.2.1. RDKitGenerator<a class="headerlink" href="#rdkitgenerator" title="Permalink to this headline">¶</a></h2>
<p>This generator fills the conformer set of a molecule, using RDKit to call the ETKDG conformer generation approach,
followed by geometry optimization with a specified AMS engine.</p>
<dl class="class">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator">
<em class="property">class </em><code class="descname">RDKitGenerator</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Machine that generates a set of unique conformers using RDKit</p>
<p>DOI: 10.1021/acs.jcim.5b00654</p>
<p>A simple example of (parallel) use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">finish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.conformers</span> <span class="k">import</span> <span class="n">UniqueConformersAMS</span><span class="p">,</span> <span class="n">RDKitGenerator</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up the molecular data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;mol.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span> <span class="o">=</span> <span class="n">UniqueConformersAMS</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">prepare_state</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up PLAMS settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the generator and run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">RDKitGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">finish</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write the results to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conformers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>The default AMS engine used is the GFN1-xTB engine.
A different engine can be provided upon initiation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">ForceField</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">&#39;UFF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">RDKitGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">engine_settings</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiates an instance of the RDKitGenerator class</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">conformers</span></code>       – A UniqueConformers object</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code>  – PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nproc</span></code>            – Number of processors used for each single call to AMS</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">energy_threshold</span></code> – Maximum accepted energy difference from lowest energy conformer</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code>          – Maximum number of parallel AMS processes</p>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.set_number_initial_conformers">
<code class="descname">set_number_initial_conformers</code><span class="sig-paren">(</span><em>ngeoms=None</em>, <em>min_confs=10</em>, <em>max_confs=5000</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.set_number_initial_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the number of conformers created by RDKit, before geometry optimization and filtering</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ngeoms</span></code> – The number of initial conformers created by RDKit.
If not provided, this number will be generated based on the number of rotational bonds <span class="math notranslate nohighlight">\(n\)</span>:
<span class="math notranslate nohighlight">\(3^n*self.factor\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">min_confs</span></code> – A minimum to the number of initial conformers, in case ngeoms is not provided</li>
<li><code class="docutils literal notranslate"><span class="pre">max_geoms</span></code> – A maximum to the number of initial conformers, in case ngeoms is not provided</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the conformer set</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator._estimate_go_time">
<code class="descname">_estimate_go_time</code><span class="sig-paren">(</span><em>ngeoms</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator._estimate_go_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate how long the geometry optimizations will take</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator._finalize">
<code class="descname">_finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator._finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Finalize the conformer set 
1. Remove high energy conformers that accidentally snuck in. This is not necessary if optimize_conformers was already called (CREST), but it is fast, so no problem to do it anyway.
2. Fitting on top of the first one</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator._preoptimize_and_select">
<code class="descname">_preoptimize_and_select</code><span class="sig-paren">(</span><em>geometries</em>, <em>level='crude'</em>, <em>name='prego'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator._preoptimize_and_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Run geometry optimizations with a fast engine, to weed out low energy conformers</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
<li><code class="docutils literal notranslate"><span class="pre">level</span></code>      – The level of the geometry optimizations, as defined in the ConformerOptimizer class</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>       – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
<p>Selection will be based on the energies, but
the optimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.are_geometries_local_minima">
<code class="descname">are_geometries_local_minima</code><span class="sig-paren">(</span><em>molecules</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.are_geometries_local_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a PES point characterization for the molecules and return a list of booleans 
indicating whether the geometry is a local minimum or not</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.optimize_and_filter">
<code class="descname">optimize_and_filter</code><span class="sig-paren">(</span><em>geometries</em>, <em>conformers=None</em>, <em>level=None</em>, <em>name='go'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.optimize_and_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the geometry optimizations for the provided geometries and add to conformer set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
<li><code class="docutils literal notranslate"><span class="pre">level</span></code>      – The level of the geometry optimizations, as defined in the ConformerOptimizer class</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>       – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.optimize_conformers">
<code class="descname">optimize_conformers</code><span class="sig-paren">(</span><em>convergence_level</em>, <em>name='go'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.optimize_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>(Re)-Optimize the conformers currently in the set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">convergence_level</span></code> – One of the convergence options (‘tight’, ‘vtight’, ‘loose’, etc’)</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>              – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.set_jobrunner">
<code class="descname">set_jobrunner</code><span class="sig-paren">(</span><em>jobrunner</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.set_jobrunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass a PLAMS JobRunner object to organize parallelization</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">jobrunner</span></code> – Instance of the PLAMS Jobrunner class</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.set_optimizer">
<code class="descname">set_optimizer</code><span class="sig-paren">(</span><em>optimizer</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.set_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the optimizer of the generator object</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">optimizer</span></code> – ConformerOptimizer object</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.set_preoptimizer">
<code class="descname">set_preoptimizer</code><span class="sig-paren">(</span><em>engine_settings</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.set_preoptimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a lower level optimizer, to be used for preoptimization</p>
<p>A selection will be made based on the energies, but
the preoptimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.write_geometries">
<code class="descname">write_geometries</code><span class="sig-paren">(</span><em>geometries</em>, <em>name='unoptimized'</em>, <em>filetype='xyz'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.simple_generators.rdkit_generator.RDKitGenerator.write_geometries" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a set of geometries at any point</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="crestgenerator">
<h2>2.2.2. CRESTGenerator<a class="headerlink" href="#crestgenerator" title="Permalink to this headline">¶</a></h2>
<p>This generator fills the conformer set of a molecule using the CREST method.</p>
<dl class="class">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator">
<em class="property">class </em><code class="descname">CRESTGenerator</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Machine that generates a set of conformers using the CREST workflow</p>
<p>A simple example of (parallel) use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">finish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.conformers</span> <span class="k">import</span> <span class="n">UniqueConformersCrest</span><span class="p">,</span> <span class="n">CRESTGenerator</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up the molecular data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;mol.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span> <span class="o">=</span> <span class="n">UniqueConformersCrest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">prepare_state</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up PLAMS settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the generator and run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">CRESTGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">finish</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write the results to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conformers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>The default AMS engine used is the GFN1-xTB engine.
A different engine can be provided upon initiation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">ForceField</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">&#39;UFF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">CRESTGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">engine_settings</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiates an instance of the Optimizer class</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">conformers</span></code>       – A UniqueConformers object</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code>  – PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nproc</span></code>            – Number of processors used for each single call to AMS</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">energy_threshold</span></code> – Maximum accepted energy difference from lowest energy conformer</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code>          – Maximum number of parallel AMS processes</p>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.set_optimizer">
<code class="descname">set_optimizer</code><span class="sig-paren">(</span><em>optimizer</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.set_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the optimizer of the generator object</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">optimizer</span></code> – ConformerOptimizer object</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the conformer set</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator._finalize">
<code class="descname">_finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator._finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Finalize the conformer set 
1. Remove high energy conformers that accidentally snuck in. This is not necessary if optimize_conformers was already called (CREST), but it is fast, so no problem to do it anyway.
2. Fitting on top of the first one</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator._preoptimize_and_select">
<code class="descname">_preoptimize_and_select</code><span class="sig-paren">(</span><em>geometries</em>, <em>level='crude'</em>, <em>name='prego'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator._preoptimize_and_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Run geometry optimizations with a fast engine, to weed out low energy conformers</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
<li><code class="docutils literal notranslate"><span class="pre">level</span></code>      – The level of the geometry optimizations, as defined in the ConformerOptimizer class</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>       – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
<p>Selection will be based on the energies, but
the optimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.are_geometries_local_minima">
<code class="descname">are_geometries_local_minima</code><span class="sig-paren">(</span><em>molecules</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.are_geometries_local_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a PES point characterization for the molecules and return a list of booleans 
indicating whether the geometry is a local minimum or not</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.optimize_and_filter">
<code class="descname">optimize_and_filter</code><span class="sig-paren">(</span><em>geometries</em>, <em>conformers=None</em>, <em>level=None</em>, <em>name='go'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.optimize_and_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the geometry optimizations for the provided geometries and add to conformer set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
<li><code class="docutils literal notranslate"><span class="pre">level</span></code>      – The level of the geometry optimizations, as defined in the ConformerOptimizer class</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>       – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.optimize_conformers">
<code class="descname">optimize_conformers</code><span class="sig-paren">(</span><em>convergence_level</em>, <em>name='go'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.optimize_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>(Re)-Optimize the conformers currently in the set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">convergence_level</span></code> – One of the convergence options (‘tight’, ‘vtight’, ‘loose’, etc’)</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>              – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.set_jobrunner">
<code class="descname">set_jobrunner</code><span class="sig-paren">(</span><em>jobrunner</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.set_jobrunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass a PLAMS JobRunner object to organize parallelization</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">jobrunner</span></code> – Instance of the PLAMS Jobrunner class</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.set_preoptimizer">
<code class="descname">set_preoptimizer</code><span class="sig-paren">(</span><em>engine_settings</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.crest_generator.CRESTGenerator.set_preoptimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a lower level optimizer, to be used for preoptimization</p>
<p>A selection will be made based on the energies, but
the preoptimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="metadynamicsgenerator">
<h2>2.2.3. MetadynamicsGenerator<a class="headerlink" href="#metadynamicsgenerator" title="Permalink to this headline">¶</a></h2>
<p>This generator fills the conformer set of a molecule using only CREST metadynanics,
followed by geometry optimization of the stored shapshots (step 1 of the CREST approach).</p>
<dl class="class">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator">
<em class="property">class </em><code class="descname">MetadynamicsGenerator</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Machine that produces a set of conformers from CREST metadynamics simulations</p>
<p>A simple example of (parallel) use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">finish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.conformers</span> <span class="k">import</span> <span class="n">UniqueConformersCrest</span><span class="p">,</span> <span class="n">MetadynamicsGenerator</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up the molecular data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;mol.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span> <span class="o">=</span> <span class="n">UniqueConformersCrest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">prepare_state</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up PLAMS settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the generator and run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">MetadynamicsGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">finish</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write the results to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conformers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>The default AMS engine used is the GFN1-xTB engine.
A different engine can be provided upon initiation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">ForceField</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">&#39;UFF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">MetadynamicsGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">engine_settings</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiates an instance of the MetadynamicsGenerator class</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">conformers</span></code>       – A UniqueConformers object</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code>  – PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nproc</span></code>            – Number of processors used for each single call to AMS</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">energy_threshold</span></code> – Maximum accepted energy difference from lowest energy conformer</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code>          – Maximum number of parallel AMS processes</p>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the conformer set</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.optimize_and_filter">
<code class="descname">optimize_and_filter</code><span class="sig-paren">(</span><em>geometries</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.optimize_and_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run dual-level geometry optimizations for the provided geometries and add to conformer set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator._contract_settingslist">
<code class="descname">_contract_settingslist</code><span class="sig-paren">(</span><em>settings_list</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator._contract_settingslist" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the settings lit if possible</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator._finalize">
<code class="descname">_finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator._finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Finalize the conformer set 
1. Remove high energy conformers that accidentally snuck in. This is not necessary if optimize_conformers was already called (CREST), but it is fast, so no problem to do it anyway.
2. Fitting on top of the first one</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator._preoptimize_and_select">
<code class="descname">_preoptimize_and_select</code><span class="sig-paren">(</span><em>geometries</em>, <em>level='crude'</em>, <em>name='prego'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator._preoptimize_and_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Run geometry optimizations with a fast engine, to weed out low energy conformers</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
<li><code class="docutils literal notranslate"><span class="pre">level</span></code>      – The level of the geometry optimizations, as defined in the ConformerOptimizer class</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>       – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
<p>Selection will be based on the energies, but
the optimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.are_geometries_local_minima">
<code class="descname">are_geometries_local_minima</code><span class="sig-paren">(</span><em>molecules</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.are_geometries_local_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a PES point characterization for the molecules and return a list of booleans 
indicating whether the geometry is a local minimum or not</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.optimize_conformers">
<code class="descname">optimize_conformers</code><span class="sig-paren">(</span><em>convergence_level</em>, <em>name='go'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.optimize_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>(Re)-Optimize the conformers currently in the set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">convergence_level</span></code> – One of the convergence options (‘tight’, ‘vtight’, ‘loose’, etc’)</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>              – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.set_jobrunner">
<code class="descname">set_jobrunner</code><span class="sig-paren">(</span><em>jobrunner</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.set_jobrunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass a PLAMS JobRunner object to organize parallelization</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">jobrunner</span></code> – Instance of the PLAMS Jobrunner class</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.set_optimizer">
<code class="descname">set_optimizer</code><span class="sig-paren">(</span><em>optimizer</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.set_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the optimizer of the generator object</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">optimizer</span></code> – ConformerOptimizer object</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.set_preoptimizer">
<code class="descname">set_preoptimizer</code><span class="sig-paren">(</span><em>engine_settings</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.metadynamics_generator.MetadynamicsGenerator.set_preoptimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a lower level optimizer, to be used for preoptimization</p>
<p>A selection will be made based on the energies, but
the preoptimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mdgenerator">
<h2>2.2.4. MDGenerator<a class="headerlink" href="#mdgenerator" title="Permalink to this headline">¶</a></h2>
<p>This generator fills the conformer set of a molecule using only regular molecular dynamics,
followed by geometry optimization of the stored shapshots (step 2 of the CREST approach).</p>
<dl class="class">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator">
<em class="property">class </em><code class="descname">MDGenerator</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Machine that produces a set of conformers from molecular dynamics simulations (Step 2 of CREST approach)</p>
<p>A simple example of (parallel) use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">finish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.conformers</span> <span class="k">import</span> <span class="n">UniqueConformersCrest</span><span class="p">,</span> <span class="n">MDGenerator</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up the molecular data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;mol.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span> <span class="o">=</span> <span class="n">UniqueConformersCrest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">prepare_state</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up PLAMS settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the generator and run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">MDGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">finish</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write the results to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conformers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>The default AMS engine used is the GFN1-xTB engine.
A different engine can be provided upon initiation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">ForceField</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">&#39;UFF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">MDGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">engine_settings</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiates an instance of the MDGenerator class</p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code>  – PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nproc</span></code>            – Number of processors used for each single call to AMS</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">energy_threshold</span></code> – Maximum accepted energy difference from lowest energy conformer</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code>          – Maximum number of parallel AMS processes</p>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_jobrunner">
<code class="descname">set_jobrunner</code><span class="sig-paren">(</span><em>jobrunner</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_jobrunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass a PLAMS JobRunner object to organize parallelization</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">jobrunner</span></code> – Instance of the PLAMS Jobrunner class</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_number_of_identical_mdruns">
<code class="descname">set_number_of_identical_mdruns</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_number_of_identical_mdruns" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the number of MD runs of each temperature (default=1)</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_number_of_starting_geometries">
<code class="descname">set_number_of_starting_geometries</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_number_of_starting_geometries" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the number of conformers used to start the MD runs from (default=4)</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the conformer set</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator._contract_settingslist">
<code class="descname">_contract_settingslist</code><span class="sig-paren">(</span><em>settings_list</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator._contract_settingslist" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract the settings lit if possible</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator._finalize">
<code class="descname">_finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator._finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Finalize the conformer set 
1. Remove high energy conformers that accidentally snuck in. This is not necessary if optimize_conformers was already called (CREST), but it is fast, so no problem to do it anyway.
2. Fitting on top of the first one</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator._preoptimize_and_select">
<code class="descname">_preoptimize_and_select</code><span class="sig-paren">(</span><em>geometries</em>, <em>level='crude'</em>, <em>name='prego'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator._preoptimize_and_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Run geometry optimizations with a fast engine, to weed out low energy conformers</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
<li><code class="docutils literal notranslate"><span class="pre">level</span></code>      – The level of the geometry optimizations, as defined in the ConformerOptimizer class</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>       – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
<p>Selection will be based on the energies, but
the optimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.are_geometries_local_minima">
<code class="descname">are_geometries_local_minima</code><span class="sig-paren">(</span><em>molecules</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.are_geometries_local_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a PES point characterization for the molecules and return a list of booleans 
indicating whether the geometry is a local minimum or not</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.optimize_and_filter">
<code class="descname">optimize_and_filter</code><span class="sig-paren">(</span><em>geometries</em>, <em>conformers=None</em>, <em>level=None</em>, <em>name='go'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.optimize_and_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the geometry optimizations for the provided geometries and add to conformer set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
<li><code class="docutils literal notranslate"><span class="pre">level</span></code>      – The level of the geometry optimizations, as defined in the ConformerOptimizer class</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>       – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.optimize_conformers">
<code class="descname">optimize_conformers</code><span class="sig-paren">(</span><em>convergence_level</em>, <em>name='go'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.optimize_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>(Re)-Optimize the conformers currently in the set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">convergence_level</span></code> – One of the convergence options (‘tight’, ‘vtight’, ‘loose’, etc’)</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>              – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_optimizer">
<code class="descname">set_optimizer</code><span class="sig-paren">(</span><em>optimizer</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the optimizer of the generator object</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">optimizer</span></code> – ConformerOptimizer object</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_preoptimizer">
<code class="descname">set_preoptimizer</code><span class="sig-paren">(</span><em>engine_settings</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.md_generator.MDGenerator.set_preoptimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a lower level optimizer, to be used for preoptimization</p>
<p>A selection will be made based on the energies, but
the preoptimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="gcgenerator">
<h2>2.2.5. GCGenerator<a class="headerlink" href="#gcgenerator" title="Permalink to this headline">¶</a></h2>
<p>This generator extends a conformer set of a molecule using only the CREST genetic combinatorial method (GC),
followed by geometry optimization of the stored shapshots (step 3 of the CREST approach).</p>
<dl class="class">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator">
<em class="property">class </em><code class="descname">GCGenerator</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Machine that extends a set of conformers using genetic structure crossing</p>
<p>DOI: 10.1002/anie.201708266 (Supporting Information)</p>
<p>A simple example of (parallel) use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">finish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.conformers</span> <span class="k">import</span> <span class="n">UniqueConformersCrest</span><span class="p">,</span> <span class="n">GCGenerator</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up the molecular data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;mol.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span> <span class="o">=</span> <span class="n">UniqueConformersCrest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">prepare_state</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up PLAMS settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the generator and run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">GCGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">finish</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write the results to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conformers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>The default AMS engine used is the GFN1-xTB engine.
A different engine can be provided upon initiation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">ForceField</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">&#39;UFF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">GCGenerator</span><span class="p">(</span><span class="n">conformers</span><span class="p">,</span> <span class="n">engine_settings</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>conformers</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>energy_threshold=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiates an instance of the GCGenerator class</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">conformers</span></code>       – A UniqueConformers object</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code>  – PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nproc</span></code>            – Number of processors used for each single call to AMS</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">energy_threshold</span></code> – Maximum accepted energy difference from lowest energy conformer</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code>          – Maximum number of parallel AMS processes</p>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a conformer set, based on the CREST method</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator._finalize">
<code class="descname">_finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator._finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Finalize the conformer set 
1. Remove high energy conformers that accidentally snuck in. This is not necessary if optimize_conformers was already called (CREST), but it is fast, so no problem to do it anyway.
2. Fitting on top of the first one</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator._preoptimize_and_select">
<code class="descname">_preoptimize_and_select</code><span class="sig-paren">(</span><em>geometries</em>, <em>level='crude'</em>, <em>name='prego'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator._preoptimize_and_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Run geometry optimizations with a fast engine, to weed out low energy conformers</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
<li><code class="docutils literal notranslate"><span class="pre">level</span></code>      – The level of the geometry optimizations, as defined in the ConformerOptimizer class</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>       – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
<p>Selection will be based on the energies, but
the optimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator.are_geometries_local_minima">
<code class="descname">are_geometries_local_minima</code><span class="sig-paren">(</span><em>molecules</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator.are_geometries_local_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a PES point characterization for the molecules and return a list of booleans 
indicating whether the geometry is a local minimum or not</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator.optimize_and_filter">
<code class="descname">optimize_and_filter</code><span class="sig-paren">(</span><em>geometries</em>, <em>conformers=None</em>, <em>level=None</em>, <em>name='go'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator.optimize_and_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the geometry optimizations for the provided geometries and add to conformer set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code> – List of “math:<cite>n</cite> numpy arrays containing coordinates (n*(nats,3))</li>
<li><code class="docutils literal notranslate"><span class="pre">level</span></code>      – The level of the geometry optimizations, as defined in the ConformerOptimizer class</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>       – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator.optimize_conformers">
<code class="descname">optimize_conformers</code><span class="sig-paren">(</span><em>convergence_level</em>, <em>name='go'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator.optimize_conformers" title="Permalink to this definition">¶</a></dt>
<dd><p>(Re)-Optimize the conformers currently in the set</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">convergence_level</span></code> – One of the convergence options (‘tight’, ‘vtight’, ‘loose’, etc’)</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>              – The base name of the PLAMS directories in which the geometry optimizations are performed</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator.set_jobrunner">
<code class="descname">set_jobrunner</code><span class="sig-paren">(</span><em>jobrunner</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator.set_jobrunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass a PLAMS JobRunner object to organize parallelization</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">jobrunner</span></code> – Instance of the PLAMS Jobrunner class</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator.set_optimizer">
<code class="descname">set_optimizer</code><span class="sig-paren">(</span><em>optimizer</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator.set_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the optimizer of the generator object</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">optimizer</span></code> – ConformerOptimizer object</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.generators.crest_generators.gc_generator.GCGenerator.set_preoptimizer">
<code class="descname">set_preoptimizer</code><span class="sig-paren">(</span><em>engine_settings</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.generators.crest_generators.gc_generator.GCGenerator.set_preoptimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a lower level optimizer, to be used for preoptimization</p>
<p>A selection will be made based on the energies, but
the preoptimized geometries will not be used, so as not to rely on the low-level engine too much</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <!--STARTNOSOLR-->
<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="optimizer.html" class="btn btn-neutral float-right" title="2.3. ConformerOptimizer" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="conformers.html" class="btn btn-neutral" title="2.1. Conformers" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/> 

<!-- start :: footer -->
		<footer class="site-footer block">
			<div class="container">
				<div class="row">
					<div class="footer-column" >
	<ul>
		<li id="nav_menu-2" class="widget widget_nav_menu "><h3>Application Areas</h3><div class="menu-application-areas-container"><ul id="menu-application-areas" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/batteries/">Batteries &#038; PVs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/chemical-bonding-analysis/">Bonding Analysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/catalysis/">Catalysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/heavy-elements/">Heavy Elements</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/inorganic-chemistry/">Inorganic Chemistry</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/pharma/">Life Sciences</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/materials-science/">Materials Science</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/nanotechnology/">Nanotechnology</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/oil-and-gas/">Oil and Gas</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/organic-electronics/">Organic Electronics</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/polymers/">Polymers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/spectroscopy/">Spectroscopy</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/teaching/">Teaching</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-7" class="widget widget_nav_menu "><h3>Products</h3><div class="menu-product-navigation-container"><ul id="menu-product-navigation" class="menu">
<li id="menu-item-40263" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40263"><a href="https://www.scm.com/product/ams/">AMS Driver</a></li>
<li id="menu-item-7235" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7235"><a href="https://www.scm.com/product/adf/">ADF</a></li>
<li id="menu-item-7236" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7236"><a href="https://www.scm.com/product/band_periodicdft/">BAND</a></li>
<li id="menu-item-7237" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7237"><a href="https://www.scm.com/product/cosmo-rs/">COSMO-RS</a></li>
<li id="menu-item-7238" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7238"><a href="https://www.scm.com/product/dftb/">DFTB</a></li>
<li id="menu-item-7239" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7239"><a href="https://www.scm.com/product/gui/">GUI</a></li>
<li id="menu-item-44383" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-44383"><a href="https://www.scm.com/product/machine-learning-potentials/">MLPotential</a></li>
<li id="menu-item-7240" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7240"><a href="https://www.scm.com/product/mopac/">MOPAC</a></li>
<li id="menu-item-40262" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40262"><a href="https://www.scm.com/product/plams/">PLAMS</a></li>
<li id="menu-item-43701" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-43701"><a href="https://www.scm.com/product/quantum-espresso/">Quantum ESPRESSO</a></li>
<li id="menu-item-7241" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7241"><a href="https://www.scm.com/product/reaxff/">ReaxFF</a></li></ul></div></li><li id="nav_menu-26" class="widget widget_nav_menu "><div class="menu-licensing-container"><ul id="menu-licensing" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/">Pricing &#038; Licensing</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/">Price Quote</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/calculate-your-price/">Price Calculator</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/consulting/">Scientific Consulting</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/adf-resellers/">Resellers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/scm-license-terms/">License Terms</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/ordering-procedure/">Ordering</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-6" class="widget widget_nav_menu "><h3>Support</h3><div class="menu-support-navigation-container"><ul id="menu-support-navigation" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/">Support Overview</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-installation-videos/">Installation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-tutorials-and-manuals/">Documentation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/doc/Tutorials/GUI_overview/GUI_overview_tutorials.html">GUI Tutorials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/downloads/">Downloads</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/faq/">FAQs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/adf-discussion-list/">Discussion List</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/documentation-previous-versions/release-notes/">Release Notes</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/adf-teaching-materials/">Teaching Materials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/adf-hands-on-workshops/">Workshops</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/web-presentations-by-adf-experts/">Webinars</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/videos-tutorials-and-web-presentations/">Videos</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/brochures/">Brochure</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/amsterdam-modeling-suite/research-papers-citing-adf/">Papers Citing ADF</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/highlights/">Literature Highlights</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-28" class="widget widget_nav_menu "><h3>About Us</h3><div class="menu-about-us-container"><ul id="menu-about-us" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/contact-us/">Contact Us</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/eu-projects/">EU Projects</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-authors/">Contributors</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-people/">The SCM Team</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/collaborations/">Collaborations</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/careers/">Careers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/mission-vision/">Mission &#038; Vision</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/newsletters/">Newsletters</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/news/">News</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/">Events</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
			</ul>
</div>				</div>
			</div>
		</footer>
		<footer class="disclaimer-footer">
			<img src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="">
			<nav class="menu-service-navigation-container"><ul id="menu-service-navigation" class="menu-service navbar-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-73"><a href="https://www.scm.com/copyright/">Copyright</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72"><a href="https://www.scm.com/terms-of-use/">Terms of Use</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-71"><a href="https://www.scm.com/privacy-policy/">Privacy Policy</a></li>
</ul></nav></footer>	
		<!-- end :: footer -->

<!--ENDNOSOLR-->
        </div>
      </div>

    </section>
  </div>
  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2021.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCRWHZZ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/../../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>