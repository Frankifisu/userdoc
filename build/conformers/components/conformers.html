

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
<META name="ROBOTS" content="NOINDEX, NOFOLLOW">
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.1. Conformers &mdash; AMSConformers 2021.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme_tabs.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/panels-bootstrap.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="AMSConformers 2021.1 documentation" href="../index.html"/>
        <link rel="up" title="2. Components" href="components.html"/>
        <link rel="next" title="2.2. Generators" href="generators.html"/>
        <link rel="prev" title="2. Components" href="components.html"/> 

  
  <script src="../_static/js/jquery.min.js"></script>
  <script src="../_static/js/bootstrap.min.js"></script>
  <script src="../_static/js/modernizr.min.js"></script>
  <script src="../_static/js/app.js"></script>
<script type="text/javascript">
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NCRWHZZ');</script>
<!-- End Google Tag Manager -->

</head>

<body class="wy-body-for-nav" role="document">
  <!--STARTNOSOLR-->
  <header class="site-header navbar-fixed-top compact">
      <nav class="main navbar navbar-default">
        <div class="headerbar_container">
          <a role="button" href="/free-trial/" class="btn btn-sm btn-primary">Free trial</a>
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div class="navbar-brand">
              <a class="logo" href="https://www.scm.com">
                <img class="logo-small" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="Software for Chemistry &amp; Materials" />
                <img class="logo-full" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo.svg" alt="Software for Chemistry &amp; Materials" />
              </a>
            </div>
          </div>
          <div class="nav-wrapper">
            <div class="collapse navbar-collapse">
              <ul id="menu-primary-navigation" class="nav navbar-nav"><li id="menu-item-40077" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-40077"><a title="Applications" href="https://www.scm.com/applications/">Applications</a></li>
<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a title="Products" href="https://www.scm.com/amsterdam-modeling-suite/">Products</a></li>
<li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36"><a title="Support" href="https://www.scm.com/support/">Support</a></li>
<li id="menu-item-37" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37"><a title="About us" href="https://www.scm.com/about-us/">About us</a></li>
</ul>                           <span class="search"><a class="menu_search_link" href="https://www.scm.com/search.php"></a><span class="sr-only">Search</span></span>
            </div>
          </div>
        </div>
      </nav>
 </header>
    

   
  <div id="doc-wrapper">
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          

          
          </a>

          
          
  <ul>
      <li class="wy-breadcrumbs-aside">
        
           
           
        
      </li>
  </ul>
 
<!--ENDNOSOLR-->
             <!--STARTNOSOLR-->
<div role="search">
  <form id="rtd-search-form" class="wy-form search-docs-form" action="https://www.scm.com/search.php" method="get">
  <div class="input-group">
    <input type="text" name="search" placeholder="Search AMSConformers" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <input type="hidden" name="root" value="doctrunk" />


    <input type="hidden" name="cat" value="doc-AMSConformers" />


    <span class="input-group-btn">
			<button type="submit" class="btn btn-primary"><span class="sr-only">Search</span><span class="fa fa-search"></span></button>
		</span>
	</div>
  </form>
</div>
<!--ENDNOSOLR-->
          

          
        </div>
<!--STARTNOSOLR-->
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">1. AMSConformers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#python-library-for-conformer-generation">1.1. Python library for conformer generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#simple-example">1.2. Simple example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#comparing-conformer-sets">1.3. Comparing conformer sets</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="components.html">2. Components</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.1. Conformers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#uniqueconformersams">2.1.1. UniqueConformersAMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#uniqueconformerscrest">2.1.2. UniqueConformersCrest</a></li>
<li class="toctree-l3"><a class="reference internal" href="#uniqueconformerstfd">2.1.3. UniqueConformersTFD</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="generators.html">2.2. Generators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generators.html#rdkitgenerator">2.2.1. RDKitGenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="generators.html#crestgenerator">2.2.2. CRESTGenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="generators.html#metadynamicsgenerator">2.2.3. MetadynamicsGenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="generators.html#mdgenerator">2.2.4. MDGenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="generators.html#gcgenerator">2.2.5. GCGenerator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="optimizer.html">2.3. ConformerOptimizer</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">AMSConformers</a>
      </nav>
<!--ENDNOSOLR-->

      
      <div class="wy-nav-content">
        <div class="rst-content">
        <!--STARTNOSOLR-->
<div class="header" role="navigation" aria-label="breadcrumbs navigation">
 
  <ul class="wy-breadcrumbs">
    <li><a href="../AMSConformers.html/../../Documentation/index.html">Documentation</a>/</li>
    <li><a href="../index.html">AMSConformers</a>/</li>
      
          <li><a href="components.html">2. Components</a>/</li>
      
    <li class="orange-text">2.1. Conformers</li>
  </ul>
  <p>
 
</div>
<!--ENDNOSOLR-->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="conformers">
<h1>2.1. Conformers<a class="headerlink" href="#conformers" title="Permalink to this headline">Â¶</a></h1>
<p>There are three types of conformer classes, which differ in the approach to duplicate recognition,
and all have largely the same interface.
A description of the full interface is provided below for the <a class="reference internal" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS" title="scm.conformers.conformers.conformers_ams.UniqueConformersAMS"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueConformersAMS</span></code></a> class,
followed by more abbreviated descriptions of the <a class="reference internal" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest" title="scm.conformers.conformers.conformers_crest.UniqueConformersCrest"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueConformersCrest</span></code></a> and <a class="reference internal" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD" title="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueConformersTFD</span></code></a> classes.</p>
<div class="section" id="uniqueconformersams">
<h2>2.1.1. UniqueConformersAMS<a class="headerlink" href="#uniqueconformersams" title="Permalink to this headline">Â¶</a></h2>
<p>A class holding the conformers of a molecule, using distance matrices and torsion angles to recognize and filter out duplicates.</p>
<dl class="class">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS">
<em class="property">class </em><code class="descname">UniqueConformersAMS</code><span class="sig-paren">(</span><em>energy_threshold=0.2</em>, <em>min_dihed=30</em>, <em>min_dist=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Class representing a set of unique conformers</p>
<p>An instance of this class has the following attributes:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">molecule</span></code>             â A PLAMS molecule object defining the connection data of the molecule</li>
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code>           â A list containing the coordinates of all conformers in the set</li>
<li><code class="docutils literal notranslate"><span class="pre">energies</span></code>             â A list containing the energies of all conformers in the set</li>
<li><code class="docutils literal notranslate"><span class="pre">rotamers</span></code>             â A list with <a class="reference internal" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS" title="scm.conformers.conformers.conformers_ams.UniqueConformersAMS"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueConformersAMS</span></code></a> objects representing the rotamer-set for each conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">check_for_duplicates</span></code> â Only accept new conformer if candidate is not a duplicate (if False, there is still a check for isomers and bond changes)</li>
<li><code class="docutils literal notranslate"><span class="pre">accept_isomers</span></code>       â Donât reject isomers (default is to reject them)</li>
<li><code class="docutils literal notranslate"><span class="pre">accept_all</span></code>           â Accept any candidate in the set without checks</li>
<li><code class="docutils literal notranslate"><span class="pre">generator</span></code>            â A conformer generator object. Has to be set with <a class="reference internal" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.set_generator" title="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.set_generator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_generator()</span></code></a>.
The default generator is of the CrestGenerator type.</li>
</ul>
<p>A simple example of (parallel) use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">finish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.conformers</span> <span class="k">import</span> <span class="n">UniqueConformersAMS</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up the molecular data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;mol.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span> <span class="o">=</span> <span class="n">UniqueConformersAMS</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">prepare_state</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up PLAMS settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the generator and run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">finish</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write the results to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conformers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<p>The default generator for this conformer class is the <code class="xref py py-class docutils literal notranslate"><span class="pre">RDKitGenerator</span></code>.
A list of all possibe generators:</p>
<ul class="simple">
<li>RDKitGenerator</li>
<li>TorsionGenerator</li>
<li>CrestGenerator</li>
</ul>
<p>By default the <code class="xref py py-class docutils literal notranslate"><span class="pre">RDKitGenerator</span></code> uses the UFF engine.
To select a different engine, set a different generator prior to running <a class="reference internal" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.generate" title="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.generate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">generate()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">ForceField</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">&#39;UFF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">set_generator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;rdkit&#39;</span><span class="p">,</span> <span class="n">engine_settings</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">RDKitGenerator</span></code> first uses RDKit to generate an initial set of conformer geometries.
These are then subjected to geometry optimization using an AMS engine, 
after which duplicates are filtered out.
By default, the <code class="xref py py-class docutils literal notranslate"><span class="pre">RDKitGenerator</span></code> determines the number of initial conformers based on the
number of rotatable bonds in the system. 
For a large molecule, this will result in a very large number of conformers.
To set the number of initial conformers by hand, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">set_generator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;rdkit&#39;</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">set_number_initial_conformers</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Initial number of conformers: &#39;</span><span class="p">,</span><span class="n">conformers</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">ngeoms</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>energy_threshold=0.2</em>, <em>min_dihed=30</em>, <em>min_dist=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.__init__" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Creates an instance of the conformer class</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">energy_threshold</span></code> â The energy difference above which conformers are always considered unique (kcal/mol).</li>
<li><code class="docutils literal notranslate"><span class="pre">min_dist</span></code>         â Maximum difference a distance between two atoms can have
for a conformer to be considered a duplicate.</li>
<li><code class="docutils literal notranslate"><span class="pre">min_dihed</span></code>        â Maximum difference a dihedral can have for a conformer to 
be considered a duplicate.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.prepare_state">
<code class="descname">prepare_state</code><span class="sig-paren">(</span><em>mol</em>, <em>atoms_to_remove=None</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.prepare_state" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Set up all the molecule data</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mol</span></code>             â A PLAMS Molecule object</li>
<li><code class="docutils literal notranslate"><span class="pre">atoms_to_remove</span></code> â Optional: A list of atoms to be removed from the distance matrices (default is all H)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.add_conformer">
<code class="descname">add_conformer</code><span class="sig-paren">(</span><em>coords</em>, <em>energy</em>, <em>reorder=True</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.add_conformer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Adds the new coordinates to the list of conformers, if they are not duplicates</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">coords</span></code>  â A coordinate array for the candidate conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">energy</span></code>  â The energy of the candidate conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">reorder</span></code> â Boolean specifying if the conformers should be ordered based on energy after addition of candidate</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the conformer is not unique, this method returns the index of its duplicate.
If it is unique, this returns None.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.set_generator">
<code class="descname">set_generator</code><span class="sig-paren">(</span><em>method='rdkit'</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>max_energy=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.set_generator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Store a generator object, to be used by the <a class="reference internal" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.generate" title="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.generate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">generate()</span></code></a> method</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">method</span></code>           â A string, and one of the following options
[âcrestâ, ârdkitâ]</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code>  â PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nproc</span></code>            â Number of processors used for each single call to AMS</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">max_energy</span></code>       â Maximum accepted energy difference from lowest energy conformer</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code>          â Maximum number of parallel AMS processes</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Overwrites previously used generator object.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><em>method='rdkit'</em>, <em>nproc=1</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.generate" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Generate conformers using the specified method</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">method</span></code>  â A string, and one of the following options
[âcrestâ, ârdkitâ]</li>
<li><code class="docutils literal notranslate"><span class="pre">nproc</span></code>   â Number of processors used for each single call to AMS (only used if set_generator was not called)</li>
<li><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code> â Maximum number of parallel AMS processes ((only used if set_generator was not called))</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Adjusts self.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If a generator was set previously with the <a class="reference internal" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.set_generator" title="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.set_generator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_generator()</span></code></a> method, no arguments are required</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_diffs_for_candidate">
<code class="descname">get_diffs_for_candidate</code><span class="sig-paren">(</span><em>coords</em>, <em>energy=0.0</em>, <em>iconf=None</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_diffs_for_candidate" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find out how much the values in the candidate molecule differ from each conformer</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">coords</span></code> â Coordinate array for the candidate conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">energy</span></code> â Energy of the candidate conformer (kcal/mol)</li>
<li><code class="docutils literal notranslate"><span class="pre">iconf</span></code>  â Optional: A single conformer index to compare the candidate with (default is to compare to all)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>dirname</em>, <em>name='ams'</em>, <em>enfilename=None</em>, <em>reorder=True</em>, <em>filetype='dcd'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.read" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Read a conformer set from the specified directory</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">dirname</span></code>              â The directory name containing the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>                 â The name of the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">enfilename</span></code>           â Optionally the name of a file containing the conformer energies (default: energies_name.txt)</li>
<li><code class="docutils literal notranslate"><span class="pre">reorder</span></code>              â Boolean specifying if the conformers need to be reordered based on energy</li>
<li><code class="docutils literal notranslate"><span class="pre">filetype</span></code>             â Extension of the conformer file (âdcdâ (default) or ârkfâ).</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename='ams'</em>, <em>write_rotamers=False</em>, <em>dirname='.'</em>, <em>filetype='dcd'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.write" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Write the conformers to file</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">write_rotamers</span></code>       â Boolean specifying if the rotamers of the conformers shouldk be written to files</li>
<li><code class="docutils literal notranslate"><span class="pre">filename</span></code>             â The name of the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">dirname</span></code>              â The directory name containing the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">filetype</span></code>             â Extension of the conformer file (âdcdâ (default) or ârkfâ).</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS._select_permutation_best_dihedral">
<code class="descname">_select_permutation_best_dihedral</code><span class="sig-paren">(</span><em>j</em>, <em>indices_list</em>, <em>dihedral_values</em>, <em>angle_values</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS._select_permutation_best_dihedral" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Select the best permutation out of a subset of indices_list (good_perms), using torsion angles</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS._get_distance_diffs">
<code class="descname">_get_distance_diffs</code><span class="sig-paren">(</span><em>j</em>, <em>indices</em>, <em>distance_matrix</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS._get_distance_diffs" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get all the differences in the atom-atom distances</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS._get_dihedral_diffs">
<code class="descname">_get_dihedral_diffs</code><span class="sig-paren">(</span><em>j</em>, <em>indices</em>, <em>dihedral_values</em>, <em>angle_values</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS._get_dihedral_diffs" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get all the differences in dihedral angles</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS._write_separate_xyz">
<code class="descname">_write_separate_xyz</code><span class="sig-paren">(</span><em>filename='base'</em>, <em>write_rotamers=False</em>, <em>dirname='.'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS._write_separate_xyz" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Write each conformers in xyz format to a separate xyz file (e.g.: dirname/filename_1.xyz, dirname/filename_2.xyz, â¦)</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS._write_xyz">
<code class="descname">_write_xyz</code><span class="sig-paren">(</span><em>filename='base'</em>, <em>write_rotamers=False</em>, <em>dirname='.'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS._write_xyz" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Write all the conformers in xyz format to a single xyz file (one geometry after the other)</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.clear" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Remove all conformers</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.copy" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Copy the conformer set</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>max_energy=None</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.filter" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Filter all conformers again, possibly with a maximum allowed (relative) energy</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.find_clusters">
<code class="descname">find_clusters</code><span class="sig-paren">(</span><em>dist=5.0</em>, <em>criterion='maxclust'</em>, <em>method='average'</em>, <em>indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.find_clusters" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Assign all conformers to clusters</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">dist</span></code>      â Either the max number of clusters (for maxclust), 
or the maximum distance between clusters (for distance)</li>
<li><code class="docutils literal notranslate"><span class="pre">criterion</span></code> â Determines how many clusters to make (<cite>maxclust</cite> or <cite>distance</cite>).</li>
<li><code class="docutils literal notranslate"><span class="pre">indices</span></code>   â A tuple with as elements lists of indices for subsets of conformers</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Uses scipyâs fcluster method</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.find_nth_conformer">
<code class="descname">find_nth_conformer</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.find_nth_conformer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find the the index of the n-th conformer added (indices start at 0)</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.fit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Fit all conformers onto the first one in the set, and resave</p>
</dd></dl>

<dl class="classmethod">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.from_rdkitmol">
<em class="property">classmethod </em><code class="descname">from_rdkitmol</code><span class="sig-paren">(</span><em>rdmol</em>, <em>energies=None</em>, <em>reorder=True</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.from_rdkitmol" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get all the conformers from the RDKit molecule</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_all_energies">
<code class="descname">get_all_energies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_all_energies" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get all the geometries in the set</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_all_geometries">
<code class="descname">get_all_geometries</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_all_geometries" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get all the gemetries in the set</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_all_rmsds">
<code class="descname">get_all_rmsds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_all_rmsds" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get the RMSD value from the lowest energy conformer for all conformers</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_conformers">
<code class="descname">get_conformers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_conformers" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the conformers as a list of molecules</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_dendrogram">
<code class="descname">get_dendrogram</code><span class="sig-paren">(</span><em>method='average'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_dendrogram" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Gets a dendrogram reflecting the distances between conformers</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Uses scipyâs fcluster method</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_energies">
<code class="descname">get_energies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_energies" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the energies in reference to the most stable</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_molecule">
<code class="descname">get_molecule</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_molecule" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a molecule object for conformer i</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_plot_dendrogram">
<code class="descname">get_plot_dendrogram</code><span class="sig-paren">(</span><em>dend</em>, <em>names=None</em>, <em>fontsize=4</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_plot_dendrogram" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Makes a plot of the dendrogram</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_rdkitmol">
<code class="descname">get_rdkitmol</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_rdkitmol" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Convert to RDKit molecule</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_rmsds_from_frame">
<code class="descname">get_rmsds_from_frame</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.get_rmsds_from_frame" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get all RMSDs from a certain frame</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.indices_to_names">
<code class="descname">indices_to_names</code><span class="sig-paren">(</span><em>indices1</em>, <em>indices2</em>, <em>name1='a'</em>, <em>name2='b'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.indices_to_names" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Convert two sets of indices to names for the conformers in self</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Mostly for use related to clustering features</li>
<li>Only works with two sets of indices.</li>
<li>All indices need to be represented by these two lists</li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.optimize">
<code class="descname">optimize</code><span class="sig-paren">(</span><em>convergence_level</em>, <em>optimizer=None</em>, <em>max_energy=None</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>maxjobs=1</em>, <em>name='go'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.optimize" title="Permalink to this definition">Â¶</a></dt>
<dd><p>(Re)-Optimize the conformers currently in the set</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">convergence_level</span></code> â One of the convergence options (âtightâ, âvtightâ, âlooseâ, etcâ)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">optimizer</span></code>         â Instance of the ConformerOptimizer class. 
If not provided, an engine_settings object is required.</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code>   â PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.remove_conformer">
<code class="descname">remove_conformer</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.remove_conformer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Remove a conformer from the set</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.remove_high_energy">
<code class="descname">remove_high_energy</code><span class="sig-paren">(</span><em>max_energy</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.remove_high_energy" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Remove all high energy conformers</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.remove_non_minima">
<code class="descname">remove_non_minima</code><span class="sig-paren">(</span><em>save_rejected_to_file=False</em>, <em>rejected_filename='rejected_non_minima_conformers.xyz'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.remove_non_minima" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Perform PES point characterizations for all conformers and remove the ones that are not local minima
If save_rejected_to_file is true, rejected non-minimum conformers are saved to the file rejected_filename</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.reorder">
<code class="descname">reorder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.reorder" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Reorder conformers from smallest to largest energy</p>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_ams.UniqueConformersAMS.set_energies">
<code class="descname">set_energies</code><span class="sig-paren">(</span><em>energies</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_ams.UniqueConformersAMS.set_energies" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Set the energies of the conformers</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="uniqueconformerscrest">
<h2>2.1.2. UniqueConformersCrest<a class="headerlink" href="#uniqueconformerscrest" title="Permalink to this headline">Â¶</a></h2>
<p>A class holding the conformers of a molecule, using CREST duplicate recognition to filter out duplicates.</p>
<dl class="class">
<dt id="scm.conformers.conformers.conformers_crest.UniqueConformersCrest">
<em class="property">class </em><code class="descname">UniqueConformersCrest</code><span class="sig-paren">(</span><em>energy_threshold=0.05</em>, <em>rmsd_threshold=0.125</em>, <em>bconst_threshold=0.01</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Class representing a set of unique conformers</p>
<p>An instance of this class has the following attributes:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">molecule</span></code>             â A PLAMS molecule object defining the connection data of the molecule</li>
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code>           â A list containing the coordinates of all conformers in the set</li>
<li><code class="docutils literal notranslate"><span class="pre">energies</span></code>             â A list containing the energies of all conformers in the set</li>
<li><code class="docutils literal notranslate"><span class="pre">rotamers</span></code>             â A list with <a class="reference internal" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest" title="scm.conformers.conformers.conformers_crest.UniqueConformersCrest"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueConformersCrest</span></code></a> objects representing the rotamer-set for each conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">check_for_duplicates</span></code> â Only accept new conformer if candidate is not a duplicate (if False, there is still a check for isomers and bond changes)</li>
<li><code class="docutils literal notranslate"><span class="pre">accept_isomers</span></code>       â Donât reject isomers (default is to reject them)</li>
<li><code class="docutils literal notranslate"><span class="pre">accept_all</span></code>           â Accept any candidate in the set without checks</li>
<li><code class="docutils literal notranslate"><span class="pre">generator</span></code>            â A conformer generator object. Has to be set with <a class="reference internal" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.set_generator" title="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.set_generator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_generator()</span></code></a>.
The default generator is of the <code class="xref py py-class docutils literal notranslate"><span class="pre">CRESTGenerator</span></code> type.</li>
</ul>
<p>A simple example of (parallel) use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">finish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.conformers</span> <span class="k">import</span> <span class="n">UniqueConformersCrest</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up the molecular data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;mol.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span> <span class="o">=</span> <span class="n">UniqueConformersCrest</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">prepare_state</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up PLAMS settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the generator and run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">finish</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write the results to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conformers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The default generator for this conformer class is the <code class="xref py py-class docutils literal notranslate"><span class="pre">CRESTGenerator</span></code>, using the GFN1-xTB engine.
This will generally take a lot of time.
To speed things up, set a generator with a different engine prior to running <a class="reference internal" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.generate" title="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.generate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">generate()</span></code></a>:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">ForceField</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">&#39;UFF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">set_generator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;crest&#39;</span><span class="p">,</span> <span class="n">engine_settings</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="method">
<dt id="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>energy_threshold=0.05</em>, <em>rmsd_threshold=0.125</em>, <em>bconst_threshold=0.01</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.__init__" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Creates an instance of the conformer class</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">energy_threshold</span></code>  â The energy difference above which conformers are always considered unique (kcal/mol).</li>
<li><code class="docutils literal notranslate"><span class="pre">rmsd_threshold</span></code>    â RMSD below which conformers are considered duplicates Angstrom.</li>
<li><code class="docutils literal notranslate"><span class="pre">bconst_threshold</span></code>  â Relative rotational constant used to determine if conformers are unique or not.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.add_conformer">
<code class="descname">add_conformer</code><span class="sig-paren">(</span><em>coords</em>, <em>energy</em>, <em>reorder=True</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.add_conformer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Adds the new coordinates to the list of conformers, if they are not duplicates</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">coords</span></code>  â A coordinate array for the candidate conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">energy</span></code>  â The energy of the candidate conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">reorder</span></code> â Boolean specifying if the conformers should be ordered based on energy after addition of candidate</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the conformer is not unique, this returns the index of its duplicate.
If it is unique, this returns None.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.set_generator">
<code class="descname">set_generator</code><span class="sig-paren">(</span><em>method='crest'</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>max_energy=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.set_generator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Store a generator object</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Overwrites previous generator object</p>
</div>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">method</span></code>          â A string, and one of the following options
[âcrestâ, ârdkitâ]</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code> â PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nproc</span></code>           â Number of processors used for each single call to AMS</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">max_energy</span></code>      â Maximum accepted energy difference from lowest energy conformer</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code>         â Maximum number of parallel AMS processes</p>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><em>method='crest'</em>, <em>nproc=1</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.generate" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Generate conformers using the specified method</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">method</span></code>  â A string, and one of the following options
[âcrestâ, ârdkitâ]</li>
<li><code class="docutils literal notranslate"><span class="pre">nproc</span></code>   â Number of processors used for each single call to AMS (only used if set_generator was not called)</li>
<li><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code> â Maximum number of parallel AMS processes ((only used if set_generator was not called))</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Adjusts self</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.optimize">
<code class="descname">optimize</code><span class="sig-paren">(</span><em>convergence_level</em>, <em>optimizer=None</em>, <em>max_energy=None</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>maxjobs=1</em>, <em>name='go'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.optimize" title="Permalink to this definition">Â¶</a></dt>
<dd><p>(Re)-Optimize the conformers currently in the set</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">convergence_level</span></code> â One of the convergence options (âtightâ, âvtightâ, âlooseâ, etcâ)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">optimizer</span></code>         â Instance of the ConformerOptimizer class. 
If not provided, an engine_settings object is required.</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code>   â PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.get_diffs_for_candidate">
<code class="descname">get_diffs_for_candidate</code><span class="sig-paren">(</span><em>coords</em>, <em>energy</em>, <em>iconf=None</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.get_diffs_for_candidate" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find out how much the values in the candidate molecule differ from each conformer</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">coords</span></code> â Coordinate array for the candidate conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">energy</span></code> â Energy of the candidate conformer (kcal/mol)</li>
<li><code class="docutils literal notranslate"><span class="pre">iconf</span></code>  â Optional: A single conformer index to compare the candidate with (default is to compare to all)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>dirname</em>, <em>name='crest'</em>, <em>enfilename=None</em>, <em>reorder=True</em>, <em>filetype='dcd'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.read" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Read a conformer set from the specified directory</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">dirname</span></code>              â The directory name containing the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>                 â The name of the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">enfilename</span></code>           â Optionally the name of a file containing the conformer energies (default: energies_name.txt)</li>
<li><code class="docutils literal notranslate"><span class="pre">reorder</span></code>              â Boolean specifying if the conformers need to be reordered based on energy</li>
<li><code class="docutils literal notranslate"><span class="pre">filetype</span></code>             â Extension of the conformer file (âdcdâ (default) or ârkfâ).</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_crest.UniqueConformersCrest.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename='crest'</em>, <em>write_rotamers=False</em>, <em>dirname='.'</em>, <em>filetype='dcd'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_crest.UniqueConformersCrest.write" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Write the conformers to file</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">write_rotamers</span></code>       â Boolean specifying if the rotamers of the conformers shouldk be written to files</li>
<li><code class="docutils literal notranslate"><span class="pre">filename</span></code>             â The name of the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">dirname</span></code>              â The directory name containing the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">filetype</span></code>             â Extension of the conformer file (âdcdâ (default) or ârkfâ).</li>
</ul>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="uniqueconformerstfd">
<h2>2.1.3. UniqueConformersTFD<a class="headerlink" href="#uniqueconformerstfd" title="Permalink to this headline">Â¶</a></h2>
<p>A class holding the conformers of a molecule, using the torsion fingerprint difference distance (TFD) to recognize and filter out duplicates.</p>
<dl class="class">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD">
<em class="property">class </em><code class="descname">UniqueConformersTFD</code><span class="sig-paren">(</span><em>tfd_threshold=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Class representing a set of unique conformers</p>
<p>An instance of this class has the following attributes:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">molecule</span></code>             â A PLAMS molecule object defining the connection data of the molecule</li>
<li><code class="docutils literal notranslate"><span class="pre">rdmol</span></code>                â RDKit molecule object without conformers</li>
<li><code class="docutils literal notranslate"><span class="pre">geometries</span></code>           â A list containing the coordinates of all conformers in the set</li>
<li><code class="docutils literal notranslate"><span class="pre">energies</span></code>             â A list containing the energies of all conformers in the set</li>
<li><code class="docutils literal notranslate"><span class="pre">check_for_duplicates</span></code> â Only accept new conformer if candidate is not a duplicate (if False, there is still a check for isomers and bond changes)</li>
<li><code class="docutils literal notranslate"><span class="pre">accept_isomers</span></code>       â Donât reject isomers (default is to reject them)</li>
<li><code class="docutils literal notranslate"><span class="pre">accept_all</span></code>           â Accept any candidate in the set without checks</li>
<li><code class="docutils literal notranslate"><span class="pre">generator</span></code>            â A conformer generator object. Has to be set with <a class="reference internal" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.set_generator" title="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.set_generator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_generator()</span></code></a>.
The default generator is of the RDKitGenerator type.</li>
</ul>
<p>A simple example of (parallel) use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.plams</span> <span class="k">import</span> <span class="n">init</span><span class="p">,</span> <span class="n">finish</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scm.conformers</span> <span class="k">import</span> <span class="n">UniqueConformersTFD</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up the molecular data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;mol.xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span> <span class="o">=</span> <span class="n">UniqueConformersTFD</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">prepare_state</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up PLAMS settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the generator and run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">finish</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write the results to file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conformers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The default generator for this conformer class is the RDKitGenerator, using the GFN1-xTB engine.
This will generally take a lot of time.
To speed things up, set a different generator prior to runnung <a class="reference internal" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.generate" title="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.generate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">generate()</span></code></a>:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span><span class="o">.</span><span class="n">ForceField</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">&#39;UFF&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conformers</span><span class="o">.</span><span class="n">set_generator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;rdkit&#39;</span><span class="p">,</span> <span class="n">engine_settings</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxjobs</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>tfd_threshold=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.__init__" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Creates an instance of the conformer class</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">tfd_threshold</span></code>   â Torsion Fingerprint (unitless)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.prepare_state">
<code class="descname">prepare_state</code><span class="sig-paren">(</span><em>mol</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.prepare_state" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Set up all the molecule data</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mol</span></code> â PLAMS Molecule object</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.add_conformer">
<code class="descname">add_conformer</code><span class="sig-paren">(</span><em>coords</em>, <em>energy</em>, <em>reorder=True</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.add_conformer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Adds the new coordinates to the list of conformers, if they are not duplicates</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">coords</span></code>  â A coordinate array for the candidate conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">energy</span></code>  â The energy of the candidate conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">reorder</span></code> â Boolean specifying if the conformers should be ordered based on energy after addition of candidate</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the conformer is not unique, this returns the index of its duplicate.
If it is unique, this returns None.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.set_generator">
<code class="descname">set_generator</code><span class="sig-paren">(</span><em>method='rdkit'</em>, <em>engine_settings=None</em>, <em>nproc=1</em>, <em>max_energy=6.0</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.set_generator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Store a generator object</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">method</span></code>          â A string, and one of the following options
[âcrestâ, ârdkitâ]</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">engine_settings</span></code> â PLAMS Settings object:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine_settings</span><span class="o">.</span><span class="n">DFTB</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="s1">&#39;GFN1-xTB&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">nproc</span></code>           â Number of processors used for each single call to AMS</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">max_energy</span></code>      â Maximum accepted energy difference from lowest energy conformer</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code>         â Maximum number of parallel AMS processes</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Overwrites previous generator object</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><em>method='rdkit'</em>, <em>nproc=1</em>, <em>maxjobs=1</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.generate" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Generate conformers using the specified method</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">method</span></code>  â A string, and one of the following options
[âcrestâ, ârdkitâ]</li>
<li><code class="docutils literal notranslate"><span class="pre">nproc</span></code>   â Number of processors used for each single call to AMS (only used if set_generator was not called)</li>
<li><code class="docutils literal notranslate"><span class="pre">maxjobs</span></code> â Maximum number of parallel AMS processes ((only used if set_generator was not called))</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Adjusts self</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.get_diffs_for_candidate">
<code class="descname">get_diffs_for_candidate</code><span class="sig-paren">(</span><em>coords</em>, <em>energy</em>, <em>iconf=None</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.get_diffs_for_candidate" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find out how much the values in the candidate molecule differ from each conformer</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">coords</span></code> â Coordinate array for the candidate conformer</li>
<li><code class="docutils literal notranslate"><span class="pre">energy</span></code> â Energy of the candidate conformer (kcal/mol)</li>
<li><code class="docutils literal notranslate"><span class="pre">iconf</span></code>  â Optional: A single conformer index to compare the candidate with (default is to compare to all)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>dirname</em>, <em>name='tfd'</em>, <em>enfilename=None</em>, <em>reorder=True</em>, <em>filetype='dcd'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.read" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Read a conformer set from the specified directory</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">dirname</span></code>              â The directory name containing the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code>                 â The name of the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">enfilename</span></code>           â Optionally the name of a file containing the conformer energies (default: energies_name.txt)</li>
<li><code class="docutils literal notranslate"><span class="pre">reorder</span></code>              â Boolean specifying if the conformers need to be reordered based on energy</li>
<li><code class="docutils literal notranslate"><span class="pre">filetype</span></code>             â Extension of the conformer file (âdcdâ (default) or ârkfâ).</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename='tfd'</em>, <em>dirname='.'</em>, <em>filetype='dcd'</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.write" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Write the conformers to file</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">filename</span></code>             â The name of the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">dirname</span></code>              â The directory name containing the conformer file</li>
<li><code class="docutils literal notranslate"><span class="pre">filetype</span></code>             â Extension of the conformer file (âdcdâ (default) or ârkfâ).</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.get_torsion_atoms">
<code class="descname">get_torsion_atoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.get_torsion_atoms" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns all the torsion atoms involved in the TFD</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Each contribution is a list of sets of four atoms. Mostly the list has only one entry,
but in case of symmetry, more sets of 4 atoms can contribute to a single torsion value.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.get_torsion_values">
<code class="descname">get_torsion_values</code><span class="sig-paren">(</span><em>iconf</em><span class="sig-paren">)</span><a class="headerlink" href="#scm.conformers.conformers.conformers_tfd.UniqueConformersTFD.get_torsion_values" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get the values of all the torsion angles for this conformer</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Each contribution is a list of torion angles. Mostly the list has only one entry,
but in the case of symmetry, or rings, several torsion angles contribute to a single TFP value.</p>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <!--STARTNOSOLR-->
<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="generators.html" class="btn btn-neutral float-right" title="2.2. Generators" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="components.html" class="btn btn-neutral" title="2. Components" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/> 

<!-- start :: footer -->
		<footer class="site-footer block">
			<div class="container">
				<div class="row">
					<div class="footer-column" >
	<ul>
		<li id="nav_menu-2" class="widget widget_nav_menu "><h3>Application Areas</h3><div class="menu-application-areas-container"><ul id="menu-application-areas" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/batteries/">Batteries &#038; PVs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/chemical-bonding-analysis/">Bonding Analysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/catalysis/">Catalysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/heavy-elements/">Heavy Elements</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/inorganic-chemistry/">Inorganic Chemistry</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/pharma/">Life Sciences</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/materials-science/">Materials Science</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/nanotechnology/">Nanotechnology</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/oil-and-gas/">Oil and Gas</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/organic-electronics/">Organic Electronics</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/polymers/">Polymers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/spectroscopy/">Spectroscopy</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/teaching/">Teaching</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-7" class="widget widget_nav_menu "><h3>Products</h3><div class="menu-product-navigation-container"><ul id="menu-product-navigation" class="menu">
<li id="menu-item-40263" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40263"><a href="https://www.scm.com/product/ams/">AMS Driver</a></li>
<li id="menu-item-7235" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7235"><a href="https://www.scm.com/product/adf/">ADF</a></li>
<li id="menu-item-7236" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7236"><a href="https://www.scm.com/product/band_periodicdft/">BAND</a></li>
<li id="menu-item-7237" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7237"><a href="https://www.scm.com/product/cosmo-rs/">COSMO-RS</a></li>
<li id="menu-item-7238" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7238"><a href="https://www.scm.com/product/dftb/">DFTB</a></li>
<li id="menu-item-7239" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7239"><a href="https://www.scm.com/product/gui/">GUI</a></li>
<li id="menu-item-44383" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-44383"><a href="https://www.scm.com/product/machine-learning-potentials/">MLPotential</a></li>
<li id="menu-item-7240" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7240"><a href="https://www.scm.com/product/mopac/">MOPAC</a></li>
<li id="menu-item-40262" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40262"><a href="https://www.scm.com/product/plams/">PLAMS</a></li>
<li id="menu-item-43701" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-43701"><a href="https://www.scm.com/product/quantum-espresso/">Quantum ESPRESSO</a></li>
<li id="menu-item-7241" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7241"><a href="https://www.scm.com/product/reaxff/">ReaxFF</a></li></ul></div></li><li id="nav_menu-26" class="widget widget_nav_menu "><div class="menu-licensing-container"><ul id="menu-licensing" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/">Pricing &#038; Licensing</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/">Price Quote</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/calculate-your-price/">Price Calculator</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/consulting/">Scientific Consulting</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/adf-resellers/">Resellers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/scm-license-terms/">License Terms</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/ordering-procedure/">Ordering</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-6" class="widget widget_nav_menu "><h3>Support</h3><div class="menu-support-navigation-container"><ul id="menu-support-navigation" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/">Support Overview</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-installation-videos/">Installation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-tutorials-and-manuals/">Documentation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/doc/Tutorials/GUI_overview/GUI_overview_tutorials.html">GUI Tutorials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/downloads/">Downloads</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/faq/">FAQs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/adf-discussion-list/">Discussion List</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/documentation-previous-versions/release-notes/">Release Notes</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/adf-teaching-materials/">Teaching Materials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/adf-hands-on-workshops/">Workshops</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/web-presentations-by-adf-experts/">Webinars</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/videos-tutorials-and-web-presentations/">Videos</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/brochures/">Brochure</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/amsterdam-modeling-suite/research-papers-citing-adf/">Papers Citing ADF</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/highlights/">Literature Highlights</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-28" class="widget widget_nav_menu "><h3>About Us</h3><div class="menu-about-us-container"><ul id="menu-about-us" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/contact-us/">Contact Us</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/eu-projects/">EU Projects</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-authors/">Contributors</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-people/">The SCM Team</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/collaborations/">Collaborations</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/careers/">Careers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/mission-vision/">Mission &#038; Vision</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/newsletters/">Newsletters</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/news/">News</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/">Events</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
			</ul>
</div>				</div>
			</div>
		</footer>
		<footer class="disclaimer-footer">
			<img src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="">
			<nav class="menu-service-navigation-container"><ul id="menu-service-navigation" class="menu-service navbar-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-73"><a href="https://www.scm.com/copyright/">Copyright</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72"><a href="https://www.scm.com/terms-of-use/">Terms of Use</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-71"><a href="https://www.scm.com/privacy-policy/">Privacy Policy</a></li>
</ul></nav></footer>	
		<!-- end :: footer -->

<!--ENDNOSOLR-->
        </div>
      </div>

    </section>
  </div>
  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2021.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCRWHZZ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/../../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>