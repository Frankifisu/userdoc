

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
<META name="ROBOTS" content="NOINDEX, NOFOLLOW">
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Binodal and Spinodal Curves &mdash; COSMO-RS 2021.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/theme_tabs.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/panels-bootstrap.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="COSMO-RS 2021.1 documentation" href="../index.html"/>
        <link rel="up" title="Advanced scripting examples with PLAMS" href="../Advanced_scripting.html"/>
        <link rel="next" title="Distribution of species in multispecies calculations" href="Multispecies_distribution.html"/>
        <link rel="prev" title="Eutectic systems" href="Eutectics.html"/> 

  
  <script src="../_static/js/jquery.min.js"></script>
  <script src="../_static/js/bootstrap.min.js"></script>
  <script src="../_static/js/modernizr.min.js"></script>
  <script src="../_static/js/app.js"></script>
<script type="text/javascript">
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NCRWHZZ');</script>
<!-- End Google Tag Manager -->

</head>

<body class="wy-body-for-nav" role="document">
  <!--STARTNOSOLR-->
  <header class="site-header navbar-fixed-top compact">
      <nav class="main navbar navbar-default">
        <div class="headerbar_container">
          <a role="button" href="/free-trial/" class="btn btn-sm btn-primary">Free trial</a>
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div class="navbar-brand">
              <a class="logo" href="https://www.scm.com">
                <img class="logo-small" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="Software for Chemistry &amp; Materials" />
                <img class="logo-full" src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo.svg" alt="Software for Chemistry &amp; Materials" />
              </a>
            </div>
          </div>
          <div class="nav-wrapper">
            <div class="collapse navbar-collapse">
              <ul id="menu-primary-navigation" class="nav navbar-nav"><li id="menu-item-40077" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-40077"><a title="Applications" href="https://www.scm.com/applications/">Applications</a></li>
<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a title="Products" href="https://www.scm.com/amsterdam-modeling-suite/">Products</a></li>
<li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36"><a title="Support" href="https://www.scm.com/support/">Support</a></li>
<li id="menu-item-37" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37"><a title="About us" href="https://www.scm.com/about-us/">About us</a></li>
</ul>                           <span class="search"><a class="menu_search_link" href="https://www.scm.com/search.php"></a><span class="sr-only">Search</span></span>
            </div>
          </div>
        </div>
      </nav>
 </header>
    

   
  <div id="doc-wrapper">
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" />
          
          </a>

          
          
  <ul>
      <li class="wy-breadcrumbs-aside">
        
           
           <a class="keyword-spacing" href="../keywords.html">Keywords</a>
           
           
           <a href="../genindex.html">Index</a>
           
        
      </li>
  </ul>
 
<!--ENDNOSOLR-->
             <!--STARTNOSOLR-->
<div role="search">
  <form id="rtd-search-form" class="wy-form search-docs-form" action="https://www.scm.com/search.php" method="get">
  <div class="input-group">
    <input type="text" name="search" placeholder="Search COSMO-RS" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <input type="hidden" name="root" value="doctrunk" />


    <input type="hidden" name="cat" value="doc-COSMO-RS" />


    <span class="input-group-btn">
			<button type="submit" class="btn btn-primary"><span class="sr-only">Search</span><span class="fa fa-search"></span></button>
		</span>
	</div>
  </form>
</div>
<!--ENDNOSOLR-->
          

          
        </div>
<!--STARTNOSOLR-->
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../General.html">General</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../General.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General.html#release-2021-1">Release 2021.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../General.html#release-2020-1">Release 2020.1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../COSMO-RS_and_COSMO-SAC.html">COSMO-RS, COSMO-SAC, UNIFAC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../COSMO-RS_theory.html">COSMO-RS theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_theory.html#cosmo-rs-combinatorial-term">COSMO-RS combinatorial term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_theory.html#fast-approximation-for-cosmo-rs-calculations">Fast approximation for COSMO-RS calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_theory.html#temperature-dependent-hydrogen-bond-interaction">Temperature dependent hydrogen bond interaction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../COSMO-SAC_2013-ADF.html">COSMO-SAC 2013-ADF, 2016-ADF, DHB-ADF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../UNIFAC_theory.html">UNIFAC theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_theory.html#residual-term">Residual term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_theory.html#combinatorial-term">Combinatorial term</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Calculation_of_properties.html">Calculation of properties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../COSMO_result_files.html">COSMO result files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ADF_COSMO_calculation.html">ADF COSMO calculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ADF_COSMO_calculation.html#adf-cosmo-settings">ADF COSMO settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADF_COSMO_calculation.html#atomic-cation-or-anion">Atomic cation or anion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADF_COSMO_calculation.html#accuracy">Accuracy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADF_COSMO_calculation.html#cavity-construction">Cavity construction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../COSMO-RS_Databases.html">ADFCRS-2018 Database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_Databases.html#adfcrs-2010">ADFCRS-2010</a></li>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_Databases.html#adfcrs-il-2014">ADFCRS-IL-2014</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../COSMO-RS_Databases.html#adfcrs-polymers-2019-database">ADFCRS-POLYMERS-2019 Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fast_Sigma_QSPR_COSMO_sigma-profiles.html">Fast Sigma: a QSPR method to estimate COSMO sigma-profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Fast_Sigma_QSPR_COSMO_sigma-profiles.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fast_Sigma_QSPR_COSMO_sigma-profiles.html#input-options">Input options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fast_Sigma_QSPR_COSMO_sigma-profiles.html#gui-input">GUI Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Fast_Sigma_QSPR_COSMO_sigma-profiles.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../MOPAC_COSMO_calculation.html">MOPAC COSMO calculation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../The_COSMO-RS_program.html">The COSMO-RS program</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Running_the_COSMO-RS_program.html">Running the COSMO-RS program</a></li>
<li class="toctree-l2"><a class="reference internal" href="../COSMO-RS_and_COSMO-SAC_parameters.html">COSMO-RS and COSMO-SAC parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_and_COSMO-SAC_parameters.html#cosmo-rs-general-parameters">COSMO-RS general parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_and_COSMO-SAC_parameters.html#cosmo-rs-element-specific-parameters">COSMO-RS element specific parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_and_COSMO-SAC_parameters.html#cosmo-sac-general-parameters">COSMO-SAC general parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_and_COSMO-SAC_parameters.html#cosmo-sac-element-specific-parameters">COSMO-SAC element specific parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../COSMO-RS_and_COSMO-SAC_parameters.html#technical-and-accuracy-parameters">Technical and accuracy parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Compounds.html">Compounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Temperature.html">Temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Pressure.html">Pressure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Molar_fractions_and_mass_fraction.html">Molar fractions and mass fraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Properties.html">Properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Properties.html#vapor-pressure">Vapor pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Properties.html#boiling-point">Boiling point</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Properties.html#solvent-flash-point">Solvent flash point</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Properties.html#partition-coefficients-logp">Partition coefficients (LogP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Properties.html#activity-coefficients-solvent-and-solute">Activity coefficients solvent and solute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Properties.html#solubility">Solubility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Properties.html#binary-mixture-vle-lle">Binary mixture (VLE/LLE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Properties.html#ternary-mixture-vle-lle">Ternary mixture (VLE/LLE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Properties.html#solvents-s1-s2-composition-line">Solvents s1 - s2 Composition Line</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Analysis.html">Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Analysis.html#sigma-profile">Sigma profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Analysis.html#sigma-potential">Sigma potential</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Polymers_With_COSMO-RS.html">Polymers with COSMO-RS(-SAC)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#additional-properties-units-for-polymer-systems">Additional properties/units for polymer systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#average-molecular-weight">Average molecular weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#mole-fractions-of-the-monomers-and-polymers">Mole fractions of the monomers and polymers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#x-monomer">x(monomer)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#x-polymer">x(polymer)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#weight-and-volume-fraction-activity-coefficients">Weight- and volume-fraction activity coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#flory-huggins-parameter">Flory-Huggins parameter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#modified-combinatorial-term">Modified combinatorial term</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#general-application-guidelines-warnings">General application guidelines/warnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#downloading-the-adfcrs-polymer-2019-database">Downloading the ADFCRS-POLYMER-2019 database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Polymers_With_COSMO-RS.html#tutorial-on-polymer-calculations">Tutorial on polymer calculations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../The_UNIFAC_program.html">The UNIFAC program</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../UNIFAC_program/Input_formatting.html">Compound Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Input_formatting.html#basic-input">Basic Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Input_formatting.html#physical-property-input">Physical Property Input</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../UNIFAC_program/General_options.html">Program Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/General_options.html#list-of-possible-input-flags">List of possible input flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/General_options.html#examples-of-general-program-flags">Examples of general program flags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../UNIFAC_program/General_options.html#t">-t</a></li>
<li class="toctree-l4"><a class="reference internal" href="../UNIFAC_program/General_options.html#temperature">-temperature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../UNIFAC_program/General_options.html#n">-n</a></li>
<li class="toctree-l4"><a class="reference internal" href="../UNIFAC_program/General_options.html#preset">-preset</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../UNIFAC_program/Templates.html">Templates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Templates.html#activitycoef">ACTIVITYCOEF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Templates.html#logp">LOGP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Templates.html#puresolubility">PURESOLUBILITY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Templates.html#solubility">SOLUBILITY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Templates.html#purevaporpressure">PUREVAPORPRESSURE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Templates.html#vaporpressure">VAPORPRESSURE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Templates.html#binmixcoef">BINMIXCOEF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../UNIFAC_program/Templates.html#ternarymix">TERNARYMIX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Property_Prediction.html">Pure compound property prediction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Property_Prediction.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Property_Prediction.html#available-properties">Available properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Property_Prediction.html#running-the-property-prediction-program">Running the Property Prediction program</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Property_Prediction.html#index-of-property-keys">Index of property keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Property_Prediction.html#general-warnings">General warnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Property_Prediction.html#equations-for-temperature-dependent-properties">Equations for temperature-dependent properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Property_Prediction.html#vpm1-liquid-vapor-pressure"><strong>VPM1</strong>: liquid vapor pressure</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Solvent_Optimization.html">Solvent Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Solvent_Optimization.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Solvent_Optimization.html#problem-types">Problem types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Solvent_Optimization.html#running-the-solvent-optimization-program">Running the Solvent Optimization program</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Solvent_Optimization.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Solvent_Optimization.html#solubility">Solubility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Solvent_Optimization.html#liquid-liquid-extraction">Liquid-liquid extraction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Solvent_Optimization.html#guidelines-for-difficult-problems">Guidelines for difficult problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Solvent_Optimization.html#differences-from-standard-implementations">Differences from standard implementations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Scripting_with_COSMO-RS.html">Scripting with COSMO-RS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html">Python scripting for COSMO-RS with PLAMS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#general-information">General Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#executing-the-code-from-the-command-line">Executing the code from the command line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#specifying-a-problem-type">Specifying a problem type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#inputting-compounds">Inputting Compounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#specifying-mole-fractions-temperatures-and-pressures">Specifying mole fractions, temperatures, and pressures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#running-jobs">Running jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#reading-the-results-of-a-job">Reading the results of a job</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#plotting-results">Plotting results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#partition-coefficient">Partition coefficient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../PLAMS_COSMO-RS_scripting.html#binary-mixture">Binary mixture</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../AMSprep.html">AMSprep: construct an ADF COSMO results file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CRSprep.html">CRSprep: generate (multiple) COSMO-RS jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../AMSreport.html">AMSreport: generate report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../KF_utilities_for_COSMO-RS.html">KF utilities for COSMO-RS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../KF_utilities_for_COSMO-RS.html#kf-browser">KF browser</a></li>
<li class="toctree-l3"><a class="reference internal" href="../KF_utilities_for_COSMO-RS.html#kf2cosmo-and-cosmo2kf">kf2cosmo and cosmo2kf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../KF_utilities_for_COSMO-RS.html#pkf-cpkf-dmpkf-udmpkf">pkf, cpkf, dmpkf, udmpkf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Scripting_Examples.html">Scripting Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Scripting_Examples.html#example-cosmo-result-files">Example: COSMO result files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Scripting_Examples.html#example-cosmo-rs-parameters-and-analysis">Example: COSMO-RS parameters and analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Scripting_Examples.html#example-cosmo-rs-properties">Example: COSMO-RS properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Scripting_Examples.html#example-the-cosmo-rs-compound-database">Example: The COSMO-RS compound database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Scripting_Examples.html#example-pka-values">Example: pKa values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Scripting_Examples.html#example-polymers">Example: Polymers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../Advanced_scripting.html">Advanced scripting examples with PLAMS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Changing_parameters.html">Changing the default parameters or re-parameterizing the COSMO-RS/-SAC methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Changing_parameters.html#python-code-cosmo-rs-parameters">Python code (COSMO-RS parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Changing_parameters.html#python-code-cosmo-sac-parameters">Python code (COSMO-SAC parameters)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Sigma_profiles.html">Calculating and estimating sigma profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Sigma_profiles.html#python-code">Python code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Sigma_moments.html">Sigma Moments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Sigma_moments.html#python-code">Python code</a></li>
<li class="toctree-l3"><a class="reference internal" href="Sigma_moments.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Cocrystal_screening.html">Screening for cocrystals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Cocrystal_screening.html#python-code">Python code</a></li>
<li class="toctree-l3"><a class="reference internal" href="Cocrystal_screening.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Eutectics.html">Eutectic systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Eutectics.html#python-code">Python code</a></li>
<li class="toctree-l3"><a class="reference internal" href="Eutectics.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Binodal and Spinodal Curves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#python-code-binary-mixture">Python code (Binary mixture)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#python-code-ternary-mixture">Python code (Ternary mixture)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Multispecies_distribution.html">Distribution of species in multispecies calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Multispecies_distribution.html#python-code-binary-mixture">Python code (Binary mixture)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Required_citations.html">Required Citations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Required_citations.html#general-references">General References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Required_citations.html#solvent-optimizations">Solvent Optimizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Required_citations.html#external-programs-and-libraries">External programs and Libraries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../keywords.html">Keywords</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">COSMO-RS</a>
      </nav>
<!--ENDNOSOLR-->

      
      <div class="wy-nav-content">
        <div class="rst-content">
        <!--STARTNOSOLR-->
<div class="header" role="navigation" aria-label="breadcrumbs navigation">
 
  <ul class="wy-breadcrumbs">
    <li><a href="../COSMO-RS.html/../../Documentation/index.html">Documentation</a>/</li>
    <li><a href="../index.html">COSMO-RS</a>/</li>
      
          <li><a href="../Advanced_scripting.html">Advanced scripting examples with PLAMS</a>/</li>
      
    <li class="orange-text">Binodal and Spinodal Curves</li>
  </ul>
  <p>
 
</div>
<!--ENDNOSOLR-->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="binodal-and-spinodal-curves">
<span id="metatag-scripting-binodal-spinodal"></span><h1>Binodal and Spinodal Curves<a class="headerlink" href="#binodal-and-spinodal-curves" title="Permalink to this headline">¶</a></h1>
<p>Binodal and spinodal curves are useful for understanding phase stability.  The binodal curve (or coexistence curve) defines the temperatures and compositions at which phase separation is thermodynamically favorable.  The spinodal curve is located within the binodal curve and indicates the limit of local phase stability.  Compositions between the spinodal and binodal curves – while not thermodynamically stable – are robust against small fluctuations (i.e., the free energy surface is locally convex for points in this region).</p>
<div class="section" id="python-code-binary-mixture">
<h2>Python code (Binary mixture)<a class="headerlink" href="#python-code-binary-mixture" title="Permalink to this headline">¶</a></h2>
<details>
<summary style="color:#008000;cursor:pointer">[show/hide code]</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scm.plams</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">##################  Note: Be sure to add the path to your own AMSCRS directory here  ##################</span>
<span class="n">database_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">database_path</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The provided path does not exist. Exiting.&#39;</span><span class="p">)</span>

<span class="n">init</span><span class="p">()</span>
<span class="c1">#suppress plams output</span>
<span class="n">config</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="mi">0</span>


<span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Nitrobenzene.coskf&quot;</span><span class="p">,</span><span class="s2">&quot;Hexane.coskf&quot;</span><span class="p">]</span>
<span class="n">nring</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># problem paramters</span>
<span class="n">temp_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">203.15</span><span class="p">,</span><span class="mf">243.15</span><span class="p">]</span> <span class="c1">#K -- the temperature range over which the curves are calculated</span>
<span class="n">steps</span>   <span class="o">=</span> <span class="mi">40</span><span class="c1"># number of steps to take within the temperature range</span>


<span class="k">def</span> <span class="nf">binmix_at_T</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">temp</span><span class="p">):</span>

    <span class="c1"># initialize settings object</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="s1">&#39;BINMIXCOEF&#39;</span>

    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">nfrac</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="c1"># make compounds</span>
    <span class="n">compounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">Settings</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="nb">file</span><span class="p">,</span><span class="n">nr</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">nring</span><span class="p">)):</span>
        <span class="n">compounds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_h</span>    <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">database_path</span><span class="p">,</span> <span class="nb">file</span> <span class="p">)</span>
        <span class="n">compounds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">nring</span> <span class="o">=</span> <span class="n">nr</span>

    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temp</span>

    <span class="c1"># optionally, change to the COSMOSAC2013 method</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;COSMOSAC2013&#39;</span>
    <span class="c1"># we&#39;ll also tighten the convergence threshold for better numerical accuracy</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Technical</span><span class="o">.</span><span class="n">sacconv</span>    <span class="o">=</span> <span class="mf">1e-10</span>

    <span class="c1"># add the compounds to the settings object</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">compound</span> <span class="o">=</span> <span class="n">compounds</span>
    <span class="c1"># create a job that can be run by COSMO-RS</span>
    <span class="n">my_job</span> <span class="o">=</span> <span class="n">CRSJob</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">)</span>
    <span class="c1"># run the job</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">my_job</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="c1"># convert all the results into a python dict</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">res</span>


<span class="k">def</span> <span class="nf">calc_binodal_at_T</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>

    <span class="c1"># this is the miscibility gap, so we can use the result calculated by the program</span>
    <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;showmiscgap&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;xlle&quot;</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">calc_spinodal_at_T</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>

    <span class="c1"># here, we&#39;ll look for points with d^2(G_mix)/dx^2 = 0</span>
    <span class="c1"># we&#39;ll calculate a numerical second derivative for every point</span>
    <span class="n">spinodal</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">gmix</span>  <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;Gibbs energy of mixing&quot;</span><span class="p">]</span>
    <span class="n">frac1</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;molar fraction&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">second_deriv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gmix</span><span class="p">))</span>

    <span class="c1"># initial values for endpoints (assuming convexity close to pure compounds)</span>
    <span class="n">second_deriv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">0.0001</span>
    <span class="n">second_deriv</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0001</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">gmix</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">delta1</span> <span class="o">=</span> <span class="n">frac1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">frac1</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">delta2</span> <span class="o">=</span> <span class="n">frac1</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">frac1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">d1</span> <span class="o">=</span> <span class="p">(</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">delta1</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="p">(</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">delta2</span>
        <span class="n">second_deriv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">d2</span><span class="o">-</span><span class="n">d1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">delta1</span><span class="o">+</span><span class="n">delta2</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">second_deriv</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">second_deriv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">second_deriv</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dist1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">second_deriv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">dist2</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">second_deriv</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">tot</span>   <span class="o">=</span> <span class="n">dist1</span><span class="o">+</span><span class="n">dist2</span>
            <span class="n">zero</span>  <span class="o">=</span> <span class="p">(</span><span class="n">dist2</span><span class="o">*</span><span class="n">frac1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">dist1</span><span class="o">*</span><span class="n">frac1</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">tot</span>
            <span class="n">spinodal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zero</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">spinodal</span> <span class="k">if</span> <span class="n">spinodal</span> <span class="k">else</span> <span class="bp">None</span>


<span class="n">temps</span> <span class="o">=</span> <span class="p">[</span><span class="n">temp_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">temp_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">temp_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">steps</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">bin_left_points</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="n">bin_right_points</span>  <span class="o">=</span> <span class="p">[]</span>
<span class="n">spin_left_points</span>  <span class="o">=</span> <span class="p">[]</span>
<span class="n">spin_right_points</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="s2">&quot;Binodal points&quot;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span><span class="s2">&quot;Spinodal points&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
    <span class="n">res</span>      <span class="o">=</span> <span class="n">binmix_at_T</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">temp</span><span class="p">)</span>
    <span class="n">binodal</span>  <span class="o">=</span> <span class="n">calc_binodal_at_T</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="n">spinodal</span> <span class="o">=</span> <span class="n">calc_spinodal_at_T</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

    <span class="n">bin_str</span>  <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="s1">&#39;{0:&lt;10.5g}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">binodal</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="k">if</span> <span class="n">binodal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s2">&quot;--&quot;</span>
    <span class="n">spin_str</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="s1">&#39;{0:&lt;10.5g}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">spinodal</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="k">if</span> <span class="n">spinodal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s2">&quot;--&quot;</span>
    <span class="k">print</span><span class="p">(</span> <span class="s1">&#39;{0:.5g}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="n">bin_str</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="p">,</span><span class="n">spin_str</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">binodal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bin_left_points</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">binodal</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">temp</span><span class="p">))</span>
        <span class="n">bin_right_points</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">binodal</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">temp</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">spinodal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">spin_left_points</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">spinodal</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">temp</span><span class="p">))</span>
        <span class="n">spin_right_points</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">spinodal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">temp</span><span class="p">))</span>

<span class="n">bin_points</span>  <span class="o">=</span> <span class="n">bin_left_points</span>  <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">bin_right_points</span><span class="p">))</span>
<span class="n">spin_points</span> <span class="o">=</span> <span class="n">spin_left_points</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">spin_right_points</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bin_points</span><span class="p">],[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">bin_points</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Binodal curve&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">spin_points</span><span class="p">],[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">spin_points</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Spinodal curve&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Mole fraction compound 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">finish</span><span class="p">()</span>
</pre></div>
</div>
</details><p>This code produces the following output:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/as_binodalspinodal_binary.png"><img alt="../_images/as_binodalspinodal_binary.png" src="../_images/as_binodalspinodal_binary.png" style="width: 80%;" /></a>
</div>
</div>
<div class="section" id="python-code-ternary-mixture">
<h2>Python code (Ternary mixture)<a class="headerlink" href="#python-code-ternary-mixture" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This example uses the python package <code class="docutils literal notranslate"><span class="pre">ternary</span></code>, but this is <em>only required for plotting</em>.  This package can be installed in amspython using pip as follows: <code class="docutils literal notranslate"><span class="pre">amspython</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">python-ternary</span></code>.  Users may choose to remove the plotting features of the code and not install <code class="docutils literal notranslate"><span class="pre">ternary</span></code>.</p>
</div>
<details>
<summary style="color:#008000;cursor:pointer">[show/hide code]</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scm.plams</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">ternary</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Cannot find ternary package.&quot;</span><span class="p">)</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Try to install with:&quot;</span><span class="p">)</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;amspython -m pip install python-ternary&quot;</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">()</span>


<span class="c1">##################  Note: Be sure to add the path to your own AMSCRS directory here  ##################</span>
<span class="n">database_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">database_path</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The provided path does not exist. Exiting.&#39;</span><span class="p">)</span>

<span class="n">init</span><span class="p">()</span>
<span class="c1">#suppress plams output</span>
<span class="n">config</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Water.coskf&quot;</span><span class="p">,</span><span class="s2">&quot;Chloroform.coskf&quot;</span><span class="p">,</span><span class="s2">&quot;Acetic_acid.coskf&quot;</span><span class="p">]</span>
<span class="n">nring</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nfrac</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># the nfrac parameter for ternary mixtures</span>
<span class="n">temp_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">273.15</span><span class="p">,</span><span class="mf">273.15</span><span class="p">]</span> <span class="c1">#K -- the temperature range over which the curves are calculated</span>
<span class="n">steps</span>   <span class="o">=</span> <span class="mi">0</span> <span class="c1"># number of steps to take within the temperature range</span>


<span class="k">def</span> <span class="nf">ternmix_at_T</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">temp</span><span class="p">,</span><span class="n">nfrac</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>

    <span class="c1"># initialize settings object</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">()</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="s1">&#39;TERNARYMIX&#39;</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">nfrac</span> <span class="o">=</span> <span class="n">nfrac</span>

    <span class="c1"># make compounds</span>
    <span class="n">compounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">Settings</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="nb">file</span><span class="p">,</span><span class="n">nr</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">nring</span><span class="p">)):</span>
        <span class="n">compounds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_h</span>    <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">database_path</span><span class="p">,</span> <span class="nb">file</span> <span class="p">)</span>
        <span class="n">compounds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">nring</span> <span class="o">=</span> <span class="n">nr</span>

    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temp</span>

    <span class="c1"># optionally, change to the COSMOSAC2013 method</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;COSMOSAC2013&#39;</span>
    <span class="c1"># we&#39;ll also tighten the convergence threshold for better numerical accuracy</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Technical</span><span class="o">.</span><span class="n">sacconv</span>    <span class="o">=</span> <span class="mf">1e-10</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">Technical</span><span class="o">.</span><span class="n">rsconv</span>     <span class="o">=</span> <span class="mf">1e-10</span>

    <span class="c1"># add the compounds to the settings object</span>
    <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">compound</span> <span class="o">=</span> <span class="n">compounds</span>
    <span class="c1"># create a job that can be run by COSMO-RS</span>
    <span class="n">my_job</span> <span class="o">=</span> <span class="n">CRSJob</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">)</span>
    <span class="c1"># run the job</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">my_job</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="c1"># convert all the results into a python dict</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">res</span>


<span class="k">def</span> <span class="nf">calc_binodal_at_T</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>

    <span class="c1"># this is the miscibility gap, so we can use the result calculated by the program</span>
    <span class="n">points_l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">points_r</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;nxll&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;xll&quot;</span><span class="p">])</span><span class="o">//</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">points_l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;xll&quot;</span><span class="p">][</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">points_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;xll&quot;</span><span class="p">][</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">points_l</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">points_r</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">calc_spinodal_at_T</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>

    <span class="c1"># in this function, we search for mole fraction values where the determinant of the hessian of G_mix with respect to mole fractions is 0</span>
    <span class="c1"># using the first two mole fractions as degrees of freedom</span>
    <span class="n">spinodal</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">gmix_res</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;Gibbs energy of mixing&quot;</span><span class="p">]</span>
    <span class="n">fracs</span>    <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;molar fraction&quot;</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">step_size</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fracs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">fracs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">tot_steps</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">step_size</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">gmix</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">tot_steps</span><span class="p">,</span><span class="n">tot_steps</span><span class="p">))</span>
    <span class="n">gmix</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
    <span class="n">det_mat</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">tot_steps</span><span class="p">,</span><span class="n">tot_steps</span><span class="p">))</span>
    <span class="n">det_mat</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">gmix_val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fracs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fracs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">gmix_res</span><span class="p">):</span>
        <span class="n">idx1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="o">/</span><span class="n">step_size</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">idx2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x2</span><span class="o">/</span><span class="n">step_size</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">gmix</span><span class="p">[</span><span class="n">idx1</span><span class="p">,</span><span class="n">idx2</span><span class="p">]</span> <span class="o">=</span> <span class="n">gmix_val</span>

    <span class="c1"># calculate second derivatives and determinants</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tot_steps</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tot_steps</span><span class="o">-</span><span class="n">i</span><span class="p">):</span>
            <span class="c1"># these finite difference expressions work because the ternary mixture always has a constant step size</span>
            <span class="k">if</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">tot_steps</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">tot_steps</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">d_xx</span> <span class="o">=</span> <span class="p">(</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">step_size</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">d_yy</span> <span class="o">=</span> <span class="p">(</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">step_size</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">d_xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">gmix</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">step_size</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">det_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">d_xx</span><span class="o">*</span><span class="n">d_yy</span><span class="o">-</span><span class="n">d_xy</span><span class="o">**</span><span class="mi">2</span>


    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tot_steps</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tot_steps</span><span class="o">-</span><span class="n">i</span><span class="p">):</span>
            <span class="c1"># compare right and below</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">i1</span><span class="p">,</span><span class="n">j1</span><span class="p">),(</span><span class="n">i2</span><span class="p">,</span><span class="n">j2</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)],[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)]]:</span>
                <span class="k">if</span> <span class="n">i2</span> <span class="o">&lt;</span> <span class="n">tot_steps</span> <span class="ow">and</span> <span class="n">j2</span> <span class="o">&lt;</span> <span class="n">tot_steps</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">det_mat</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span><span class="n">j1</span><span class="p">])</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">det_mat</span><span class="p">[</span><span class="n">i2</span><span class="p">,</span><span class="n">j2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">det_mat</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span><span class="n">j1</span><span class="p">]</span><span class="o">*</span><span class="n">det_mat</span><span class="p">[</span><span class="n">i2</span><span class="p">,</span><span class="n">j2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="n">x1</span>  <span class="o">=</span> <span class="n">step_size</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i1</span><span class="p">,</span><span class="n">j1</span><span class="p">,</span><span class="n">tot_steps</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i1</span><span class="o">-</span><span class="n">j1</span><span class="p">])</span>
                    <span class="n">x2</span>  <span class="o">=</span> <span class="n">step_size</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i2</span><span class="p">,</span><span class="n">j2</span><span class="p">,</span><span class="n">tot_steps</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i2</span><span class="o">-</span><span class="n">j2</span><span class="p">])</span>

                    <span class="n">spin</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">det_mat</span><span class="p">[</span><span class="n">i2</span><span class="p">,</span><span class="n">j2</span><span class="p">])</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">det_mat</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span><span class="n">j1</span><span class="p">])</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">det_mat</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span><span class="n">j1</span><span class="p">])</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">det_mat</span><span class="p">[</span><span class="n">i2</span><span class="p">,</span><span class="n">j2</span><span class="p">]))</span>
                    <span class="n">spinodal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spin</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">spinodal</span>



<span class="c1">## Make ternary figure</span>
<span class="n">figure</span><span class="p">,</span> <span class="n">tax</span> <span class="o">=</span> <span class="n">ternary</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">tax</span><span class="o">.</span><span class="n">boundary</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">tax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># Set Axis labels and Title</span>
<span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">tax</span><span class="o">.</span><span class="n">bottom_axis_label</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">tax</span><span class="o">.</span><span class="n">right_axis_label</span><span class="p">(</span> <span class="s2">&quot;$x_2$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">tax</span><span class="o">.</span><span class="n">left_axis_label</span><span class="p">(</span>  <span class="s2">&quot;$x_3$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">tax</span><span class="o">.</span><span class="n">ticks</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;lbr&#39;</span><span class="p">,</span><span class="n">multiple</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tick_formats</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

<span class="c1"># Remove default Matplotlib Axes</span>
<span class="n">tax</span><span class="o">.</span><span class="n">clear_matplotlib_ticks</span><span class="p">()</span>

<span class="n">temps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">if</span> <span class="n">steps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">temps</span> <span class="o">=</span> <span class="p">[</span><span class="n">temp_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">temp_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">temp_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">steps</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">temps</span> <span class="o">=</span> <span class="p">[</span><span class="n">temp_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">temp_range</span><span class="p">]</span>

<span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
    <span class="n">res</span>      <span class="o">=</span> <span class="n">ternmix_at_T</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">temp</span><span class="p">,</span><span class="n">nfrac</span><span class="p">)</span>
    <span class="n">binodal</span>  <span class="o">=</span> <span class="n">calc_binodal_at_T</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="n">spinodal</span> <span class="o">=</span> <span class="n">calc_spinodal_at_T</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

    <span class="c1"># the sorting index might need to be changed here if the curves are in a different position</span>
    <span class="n">binodal</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">spinodal</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">tax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">binodal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Binodal  T=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; K&quot;</span><span class="p">)</span>
    <span class="n">tax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spinodal</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Spinodal T=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; K&quot;</span><span class="p">)</span>

<span class="n">tax</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ternary</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">ternary</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">finish</span><span class="p">()</span>
</pre></div>
</div>
</details><p>This code produces the following output:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/as_binodalspinodal_tern.png"><img alt="../_images/as_binodalspinodal_tern.png" src="../_images/as_binodalspinodal_tern.png" style="width: 80%;" /></a>
</div>
</div>
</div>


           </div>
          </div>
          <!--STARTNOSOLR-->
<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Multispecies_distribution.html" class="btn btn-neutral float-right" title="Distribution of species in multispecies calculations" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Eutectics.html" class="btn btn-neutral" title="Eutectic systems" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/> 

<!-- start :: footer -->
		<footer class="site-footer block">
			<div class="container">
				<div class="row">
					<div class="footer-column" >
	<ul>
		<li id="nav_menu-2" class="widget widget_nav_menu "><h3>Application Areas</h3><div class="menu-application-areas-container"><ul id="menu-application-areas" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/batteries/">Batteries &#038; PVs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/chemical-bonding-analysis/">Bonding Analysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/catalysis/">Catalysis</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/heavy-elements/">Heavy Elements</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/inorganic-chemistry/">Inorganic Chemistry</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/pharma/">Life Sciences</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/materials-science/">Materials Science</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/nanotechnology/">Nanotechnology</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/oil-and-gas/">Oil and Gas</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/organic-electronics/">Organic Electronics</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/polymers/">Polymers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/spectroscopy/">Spectroscopy</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/applications/teaching/">Teaching</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-7" class="widget widget_nav_menu "><h3>Products</h3><div class="menu-product-navigation-container"><ul id="menu-product-navigation" class="menu">
<li id="menu-item-40263" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40263"><a href="https://www.scm.com/product/ams/">AMS Driver</a></li>
<li id="menu-item-7235" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7235"><a href="https://www.scm.com/product/adf/">ADF</a></li>
<li id="menu-item-7236" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7236"><a href="https://www.scm.com/product/band_periodicdft/">BAND</a></li>
<li id="menu-item-7237" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7237"><a href="https://www.scm.com/product/cosmo-rs/">COSMO-RS</a></li>
<li id="menu-item-7238" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7238"><a href="https://www.scm.com/product/dftb/">DFTB</a></li>
<li id="menu-item-7239" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7239"><a href="https://www.scm.com/product/gui/">GUI</a></li>
<li id="menu-item-44383" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-44383"><a href="https://www.scm.com/product/machine-learning-potentials/">MLPotential</a></li>
<li id="menu-item-7240" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7240"><a href="https://www.scm.com/product/mopac/">MOPAC</a></li>
<li id="menu-item-40262" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-40262"><a href="https://www.scm.com/product/plams/">PLAMS</a></li>
<li id="menu-item-43701" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-43701"><a href="https://www.scm.com/product/quantum-espresso/">Quantum ESPRESSO</a></li>
<li id="menu-item-7241" class="menu-item menu-item-type-post_type menu-item-object-product menu-item-7241"><a href="https://www.scm.com/product/reaxff/">ReaxFF</a></li></ul></div></li><li id="nav_menu-26" class="widget widget_nav_menu "><div class="menu-licensing-container"><ul id="menu-licensing" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/">Pricing &#038; Licensing</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/">Price Quote</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/price-quote/calculate-your-price/">Price Calculator</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/consulting/">Scientific Consulting</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/adf-resellers/">Resellers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/scm-license-terms/">License Terms</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/pricing-licensing/ordering-procedure/">Ordering</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-6" class="widget widget_nav_menu "><h3>Support</h3><div class="menu-support-navigation-container"><ul id="menu-support-navigation" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/">Support Overview</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-installation-videos/">Installation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/ams-tutorials-and-manuals/">Documentation</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/doc/Tutorials/GUI_overview/GUI_overview_tutorials.html">GUI Tutorials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/downloads/">Downloads</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/faq/">FAQs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/adf-discussion-list/">Discussion List</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/support/documentation-previous-versions/release-notes/">Release Notes</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/support/adf-teaching-materials/">Teaching Materials</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/adf-hands-on-workshops/">Workshops</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/web-presentations-by-adf-experts/">Webinars</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/videos-tutorials-and-web-presentations/">Videos</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/amsterdam-modeling-suite/brochures/">Brochure</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/amsterdam-modeling-suite/research-papers-citing-adf/">Papers Citing ADF</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/highlights/">Literature Highlights</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
		<li id="nav_menu-28" class="widget widget_nav_menu "><h3>About Us</h3><div class="menu-about-us-container"><ul id="menu-about-us" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/contact-us/">Contact Us</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/eu-projects/">EU Projects</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-authors/">Contributors</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/our-people/">The SCM Team</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/collaborations/">Collaborations</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/careers/">Careers</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/mission-vision/">Mission &#038; Vision</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/newsletters/">Newsletters</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://www.scm.com/category/news/">News</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://www.scm.com/about-us/news-agenda/">Events</a></li>
</ul></div></li>	</ul>
</div><div class="footer-column" >
	<ul>
			</ul>
</div>				</div>
			</div>
		</footer>
		<footer class="disclaimer-footer">
			<img src="https://www.scm.com/wp-content/themes/scm/images/logos/scm-logo-compact.svg" alt="">
			<nav class="menu-service-navigation-container"><ul id="menu-service-navigation" class="menu-service navbar-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-73"><a href="https://www.scm.com/copyright/">Copyright</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72"><a href="https://www.scm.com/terms-of-use/">Terms of Use</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-71"><a href="https://www.scm.com/privacy-policy/">Privacy Policy</a></li>
</ul></nav></footer>	
		<!-- end :: footer -->

<!--ENDNOSOLR-->
        </div>
      </div>

    </section>
  </div>
  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2021.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCRWHZZ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/../../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>